<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>M18 ERP EJB 接口 (后台接口) | M18 Developer Center</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Make Something People Want">
    
    <link rel="preload" href="/assets/css/0.styles.feb2d03d.css" as="style"><link rel="preload" href="/assets/js/app.4376798b.js" as="script"><link rel="preload" href="/assets/js/3.8b8b1a7c.js" as="script"><link rel="preload" href="/assets/js/56.3906b81d.js" as="script"><link rel="prefetch" href="/assets/js/10.8a552882.js"><link rel="prefetch" href="/assets/js/11.5144539e.js"><link rel="prefetch" href="/assets/js/12.378ec18e.js"><link rel="prefetch" href="/assets/js/13.44ba39a0.js"><link rel="prefetch" href="/assets/js/14.d63aaec0.js"><link rel="prefetch" href="/assets/js/15.38fac1c8.js"><link rel="prefetch" href="/assets/js/16.0013e350.js"><link rel="prefetch" href="/assets/js/17.fc6cd212.js"><link rel="prefetch" href="/assets/js/18.2847d737.js"><link rel="prefetch" href="/assets/js/19.88f6181f.js"><link rel="prefetch" href="/assets/js/20.ea78d3a6.js"><link rel="prefetch" href="/assets/js/21.714d174a.js"><link rel="prefetch" href="/assets/js/22.f4b90312.js"><link rel="prefetch" href="/assets/js/23.118c11c3.js"><link rel="prefetch" href="/assets/js/24.2830a16b.js"><link rel="prefetch" href="/assets/js/25.6c509b52.js"><link rel="prefetch" href="/assets/js/26.c23a0942.js"><link rel="prefetch" href="/assets/js/27.37b55e6a.js"><link rel="prefetch" href="/assets/js/28.b0438ff3.js"><link rel="prefetch" href="/assets/js/29.3cd73362.js"><link rel="prefetch" href="/assets/js/30.871ee455.js"><link rel="prefetch" href="/assets/js/31.6f961e56.js"><link rel="prefetch" href="/assets/js/32.c2f5f5d6.js"><link rel="prefetch" href="/assets/js/33.1a2e36a7.js"><link rel="prefetch" href="/assets/js/34.f9735fab.js"><link rel="prefetch" href="/assets/js/35.84232dea.js"><link rel="prefetch" href="/assets/js/36.3f28c98e.js"><link rel="prefetch" href="/assets/js/37.94fa301f.js"><link rel="prefetch" href="/assets/js/38.48855456.js"><link rel="prefetch" href="/assets/js/39.af23d0da.js"><link rel="prefetch" href="/assets/js/4.f28058e9.js"><link rel="prefetch" href="/assets/js/40.f514ecf2.js"><link rel="prefetch" href="/assets/js/41.af12f032.js"><link rel="prefetch" href="/assets/js/42.7f0f7085.js"><link rel="prefetch" href="/assets/js/43.d9b51124.js"><link rel="prefetch" href="/assets/js/44.dfc2a9ec.js"><link rel="prefetch" href="/assets/js/45.f8041f8f.js"><link rel="prefetch" href="/assets/js/46.270ccddd.js"><link rel="prefetch" href="/assets/js/47.a1532a93.js"><link rel="prefetch" href="/assets/js/48.8c7e0344.js"><link rel="prefetch" href="/assets/js/49.96bb4513.js"><link rel="prefetch" href="/assets/js/5.8ae01d1c.js"><link rel="prefetch" href="/assets/js/50.49447d4d.js"><link rel="prefetch" href="/assets/js/51.33e8a7bf.js"><link rel="prefetch" href="/assets/js/52.679961dc.js"><link rel="prefetch" href="/assets/js/53.fcff7b74.js"><link rel="prefetch" href="/assets/js/54.fd4abac4.js"><link rel="prefetch" href="/assets/js/55.5c15bdfa.js"><link rel="prefetch" href="/assets/js/57.3e0647d5.js"><link rel="prefetch" href="/assets/js/58.0ef4da42.js"><link rel="prefetch" href="/assets/js/59.d4a0e156.js"><link rel="prefetch" href="/assets/js/6.002af89b.js"><link rel="prefetch" href="/assets/js/60.041491c8.js"><link rel="prefetch" href="/assets/js/61.9bca77f9.js"><link rel="prefetch" href="/assets/js/7.446e4cb8.js"><link rel="prefetch" href="/assets/js/8.28bce57f.js"><link rel="prefetch" href="/assets/js/9.aec321b9.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.79a8d512.js">
    <link rel="stylesheet" href="/assets/css/0.styles.feb2d03d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">M18 Developer Center</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/en/wsdoc/" class="nav-link">
  WebServices
</a></div><div class="nav-item"><a href="/en/m18/" class="nav-link">
  App
</a></div><div class="nav-item"><a href="/zh-CN/" class="nav-link router-link-active">
  中文文档
</a></div><div class="nav-item"><a href="https://community.multiable.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><a href="/en/wsdoc/" class="nav-link">
  WebServices
</a></div><div class="nav-item"><a href="/en/m18/" class="nav-link">
  App
</a></div><div class="nav-item"><a href="/zh-CN/" class="nav-link router-link-active">
  中文文档
</a></div><div class="nav-item"><a href="https://community.multiable.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>M18 ERP EJB 接口 (后台接口)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zh-CN/ce01/ce01interface.html#massmailhandler" class="sidebar-link">MassMailHandler</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#handleemail函数" class="sidebar-link">handleEmail函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#sendemail函数" class="sidebar-link">sendEmail函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#updatefrozendate" class="sidebar-link">UpdateFrozenDate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-2" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#beforeupdatefrozen函数" class="sidebar-link">beforeUpdateFrozen函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#afterupdatefrozen函数" class="sidebar-link">afterUpdateFrozen函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#erpserverinitialized" class="sidebar-link">ErpServerInitialized</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-3" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#contextinitialized函数" class="sidebar-link">contextInitialized函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#afterinitialized函数" class="sidebar-link">afterInitialized函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#generaterecord" class="sidebar-link">GenerateRecord</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-4" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#beforesaverecord函数" class="sidebar-link">beforeSaveRecord函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#specbsruleitem" class="sidebar-link">SpecBsRuleItem</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-5" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getspecbsruleitem函数" class="sidebar-link">getSpecBsRuleItem函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#asavechkhandler" class="sidebar-link">ASaveChkHandler</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-6" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getasavechksql函数" class="sidebar-link">getASaveChkSql函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#generatedejblot" class="sidebar-link">GeneratedEJBLot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-7" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#originaccept函数" class="sidebar-link">originAccept函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#generate函数" class="sidebar-link">generate函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#generatedjsflot" class="sidebar-link">GeneratedJSFLot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-8" class="sidebar-link">目的</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#loadtradefooter" class="sidebar-link">LoadTradeFooter</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-9" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getmultipropricedesc函数" class="sidebar-link">getMultiProPriceDesc函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#assign-footer-updesc函数" class="sidebar-link">assign_footer_updesc函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#assignlotnohelper" class="sidebar-link">AssignLotnoHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-10" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#isaccept函数" class="sidebar-link">isAccept函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getassignlotno函数" class="sidebar-link">getAssignLotno函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#sortstock函数" class="sidebar-link">sortStock函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#isstockfit函数" class="sidebar-link">isStockFit函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#imaccalchandler" class="sidebar-link">IMacCalcHandler</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-11" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getorder函数" class="sidebar-link">getOrder函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#efe-mainfooter-up函数" class="sidebar-link">efe_mainfooter_up函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#calc-invamt函数" class="sidebar-link">calc_invamt函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getinchargeqtyfield函数" class="sidebar-link">getInChargeQtyField函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getfooterupfield函数" class="sidebar-link">getFooterUpField函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getfooterucfield函数" class="sidebar-link">getFooterUcField函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#updateprocost" class="sidebar-link">UpdateProCost</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-12" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#详细说明" class="sidebar-link">详细说明</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#loadbomdatasourcehelper" class="sidebar-link">LoadBomDataSourceHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-13" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#updatebomdatasourcedata函数" class="sidebar-link">updateBomDataSourceData函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#modulesettinghelper" class="sidebar-link">ModuleSettingHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-14" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#checkinventorymodule函数" class="sidebar-link">checkInventoryModule函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getstkmodule函数" class="sidebar-link">getStkModule函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#generatevoucher" class="sidebar-link">GenerateVoucher</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-15" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getudforder函数" class="sidebar-link">getUDFOrder函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#generateudfvoucher函数" class="sidebar-link">GenerateUDFVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#beforegeneratevoucher函数" class="sidebar-link">beforeGenerateVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#beforegent函数" class="sidebar-link">beforeGenT函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#aftergeneratevoucher函数" class="sidebar-link">afterGenerateVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#aftergenerateinstancevoucher函数" class="sidebar-link">afterGenerateInstanceVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#aftergeneratemodulevoucher函数" class="sidebar-link">afterGenerateModuleVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#aftergeneratetranvoucher函数" class="sidebar-link">afterGenerateTranVoucher函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#afterbatchrevertvoucher函数" class="sidebar-link">afterBatchRevertVoucher函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#prqallocate" class="sidebar-link">PrqAllocate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-16" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#supply-demand函数" class="sidebar-link">supply_demand函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#loadlocktranhelper" class="sidebar-link">LoadLockTranHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-17" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#addloadlocktrancond函数" class="sidebar-link">addLoadLockTranCond函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#tradingsettinghelper" class="sidebar-link">TradingSettingHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-18" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#getlasttrantablename函数" class="sidebar-link">getLastTranTableName函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#addtradingsettingdata函数" class="sidebar-link">addTradingSettingData函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#ecnhelper" class="sidebar-link">EcnHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-19" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#ecnchangeprocessextradata函数" class="sidebar-link">ecnChangeProcessExtraData函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#ecnchangematextradata函数" class="sidebar-link">ecnChangeMatExtraData函数</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#depositdatahelper" class="sidebar-link">DepositDataHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-20" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendardepositreceipt函数" class="sidebar-link">appendArDepositReceipt函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendapdepositreceipt函数" class="sidebar-link">appendApDepositReceipt函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-2" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendarosdeposit函数" class="sidebar-link">appendArOsDeposit函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-3" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendaposdeposit函数" class="sidebar-link">appendApOsDeposit函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-4" class="sidebar-link">例子</a></li></ul></li><li><a href="/zh-CN/ce01/ce01interface.html#financedatahelper" class="sidebar-link">FinanceDataHelper</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#目的-21" class="sidebar-link">目的</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#updatearinvoiceremain函数" class="sidebar-link">updateArInvoiceRemain函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-5" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#updateapinvoiceremain函数" class="sidebar-link">updateApInvoiceRemain函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-6" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendarosinvoice函数" class="sidebar-link">appendArOsInvoice函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-7" class="sidebar-link">例子</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#appendaposinvoice函数" class="sidebar-link">appendApOsInvoice函数</a></li><li class="sidebar-sub-header"><a href="/zh-CN/ce01/ce01interface.html#例子-8" class="sidebar-link">例子</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="m18-erp-ejb-接口-后台接口"><a href="#m18-erp-ejb-接口-后台接口" class="header-anchor">#</a> M18 ERP EJB 接口 (后台接口)</h1> <p>​													<code>Version: 1.1 | Release Date: 7/12/2018</code></p> <h2 id="massmailhandler"><a href="#massmailhandler" class="header-anchor">#</a> MassMailHandler</h2> <h3 id="目的"><a href="#目的" class="header-anchor">#</a> 目的</h3> <p>用于在[邮件报告设定]发送电子邮件时处理电子邮件。</p> <br> <h3 id="handleemail函数"><a href="#handleemail函数" class="header-anchor">#</a> <code>handleEmail</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">handleEmail</span><span class="token punctuation">(</span><span class="token class-name">MacEmail</span> email<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> massmail<span class="token punctuation">,</span> <span class="token class-name">CawReport</span> report<span class="token punctuation">,</span> <span class="token class-name">CawReportDataSet</span> dataSet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于在[邮件报告设定]发送电子邮件时处理电子邮件。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>email</td> <td><code>MacEmail</code></td> <td>邮件</td></tr> <tr><td>massmail</td> <td><code>SqlTable</code></td> <td>[邮件报告设定]主表</td></tr> <tr><td>report</td> <td><code>CawReport</code></td> <td>报表</td></tr> <tr><td>dataSet</td> <td><code>CawReportDataSet</code></td> <td>报表数据</td></tr></tbody></table> <br> <hr> <h3 id="sendemail函数"><a href="#sendemail函数" class="header-anchor">#</a> <code>sendEmail</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MacEmail</span><span class="token punctuation">&gt;</span></span> <span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> massmail<span class="token punctuation">,</span> <span class="token class-name">CawReport</span> report<span class="token punctuation">,</span> <span class="token class-name">CawReportDataSet</span> dataSet<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileKey<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> fileMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>它用于通过[邮件报告设定]发送电子邮件时，发送给更多的电子邮件地址。</p> <p>例如：在 core App 中，可以从客户/供应商/职员/部门/商业中心中获取邮件地址。</p> <p>例如：在 ac App 中，可以从应收对象/应付对象中获取邮件地址。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>massmail</td> <td><code>SqlTable</code></td> <td>[邮件报告设定]主表</td></tr> <tr><td>report</td> <td><code>CawReport</code></td> <td>报表</td></tr> <tr><td>dataSet</td> <td><code>CawReportDataSet</code></td> <td>报表数据</td></tr> <tr><td>fileKey</td> <td><code>Map&lt;Long, String&gt;</code></td> <td>预览文件的键值对，键是单据的ID，值是文件名。</td></tr> <tr><td>fileMap</td> <td><code>Map&lt;String, String&gt;</code></td> <td>预览文件路径的键值对，键是文件名，值是文件路径。</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Set&lt;MacEmail&gt;</code></td> <td>额外需发送的邮件</td></tr></tbody></table> <br> <br> <h2 id="updatefrozendate"><a href="#updatefrozendate" class="header-anchor">#</a> UpdateFrozenDate</h2> <h3 id="目的-2"><a href="#目的-2" class="header-anchor">#</a> 目的</h3> <p>在冻结日期要更新前后，开发人员可以进行干预操作。</p> <br> <h3 id="beforeupdatefrozen函数"><a href="#beforeupdatefrozen函数" class="header-anchor">#</a> <code>beforeUpdateFrozen</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">beforeUpdateFrozen</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Long</span> frozenTypeId<span class="token punctuation">,</span> <span class="token class-name">Date</span> frozenDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>冻结日期要更新前触发此函数。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>Long</code></td> <td>企业法人ID</td></tr> <tr><td>frozenTypeId</td> <td><code>Long</code></td> <td>交易冻结期类型ID</td></tr> <tr><td>frozenDate</td> <td><code>Date</code></td> <td>交易冻结期</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>运行结果说明的<code>messCode</code>。</td></tr></tbody></table> <p><strong>例子</strong></p> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">beforeUpdateFrozen</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Long</span> frozenTypeId<span class="token punctuation">,</span> <span class="token class-name">Date</span> frozenDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlTable</span> data <span class="token operator">=</span> <span class="token class-name">MacCheckerUtil</span><span class="token punctuation">.</span><span class="token function">excuteQuery</span><span class="token punctuation">(</span><span class="token string">&quot;frozentype&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; id = &quot;</span> <span class="token operator">+</span> frozenTypeId<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> data<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTable</span> beFile <span class="token operator">=</span> <span class="token class-name">MacUtil</span><span class="token punctuation">.</span><span class="token function">getBeGlobalSetting</span><span class="token punctuation">(</span>beId<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>beFile <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> beFile<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>frozenDate<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">)</span> beFile<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;stkClosed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token string">&quot;ce01_core.frozenPeriodSTKError&quot;</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><br> <hr> <h3 id="afterupdatefrozen函数"><a href="#afterupdatefrozen函数" class="header-anchor">#</a> <code>afterUpdateFrozen</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterUpdateFrozen</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Long</span> frozenTypeId<span class="token punctuation">,</span> <span class="token class-name">Date</span> frozenDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>冻结日期要更新后触发此函数。</p> <p><strong>参数</strong></p> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>beId</td> <td><code>Long</code></td> <td>企业法人ID</td></tr> <tr><td>frozenTypeId</td> <td><code>Long</code></td> <td>交易冻结期类型ID</td></tr> <tr><td>frozenDate</td> <td><code>Date</code></td> <td>交易冻结期</td></tr></tbody></table> <br> <br> <h2 id="erpserverinitialized"><a href="#erpserverinitialized" class="header-anchor">#</a> ErpServerInitialized</h2> <h3 id="目的-3"><a href="#目的-3" class="header-anchor">#</a> 目的</h3> <p>在同步数据库之后和JBoss完全启动之前，将触发此接口。</p> <p>它通常用于初始化缓存或初始化数据。</p> <br> <h3 id="contextinitialized函数"><a href="#contextinitialized函数" class="header-anchor">#</a> <code>contextInitialized</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>在同步数据库之后和JBoss完全启动之前，将触发此函数。</p> <br> <hr> <h3 id="afterinitialized函数"><a href="#afterinitialized函数" class="header-anchor">#</a> <code>afterInitialized</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterInitialized</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>在 <code>contextInitialized()</code>之后触发。</p> <br> <br> <h2 id="generaterecord"><a href="#generaterecord" class="header-anchor">#</a> GenerateRecord</h2> <h3 id="目的-4"><a href="#目的-4" class="header-anchor">#</a> 目的</h3> <p>用于创建模块单据，生成另一个模块单据时，与M18交互。 （示例：送货单生成销售发票记录）</p> <br> <h3 id="beforesaverecord函数"><a href="#beforesaverecord函数" class="header-anchor">#</a> <code>beforeSaveRecord</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">beforeSaveRecord</span><span class="token punctuation">(</span><span class="token class-name">SqlEntity</span> fromEntity<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token class-name">String</span> jsonParam<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>当目标单据（例如销售发票）准备好保存时触发此函数。 如果开发人员需要中止保存过程，则返回false。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>fromEntity</td> <td><code>SqlEntity</code></td> <td>来源单据实体数据。例如: [送货单]实体数据。</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>目标单据实体数据。例如: [销售发票]实体数据。</td></tr> <tr><td>jsonParam</td> <td><code>String</code></td> <td>额外的参数.</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>如果是 <code>false</code>，则中止保存操作。</td></tr></tbody></table> <br> <br> <h2 id="specbsruleitem"><a href="#specbsruleitem" class="header-anchor">#</a> SpecBsRuleItem</h2> <h3 id="目的-5"><a href="#目的-5" class="header-anchor">#</a> 目的</h3> <p>用于与M18交互，在系统中增加额外的业务规则。</p> <br> <h3 id="getspecbsruleitem函数"><a href="#getspecbsruleitem函数" class="header-anchor">#</a> <code>getSpecBsRuleItem</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BsRuleItem</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSpecBsRuleItem</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>当M18读取业务规则项时触发。 开发人员可以在Java中定义其他额外的业务规则并返回系统。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>Long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>触发业务规则的模块</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>List&lt;BsRuleItem&gt;</code></td> <td>额外业务规则列表</td></tr></tbody></table> <p><strong>例子</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TrdgSpecBsRuleItem</span> <span class="token keyword">implements</span> <span class="token class-name">SpecBsRuleItem</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BsRuleItem</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSpecBsRuleItem</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">MacUtil</span><span class="token punctuation">.</span><span class="token function">matchAppModule</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">,</span> <span class="token class-name">TradeStaticVar</span><span class="token punctuation">.</span>appName<span class="token punctuation">)</span>
				<span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">TradeUtil</span><span class="token punctuation">.</span><span class="token function">isTradingUdfEditor</span><span class="token punctuation">(</span>moduleName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BsRuleItem</span><span class="token punctuation">&gt;</span></span> specItems <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BsRuleItem</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">BsRule</span> rules <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BsRule</span><span class="token punctuation">)</span> <span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token class-name">ErpStaticVar</span><span class="token punctuation">.</span>bsRule<span class="token punctuation">,</span> <span class="token string">&quot;xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>rules <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">TradeUtil</span><span class="token punctuation">.</span><span class="token function">isAllowNs</span><span class="token punctuation">(</span>beId<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">TradeUtil</span><span class="token punctuation">.</span><span class="token function">checkInventoryModule</span><span class="token punctuation">(</span>beId<span class="token punctuation">,</span> moduleName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">BsRuleItem</span> allowNsItem <span class="token operator">=</span> rules<span class="token punctuation">.</span><span class="token function">getChkList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;allowNs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				specItems<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>allowNsItem<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> specItems<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <br> <h2 id="asavechkhandler"><a href="#asavechkhandler" class="header-anchor">#</a> ASaveChkHandler</h2> <h3 id="目的-6"><a href="#目的-6" class="header-anchor">#</a> 目的</h3> <p>用于在保存单据时与M18交互。 通常用于检查单据下款表的外键约束。</p> <p>例如，若[送货单]下款的来源[销售订单]中的货币ID不等于[送货单]中的货币ID，则销售订单无法保存。</p> <br> <h3 id="getasavechksql函数"><a href="#getasavechksql函数" class="header-anchor">#</a> <code>getASaveChkSql</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getASaveChkSql</span><span class="token punctuation">(</span><span class="token class-name">ASaveChkItem</span> item<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> mainData<span class="token punctuation">,</span> <span class="token class-name">String</span> chkValue<span class="token punctuation">,</span> <span class="token class-name">String</span> joinkeycol<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>定义用于检查以上示例是否有效的SQL：</p> <p>若[送货单]下款的来源[销售订单]中的货币ID不等于[送货单]中的货币ID，则销售订单无法保存。</p> <p>如果通过运行SQL返回的数据集非空，则无法保存单据并弹出错误。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>item</td> <td><code>ASaveChkItem</code></td> <td>检查的项目</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>mainData</td> <td><code>SqlTable</code></td> <td>保存单据的主表</td></tr> <tr><td>chkValue</td> <td><code>String</code></td> <td>检查栏位的值</td></tr> <tr><td>joinkeycol</td> <td><code>String</code></td> <td>链接主键的条件</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>SQL 语句</td></tr></tbody></table> <br> <br> <h2 id="generatedejblot"><a href="#generatedejblot" class="header-anchor">#</a> GeneratedEJBLot</h2> <h3 id="目的-7"><a href="#目的-7" class="header-anchor">#</a> 目的</h3> <p>用于在在EJB中生成行次时与M18交互。</p> <br> <h3 id="originaccept函数"><a href="#originaccept函数" class="header-anchor">#</a> <code>originAccept</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">originAccept</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>当行次将要生成时触发此函数。 用于确定当前模块是否应使用此接口生成批号。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>若为<code>true</code> 则可以继续调用此接口中的<code>generate()</code>生成行次，若为 <code>fales</code>，则按照系统默认规则生成行次。</td></tr></tbody></table> <br> <hr> <h3 id="generate函数"><a href="#generate函数" class="header-anchor">#</a> <code>generate</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">int</span> rowIndex<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">SqlTable</span> footer<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> emptyField<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span> lotField<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token class-name">String</span> proField<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>当<code>originAccept()</code> 返回<code>true</code>时，会触发此函数，此函数用来生成行次。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>beId</td> <td><code>Long</code></td> <td>企业法人ID</td></tr> <tr><td>rowIndex</td> <td><code>int</code></td> <td>当前下款表行次</td></tr> <tr><td>footer</td> <td><code>SqlTable</code></td> <td>当前下款表</td></tr> <tr><td>emptyField</td> <td><code>String[]</code></td> <td>判断当前行是否为空的关键栏位</td></tr> <tr><td>lotField</td> <td><code>String</code></td> <td>行次栏位</td></tr> <tr><td>proField</td> <td><code>String</code></td> <td>产品栏位</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>生成的行次</td></tr></tbody></table> <br> <br> <h2 id="generatedjsflot"><a href="#generatedjsflot" class="header-anchor">#</a> GeneratedJSFLot</h2> <h3 id="目的-8"><a href="#目的-8" class="header-anchor">#</a> 目的</h3> <p>当行次将要在JSF中生成时使用此接口。 函数与 <code>GeneratedEJBLot</code>相同，请参阅 <a href="#GeneratedEJBLot">GeneratedEJBLot</a> 以获取更多详细信息。</p> <br> <br> <h2 id="loadtradefooter"><a href="#loadtradefooter" class="header-anchor">#</a> LoadTradeFooter</h2> <h3 id="目的-9"><a href="#目的-9" class="header-anchor">#</a> 目的</h3> <p>从来源单据加载下款数据时触发，用于在下款表中加载单价和说明字段。</p> <br> <h3 id="getmultipropricedesc函数"><a href="#getmultipropricedesc函数" class="header-anchor">#</a> <code>getMultiProPriceDesc</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">SqlTable</span> <span class="token function">getMultiProPriceDesc</span><span class="token punctuation">(</span><span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Long</span> refId<span class="token punctuation">,</span> <span class="token class-name">Long</span> virDeptId<span class="token punctuation">,</span> <span class="token class-name">String</span> date<span class="token punctuation">,</span> <span class="token class-name">String</span> upOrigin<span class="token punctuation">,</span> <span class="token class-name">String</span> descOrigin<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> footer<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> proField<span class="token punctuation">,</span> <span class="token class-name">String</span> jsonParam<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>系统从来源单据读取下款数据后触发，开发人员可以使用此功能修改或覆盖结果集。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>beId</td> <td><code>Long</code></td> <td>企业法人ID</td></tr> <tr><td>refId</td> <td><code>Long</code></td> <td>客户/供应商ID</td></tr> <tr><td>virDeptId</td> <td><code>Long</code></td> <td>商业中心ID</td></tr> <tr><td>date</td> <td><code>String</code></td> <td>单据日期</td></tr> <tr><td>upOrigin</td> <td><code>String</code></td> <td>产品价格来源</td></tr> <tr><td>descOrigin</td> <td><code>String</code></td> <td>产品说明来源</td></tr> <tr><td>footer</td> <td><code>SqlTable</code></td> <td>下款表</td></tr> <tr><td>proField</td> <td><code>String[]</code></td> <td>确定唯一性的字段</td></tr> <tr><td>jsonParam</td> <td><code>String</code></td> <td>额外的参数</td></tr> <tr><td>result</td> <td><code>SqlTable</code></td> <td>结果集</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>SqlTable</code></td> <td>修改后的结果集。</td></tr></tbody></table> <br> <hr> <h3 id="assign-footer-updesc函数"><a href="#assign-footer-updesc函数" class="header-anchor">#</a> <code>assign_footer_updesc</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">assign_footer_updesc</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> footer<span class="token punctuation">,</span> <span class="token keyword">int</span> footerIndex<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> tarTable<span class="token punctuation">,</span> <span class="token keyword">int</span> rec<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>在系统加载&lt;精简说明&gt;和&lt;详细说明&gt;或者&lt;单位价格&gt;后，触发此函数。开发人员可以修改对应栏位的值。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>footer</td> <td><code>SqlTable</code></td> <td>下款表</td></tr> <tr><td>footerIndex</td> <td><code>int</code></td> <td>下款表行次</td></tr> <tr><td>tarTable</td> <td><code>SqlTable</code></td> <td>来源数据表</td></tr> <tr><td>rec</td> <td><code>int</code></td> <td>来源数据表行次</td></tr></tbody></table> <br> <br> <h2 id="assignlotnohelper"><a href="#assignlotnohelper" class="header-anchor">#</a> AssignLotnoHelper</h2> <h3 id="目的-10"><a href="#目的-10" class="header-anchor">#</a> 目的</h3> <p>用于开发人员与M18交互，修改已读取的系统默认的批号表信息。</p> <br> <h3 id="isaccept函数"><a href="#isaccept函数" class="header-anchor">#</a> <code>isAccept</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isAccept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于决定这个接口的其他函数是否继续运行。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>若为<code>true</code> ，则继续运行这个接口的其他函数。若为 <code>false</code>， 则中止运行这个接口的其他函数 。</td></tr></tbody></table> <br> <hr> <h3 id="getassignlotno函数"><a href="#getassignlotno函数" class="header-anchor">#</a> <code>getAssignLotno</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">SqlTable</span> <span class="token function">getAssignLotno</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>当M18读取了产品的批号库存信息后，开发人员可以在这个函数中修改批号库存表的信息。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>stock</td> <td><code>SqlTable</code></td> <td>库存批号表</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>SqlTable</code></td> <td>修改后的库存批号表</td></tr></tbody></table> <br> <hr> <h3 id="sortstock函数"><a href="#sortstock函数" class="header-anchor">#</a> <code>sortStock</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sortStock</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stock<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sortFieldList<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Boolean</span><span class="token punctuation">&gt;</span></span> sortTypeList<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>在<code>getAssignLotno()</code>之后触发，用来为库存批号表重新排序。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>stock</td> <td><code>SqlTable</code></td> <td>库存批号表</td></tr> <tr><td>sortFieldList</td> <td><code>List&lt;String&gt;</code></td> <td>排序字段列表</td></tr> <tr><td>sortTypeList</td> <td><code>List&lt;Boolean&gt;</code></td> <td>排序字段列表对应的排序方式。若为 <code>true</code>，则是升序，若为 <code>false</code> ，则是降序。</td></tr></tbody></table> <br> <hr> <h3 id="isstockfit函数"><a href="#isstockfit函数" class="header-anchor">#</a> <code>isStockFit</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isStockFit</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stock<span class="token punctuation">,</span> <span class="token keyword">int</span> stockIndex<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> footer<span class="token punctuation">,</span> <span class="token keyword">int</span> footerIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>判断当前库存批号表的行，是否符合分配的条件。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>stock</td> <td><code>SqlTable</code></td> <td>库存批号表</td></tr> <tr><td>stockIndex</td> <td><code>int</code></td> <td>库存批号表行次</td></tr> <tr><td>footer</td> <td><code>SqlTable</code></td> <td>被分配批号的下款表</td></tr> <tr><td>footerIndex</td> <td><code>int</code></td> <td>下款表行次</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>若为 <code>false</code>，则库存批号表当前行不能被分配。</td></tr></tbody></table> <br> <br> <h2 id="imaccalchandler"><a href="#imaccalchandler" class="header-anchor">#</a> IMacCalcHandler</h2> <h3 id="目的-11"><a href="#目的-11" class="header-anchor">#</a> 目的</h3> <p>该接口用于M18移动应用程序与M18交互。</p> <br> <h3 id="getorder函数"><a href="#getorder函数" class="header-anchor">#</a> <code>getOrder</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>定义接口的顺序，数字越小，接口调用越早。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>int</code></td> <td>返回代表调用顺序的数字。</td></tr></tbody></table> <br> <hr> <h3 id="efe-mainfooter-up函数"><a href="#efe-mainfooter-up函数" class="header-anchor">#</a> <code>efe_mainfooter_up</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">efe_mainfooter_up</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> tranType<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> footer<span class="token punctuation">,</span> <span class="token keyword">int</span> rowIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>&lt;单位价格&gt;被赋值时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>tranType</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>footer</td> <td><code>SqlTable</code></td> <td>下款表</td></tr> <tr><td>rowIndex</td> <td><code>int</code></td> <td>下款表行次</td></tr></tbody></table> <br> <hr> <h3 id="calc-invamt函数"><a href="#calc-invamt函数" class="header-anchor">#</a> <code>calc_invamt</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">calc_invamt</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> tranType<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> mainData<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> mainFooter<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> mainDisc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于在保存单据之前计算上款中的&lt;总金额/总费用/总折扣/折实金额&gt;。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>tranType</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>mainData</td> <td><code>SqlTable</code></td> <td>主表</td></tr> <tr><td>mainFooter</td> <td><code>SqlTable</code></td> <td>下款表</td></tr> <tr><td>mainDisc</td> <td><code>SqlTable</code></td> <td>附加折扣/收费表</td></tr></tbody></table> <br> <hr> <h3 id="getinchargeqtyfield函数"><a href="#getinchargeqtyfield函数" class="header-anchor">#</a> <code>getInChargeQtyField</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getInChargeQtyField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;qty&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>用户获取下款表计算金额时所使用的数量栏位名。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回下款表计算金额时的数量栏位名</td></tr></tbody></table> <br> <hr> <h3 id="getfooterupfield函数"><a href="#getfooterupfield函数" class="header-anchor">#</a> <code>getFooterUpField</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getFooterUpField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;up&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用户获取下款表计算金额时所使用的单价栏位名。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回下款表计算金额时的单价栏位名</td></tr></tbody></table> <br> <hr> <h3 id="getfooterucfield函数"><a href="#getfooterucfield函数" class="header-anchor">#</a> <code>getFooterUcField</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getFooterUcField</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;uc&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用户获取下款表计算金额时所使用的成本栏位名。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回下款表计算金额时的成本栏位名</td></tr></tbody></table> <br> <br> <h2 id="updateprocost"><a href="#updateprocost" class="header-anchor">#</a> UpdateProCost</h2> <h3 id="目的-12"><a href="#目的-12" class="header-anchor">#</a> 目的</h3> <p>开发人员与M18交互，用于计算库存成本。</p> <br> <h3 id="详细说明"><a href="#详细说明" class="header-anchor">#</a> 详细说明</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UpdateProCost</span> <span class="token punctuation">{</span>

	<span class="token comment">/**
	 * For Product LLC
	 * this function can be replaced by using procedure named get_pro_llc_*
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">SqlTable</span> <span class="token function">getMatList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * For Data Updating(Stock In UC)
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">beforeLoadData</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> codeList<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * can append special field used in the getCalcUc
	 * or
	 * update data
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterLoadData</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> codeList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stockIn<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stockOut<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stock_open<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * 1: return false(CalcUcStatus.skipOther) means skip the other instance of UpdateProCost
	 * 2: for special value please set it to CalcUcStatus.uc(and set CalcUcStatus.setUc = true)
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">CalcUcStatus</span> <span class="token function">getCalcUc</span><span class="token punctuation">(</span><span class="token class-name">String</span> stk_mth<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStockIn<span class="token punctuation">,</span> <span class="token keyword">int</span> rowIndex<span class="token punctuation">,</span> <span class="token keyword">double</span> calcUc<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> tempVarList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> tempStockIn<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> tempStockOut<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">calcFIFOUc</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> inVARLIST<span class="token punctuation">,</span> <span class="token class-name">Long</span> proId<span class="token punctuation">,</span> <span class="token class-name">Date</span> tranDate<span class="token punctuation">,</span> <span class="token keyword">int</span> outIndex<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stockIn<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stockOut<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stock_open<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> outAss<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> retAss<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> retUesd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * For Product Cost Updating(PC)
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterUpdateUc</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> codeList<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * For Data Updating After Close Stock
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterCloseStock</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">/**
	 * For Data Updating After Reverse Stock
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">afterReverseStock</span><span class="token punctuation">(</span><span class="token class-name">Long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> varList<span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <br> <h2 id="loadbomdatasourcehelper"><a href="#loadbomdatasourcehelper" class="header-anchor">#</a> LoadBomDataSourceHelper</h2> <h3 id="目的-13"><a href="#目的-13" class="header-anchor">#</a> 目的</h3> <p>用于给开发人员修改读取的即时成本里的BOM资料信息。</p> <br> <h3 id="updatebomdatasourcedata函数"><a href="#updatebomdatasourcedata函数" class="header-anchor">#</a> <code>updateBomDataSourceData</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SqlTable</span><span class="token punctuation">&gt;</span></span> <span class="token function">updateBomDataSourceData</span><span class="token punctuation">(</span><span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">int</span> bomRec<span class="token punctuation">,</span> <span class="token keyword">int</span> footerIndex<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SqlTable</span><span class="token punctuation">&gt;</span></span> bomInfo<span class="token punctuation">,</span> <span class="token class-name">String</span> bomDataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>读取即时成本资料时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>entity</td> <td><code>SqlEntity</code></td> <td>当前模块的数据实体</td></tr> <tr><td>bomRec</td> <td><code>int</code></td> <td>BOM的行次</td></tr> <tr><td>footerIndex</td> <td><code>int</code></td> <td>下款表的行次</td></tr> <tr><td>bomInfo</td> <td><code>List&lt;SqlTable&gt;</code></td> <td>读取BOM信息的列表，使用<code>bomInfo.get(0)</code> 获取BOM的主查询信息。</td></tr> <tr><td>bomDataSource</td> <td><code>String</code></td> <td>数据来源类型</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>返回修改后的 <code>bomInfo</code>.</td></tr></tbody></table> <br> <br> <h2 id="modulesettinghelper"><a href="#modulesettinghelper" class="header-anchor">#</a> ModuleSettingHelper</h2> <h3 id="目的-14"><a href="#目的-14" class="header-anchor">#</a> 目的</h3> <p>用于扩展判定模块是否为库存模块。</p> <br> <h3 id="checkinventorymodule函数"><a href="#checkinventorymodule函数" class="header-anchor">#</a> <code>checkInventoryModule</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">checkInventoryModule</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>判断当前模块是否为库存模块。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>boolean</code></td> <td>若为<code>true</code>，则当前模块为库存模块。</td></tr></tbody></table> <br> <hr> <h3 id="getstkmodule函数"><a href="#getstkmodule函数" class="header-anchor">#</a> <code>getStkModule</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">SqlTable</span> <span class="token function">getStkModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>用户读取库存模块，用来生成[业务流程]的缓存数据。</p> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>SqlTable</code></td> <td>一个只有一列(<code>module</code>)的 <code>SqlTable</code> 表。提供额外的库存模块。</td></tr></tbody></table> <br> <br> <h2 id="generatevoucher"><a href="#generatevoucher" class="header-anchor">#</a> GenerateVoucher</h2> <h3 id="目的-15"><a href="#目的-15" class="header-anchor">#</a> 目的</h3> <p>用于开发者与M18，在生成交易单据的凭证时的交互。</p> <br> <h3 id="getudforder函数"><a href="#getudforder函数" class="header-anchor">#</a> <code>getUDFOrder</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">getUDFOrder</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于决定 <code>GenerateUDFVoucher()</code>函数是否该调用。返回的数值必须大于 <code>-1</code>。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>当前单据的实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>用于标志该单据是否为库存单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>int</code></td> <td><code>GenerateUDFVoucher()</code> 需要被调用，返回值必须大于 <code>-1</code>。</td></tr></tbody></table> <br> <hr> <h3 id="generateudfvoucher函数"><a href="#generateudfvoucher函数" class="header-anchor">#</a> <code>GenerateUDFVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">Object</span> <span class="token class-name">GenerateUDFVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>重写系统默认凭证生成规则， 将新SQL提供给系统并生成凭证。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>单据实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Object</code></td> <td>若返回 <code>null</code> ，则当前函数无任何影响，进程继续运行。若返回 <code>CheckMsg</code> ，则中止当前运行进程，单据会保存失败。若返回 <code>List&lt;String&gt;</code> ，则包含所有生成凭证的SQL语句。</td></tr></tbody></table> <br> <hr> <h3 id="beforegeneratevoucher函数"><a href="#beforegeneratevoucher函数" class="header-anchor">#</a> <code>beforeGenerateVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">beforeGenerateVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p><code>GenerateUDFVouche()</code>返回<code>null</code>时触发，开发人员可以在生成默认SQL语句之前提供其他的SQL语句。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>单据实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回SQL语句必须在执行系统生成的SQL语句前执行。</td></tr></tbody></table> <br> <hr> <h3 id="beforegent函数"><a href="#beforegent函数" class="header-anchor">#</a> <code>beforeGenT</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">beforeGenT</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>当 <code>GenerateUDFVoucher()</code> 返回<code>null</code>并且开发人员在生成默认SQL语句之前提供其他SQL语句时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>单据实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行之前执行。</td></tr></tbody></table> <br> <hr> <h3 id="aftergeneratevoucher函数"><a href="#aftergeneratevoucher函数" class="header-anchor">#</a> <code>afterGenerateVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">afterGenerateVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">,</span> <span class="token class-name">Long</span> voucherId<span class="token punctuation">,</span> <span class="token keyword">boolean</span> genModel<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p><code>GenerateUDFVoucher()</code>返回<code>null</code>并且开发人员在生成凭证的所有默认SQL语句执行后有提供其他SQL语句时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>单据实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr> <tr><td>voucherId</td> <td><code>Long</code></td> <td>记账凭证ID</td></tr> <tr><td>genModel</td> <td><code>boolean</code></td> <td>标志凭证是否是即时生成的。</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行后执行。</td></tr></tbody></table> <br> <hr> <h3 id="aftergenerateinstancevoucher函数"><a href="#aftergenerateinstancevoucher函数" class="header-anchor">#</a> <code>afterGenerateInstanceVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">afterGenerateInstanceVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p><code>afterGenerateVoucher()</code> 之后触发，并在保存交易后生成凭证（即时凭证）。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>entity</td> <td><code>SqlEntity</code></td> <td>单据实体数据</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行后执行。</td></tr></tbody></table> <br> <hr> <h3 id="aftergeneratemodulevoucher函数"><a href="#aftergeneratemodulevoucher函数" class="header-anchor">#</a> <code>afterGenerateModuleVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">afterGenerateModuleVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>在模块是批量生成凭证的条件下，并所有系统默认的SQL语句生成时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>数名</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>ids</td> <td><code>List&lt;Long&gt;</code></td> <td>单据的ID列表</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行后执行</td></tr></tbody></table> <br> <hr> <h3 id="aftergeneratetranvoucher函数"><a href="#aftergeneratetranvoucher函数" class="header-anchor">#</a> <code>afterGenerateTranVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">afterGenerateTranVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token keyword">long</span> ids<span class="token punctuation">,</span> <span class="token keyword">boolean</span> isStock<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>在模块是批量生成凭证的条件下，并所有系统默认的SQL语句生成时触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>moduleName</td> <td><code>String</code></td> <td>模块名称</td></tr> <tr><td>ids</td> <td><code>long</code></td> <td>单据的ID列表</td></tr> <tr><td>isStock</td> <td><code>boolean</code></td> <td>标志单据是否为库存相关单据</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行后执行</td></tr></tbody></table> <br> <hr> <h3 id="afterbatchrevertvoucher函数"><a href="#afterbatchrevertvoucher函数" class="header-anchor">#</a> <code>afterBatchRevertVoucher</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">afterBatchRevertVoucher</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> jlId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>在凭证要还原并且所有系统默认的SQL语句生成的时候触发。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>jlId</td> <td><code>long</code></td> <td>要还原的凭证的ID列表</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回的SQL语句需要在系统生成的SQL语句执行后执行</td></tr></tbody></table> <br> <br> <h2 id="prqallocate"><a href="#prqallocate" class="header-anchor">#</a> PrqAllocate</h2> <h3 id="目的-16"><a href="#目的-16" class="header-anchor">#</a> 目的</h3> <p>在处理生成MRP单据时与M18进行交互。</p> <br> <h3 id="supply-demand函数"><a href="#supply-demand函数" class="header-anchor">#</a> <code>supply_demand</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">void</span> <span class="token function">supply_demand</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> etdList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> etaList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> stkList<span class="token punctuation">,</span> <span class="token class-name">SqlTable</span> etd_supply_List<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>为MRP生成单据中的特殊情况分配需求和供应数量。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>etdList</td> <td><code>SqlTable</code></td> <td>步骤2中需求列表</td></tr> <tr><td>etaList</td> <td><code>SqlTable</code></td> <td>步骤2中供应列表</td></tr> <tr><td>stkList</td> <td><code>SqlTable</code></td> <td>库存列表</td></tr> <tr><td>etd_supply_List</td> <td><code>SqlTable</code></td> <td>按[可用量配置]的分配结果。</td></tr></tbody></table> <br> <br> <h2 id="loadlocktranhelper"><a href="#loadlocktranhelper" class="header-anchor">#</a> LoadLockTranHelper</h2> <h3 id="目的-17"><a href="#目的-17" class="header-anchor">#</a> 目的</h3> <p>[锁定/解锁物料]模块与M18的交互。</p> <br> <h3 id="addloadlocktrancond函数"><a href="#addloadlocktrancond函数" class="header-anchor">#</a> <code>addLoadLockTranCond</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addLoadLockTranCond</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> loadType<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FormatCond</span><span class="token punctuation">&gt;</span></span> conds<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>读取相应的锁定/无锁定的物料时触发。 开发人员可以修改条件并影响搜索结果。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>loadType</td> <td><code>String</code></td> <td>标识读取物料的类型，有<code>lock</code>, <code>release</code>两种。</td></tr> <tr><td>module</td> <td><code>String</code></td> <td>读取物料的模块</td></tr> <tr><td>conds</td> <td><code>List&lt;FormatCond&gt;</code></td> <td>用户自定义的条件</td></tr></tbody></table> <h2 id="tradingsettinghelper"><a href="#tradingsettinghelper" class="header-anchor">#</a> TradingSettingHelper</h2> <h3 id="目的-18"><a href="#目的-18" class="header-anchor">#</a> 目的</h3> <p>用于扩展[贸易参数设定]设置模块。</p> <br> <h3 id="getlasttrantablename函数"><a href="#getlasttrantablename函数" class="header-anchor">#</a> <code>getLastTranTableName</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">getLastTranTableName</span><span class="token punctuation">(</span><span class="token class-name">String</span> origin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>获取“上一次交易记录”来源的类型在缓存中的表名称。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>origin</td> <td><code>String</code></td> <td>“上一次交易记录”来源的类型</td></tr></tbody></table> <p><strong>返回值</strong></p> <table><thead><tr><th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td><code>String</code></td> <td>返回“上一次交易记录”来源的类型在缓存中的表名称</td></tr></tbody></table> <hr> <h3 id="addtradingsettingdata函数"><a href="#addtradingsettingdata函数" class="header-anchor">#</a> <code>addTradingSettingData</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">addTradingSettingData</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">SqlTable</span><span class="token punctuation">&gt;</span></span> cacheMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>为<code>TradeStaticVar.tradingSetting</code>缓存增加额外的缓存数据。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>cacheMap</td> <td><code>Map&lt;String, SqlTable&gt;</code></td> <td><code>TradeStaticVar.tradingSetting</code>缓存数据</td></tr></tbody></table> <h2 id="ecnhelper"><a href="#ecnhelper" class="header-anchor">#</a> EcnHelper</h2> <h3 id="目的-19"><a href="#目的-19" class="header-anchor">#</a> 目的</h3> <p>用于扩展[工程变更单]模块。</p> <br> <h3 id="ecnchangeprocessextradata函数"><a href="#ecnchangeprocessextradata函数" class="header-anchor">#</a> <code>ecnChangeProcessExtraData</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">ecnChangeProcessExtraData</span><span class="token punctuation">(</span><span class="token class-name">SqlEntity</span> ecnpEntity<span class="token punctuation">,</span> <span class="token keyword">int</span> ecnptRec<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> bomEntity<span class="token punctuation">,</span> <span class="token keyword">int</span> bomptRec<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于[工程变更单(工艺)]模块，对扩展增加的数据，替换到BOM变更单。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>ecnpEntity</td> <td><code>SqlEntity</code></td> <td>[工程变更单(工艺)]的实体数据</td></tr> <tr><td>ecnptRec</td> <td><code>int</code></td> <td>[工程变更单(工艺)]的行次</td></tr> <tr><td>bomEntity</td> <td><code>SqlEntity</code></td> <td>[BOM]的实体数据</td></tr> <tr><td>bomptRec</td> <td><code>int</code></td> <td>[BOM]工艺下款被变更的行次</td></tr></tbody></table> <hr> <h3 id="ecnchangematextradata函数"><a href="#ecnchangematextradata函数" class="header-anchor">#</a> <code>ecnChangeMatExtraData</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code>	<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">ecnChangeMatExtraData</span><span class="token punctuation">(</span><span class="token class-name">SqlEntity</span> ecnmEntity<span class="token punctuation">,</span> <span class="token keyword">int</span> ecnmtRec<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> bomEntity<span class="token punctuation">,</span> <span class="token keyword">int</span> bomtRec<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于[工程变更单(物料)]模块，对扩展增加的数据，替换到BOM变更单。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>ecnmEntity</td> <td><code>SqlEntity</code></td> <td>[工程变更单(物料)]的实体数据</td></tr> <tr><td>ecnmtRec</td> <td><code>int</code></td> <td>[工程变更单(物料)]的行次</td></tr> <tr><td>bomEntity</td> <td><code>SqlEntity</code></td> <td>[BOM]的实体数据</td></tr> <tr><td>bomtRec</td> <td><code>int</code></td> <td>[BOM]物料下款被变更的行次</td></tr></tbody></table> <h2 id="depositdatahelper"><a href="#depositdatahelper" class="header-anchor">#</a> DepositDataHelper</h2> <h3 id="目的-20"><a href="#目的-20" class="header-anchor">#</a> 目的</h3> <p>用于扩展 应收订金单据 和 收取/清缴订金。</p> <br> <h3 id="appendardepositreceipt函数"><a href="#appendardepositreceipt函数" class="header-anchor">#</a> <code>appendArDepositReceipt</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendArDepositReceipt</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> 			<span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> 	 loadGroupCo<span class="token punctuation">,</span> <span class="token class-name">String</span> arapAlloType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 订金收款单据/订金使用单据 的数据，例如[零售发票]里收取的订金。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>订金收款的数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应收对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应收对象ID</td></tr> <tr><td>sourceId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>orderList</td> <td><code>String</code></td> <td>读取数据的单据筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>是否读取集团数据</td></tr> <tr><td>arapAlloType</td> <td><code>String</code></td> <td>应收/应付核销读取订金的类别</td></tr></tbody></table> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取订金收款单据时，需要包括[零售发票]收取的订金，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendArDepositReceipt</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span>   	<span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> 	<span class="token class-name">String</span> arapAlloType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_poscoreac_recregdeposet (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> 			<span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> sourceId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> orderList <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> moduleFrom 		<span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="appendapdepositreceipt函数"><a href="#appendapdepositreceipt函数" class="header-anchor">#</a> <code>appendApDepositReceipt</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendApDepositReceipt</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> 			<span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> 	 loadGroupCo<span class="token punctuation">,</span> <span class="token class-name">String</span> arapAlloType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 订金付款单据/订金使用单据 的数据，例如[委外加工发票]里使用的订金。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>订金付款的数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应付对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应付对象ID</td></tr> <tr><td>sourceId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>orderList</td> <td><code>String</code></td> <td>读取数据的单据筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>是否读取集团数据</td></tr> <tr><td>arapAlloType</td> <td><code>String</code></td> <td>应收/应付核销读取订金的类别</td></tr></tbody></table> <h3 id="例子-2"><a href="#例子-2" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取订金付款单据时，需要扣减[委外加工发票]使用的订金，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendApDepositReceipt</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span> 		<span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> 	<span class="token class-name">String</span> arapAlloType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_pdcoreac_payregdeposet (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> 			<span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> sourceId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> orderList <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> moduleFrom 		<span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> depMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Double</span><span class="token punctuation">&gt;</span></span> depDomMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">int</span> deci <span class="token operator">=</span> <span class="token class-name">MacUtil</span><span class="token punctuation">.</span><span class="token function">getAmtDecimal</span><span class="token punctuation">(</span>beId<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> rec <span class="token operator">:</span> myTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">String</span> sTranType <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sTranType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">long</span> sTranId <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sTranId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">String</span> refType <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;refType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">long</span> sorId <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sorId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">String</span> lot <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;lot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token class-name">String</span> key <span class="token operator">=</span> sTranType <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> sTranId <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> 					refType <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> sorId <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> lot<span class="token punctuation">;</span>

				<span class="token keyword">double</span> depoAmt <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;depoAmt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">double</span> domDepoAmt <span class="token operator">=</span> myTable<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;domDepoAmt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>depMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					depoAmt <span class="token operator">=</span> <span class="token class-name">MathLib</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>depoAmt <span class="token operator">+</span> depMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> deci<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>depDomMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					domDepoAmt <span class="token operator">=</span> <span class="token class-name">MathLib</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>domDepoAmt <span class="token operator">+</span> depDomMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> deci<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				depMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> depoAmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
				depDomMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> domDepoAmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> recList <span class="token operator">=</span> <span class="token class-name">ListLib</span><span class="token punctuation">.</span><span class="token function">newList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> rec <span class="token operator">:</span> retTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">String</span> sTranType <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sTranType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">long</span> sTranId <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sTranId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">String</span> refType <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;refType&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">long</span> sorId <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;sorId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">String</span> lot <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getValueStr</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;lot&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">double</span> bal <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;bal&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">double</span> balAmt <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;balAmt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">double</span> balDomAmt <span class="token operator">=</span> retTable<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;balDomAmt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token class-name">String</span> key <span class="token operator">=</span> sTranType <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> sTranId <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> 					refType <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> sorId <span class="token operator">+</span> <span class="token class-name">StringLib</span><span class="token punctuation">.</span>separate <span class="token operator">+</span> lot<span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>depMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					bal <span class="token operator">=</span> <span class="token class-name">MathLib</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>bal <span class="token operator">+</span> depMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> deci<span class="token punctuation">)</span><span class="token punctuation">;</span>
					balAmt <span class="token operator">=</span> <span class="token class-name">MathLib</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>balAmt <span class="token operator">-</span> depMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> deci<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>depDomMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					balDomAmt <span class="token operator">=</span> <span class="token class-name">MathLib</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>balDomAmt <span class="token operator">-</span> depDomMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> deci<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				retTable<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;bal&quot;</span><span class="token punctuation">,</span> bal<span class="token punctuation">)</span><span class="token punctuation">;</span>
				retTable<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;balAmt&quot;</span><span class="token punctuation">,</span> balAmt<span class="token punctuation">)</span><span class="token punctuation">;</span>
				retTable<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;balDomAmt&quot;</span><span class="token punctuation">,</span> balDomAmt<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>balAmt <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					recList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>rec<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span>recList<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				retTable<span class="token punctuation">.</span><span class="token function">deleteRows</span><span class="token punctuation">(</span>recList<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="appendarosdeposit函数"><a href="#appendarosdeposit函数" class="header-anchor">#</a> <code>appendArOsDeposit</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendArOsDeposit</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> 	tranType<span class="token punctuation">,</span> <span class="token keyword">long</span> tranId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadAll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应收订金单据 的数据，例如[委外代销订单]里的订金。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>订金数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应收对象ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>tranType</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>tranId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>orderList</td> <td><code>String</code></td> <td>读取数据的单据筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>是否读取集团数据</td></tr> <tr><td>loadAll</td> <td><code>boolean</code></td> <td>是否读取没有结余的单据</td></tr></tbody></table> <h3 id="例子-3"><a href="#例子-3" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取 应收订金单据 时，需要增加[委外代销订单]的订金，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendArOsDeposit</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> 			tranType<span class="token punctuation">,</span> <span class="token keyword">long</span> tranId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadAll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_consigncoamt2 (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> <span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tranType <span class="token operator">+</span> 	 <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> tranId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> orderList <span class="token operator">+</span> <span class="token string">&quot;',&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">+</span> 		<span class="token punctuation">(</span>loadAll <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

	<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="appendaposdeposit函数"><a href="#appendaposdeposit函数" class="header-anchor">#</a> <code>appendApOsDeposit</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendApOsDeposit</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> 	tranType<span class="token punctuation">,</span> <span class="token keyword">long</span> tranId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadAll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应付订金单据 的数据，例如[委外加工订单]里的订金。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>订金数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应付对象ID</td></tr> <tr><td>tranType</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>tranId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>orderList</td> <td><code>String</code></td> <td>读取数据的单据筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>是否读取集团数据</td></tr> <tr><td>loadAll</td> <td><code>boolean</code></td> <td>是否读取没有结余的订单</td></tr></tbody></table> <h3 id="例子-4"><a href="#例子-4" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取 应付订金单据 时，需要增加[委外加工订单]的订金，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendApOsDeposit</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> 			tranType<span class="token punctuation">,</span> <span class="token keyword">long</span> tranId<span class="token punctuation">,</span> <span class="token class-name">String</span> tDate<span class="token punctuation">,</span> <span class="token class-name">String</span> orderList<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadAll<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_pdcoreac_amt (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> <span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tranType <span class="token operator">+</span> 	<span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> tranId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> orderList <span class="token operator">+</span> <span class="token string">&quot;',&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">+</span> 		<span class="token punctuation">(</span>loadAll <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

	<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="financedatahelper"><a href="#financedatahelper" class="header-anchor">#</a> FinanceDataHelper</h2> <h3 id="目的-21"><a href="#目的-21" class="header-anchor">#</a> 目的</h3> <p>用于扩展应收发票。</p> <br> <h3 id="updatearinvoiceremain函数"><a href="#updatearinvoiceremain函数" class="header-anchor">#</a> <code>updateArInvoiceRemain</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">updateArInvoiceRemain</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token keyword">long</span> sTranId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiId<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> tDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应收发票 的结余金额，例如[XXXX应收发票]。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>发票结余金额的数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应收对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应收对象ID</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>sourceId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>sTranId</td> <td><code>long</code></td> <td>应收发票的单据ID</td></tr> <tr><td>multiId</td> <td><code>long</code></td> <td>批量收款单ID</td></tr> <tr><td>sTranType</td> <td><code>String</code></td> <td>应收发票的单据类型</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr></tbody></table> <h3 id="例子-5"><a href="#例子-5" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取[XXXX应收发票]的应收结余金额时，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">updateArInvoiceRemain</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token keyword">long</span> sTranId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiId<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> tDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_xxxx_arRemain (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> 			<span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> moduleFrom <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> sourceId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> sTranType <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> sTranId <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> 		<span class="token operator">+</span> multiRecId <span class="token operator">+</span> <span class="token string">&quot;,'&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;')&quot;</span><span class="token punctuation">;</span>	

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="updateapinvoiceremain函数"><a href="#updateapinvoiceremain函数" class="header-anchor">#</a> <code>updateApInvoiceRemain</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">updateApInvoiceRemain</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token keyword">long</span> sTranId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiId<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> tDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应付发票 的结余金额，例如[XXXX应付发票]。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>发票结余金额的数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应付对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应付对象ID</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取数据的单据类型</td></tr> <tr><td>sourceId</td> <td><code>long</code></td> <td>读取数据的单据ID</td></tr> <tr><td>sTranId</td> <td><code>long</code></td> <td>应付发票的单据ID</td></tr> <tr><td>multiId</td> <td><code>long</code></td> <td>批量付款单ID</td></tr> <tr><td>sTranType</td> <td><code>String</code></td> <td>应付发票的单据类型</td></tr> <tr><td>tDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr></tbody></table> <h3 id="例子-6"><a href="#例子-6" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取[XXXX应付发票]的应付结余金额时，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">updateApInvoiceRemain</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">long</span> sourceId<span class="token punctuation">,</span> <span class="token keyword">long</span> sTranId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiId<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> tDate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_xxxx_apRemain (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> 			<span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> moduleFrom <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> sourceId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> sTranType <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> sTranId <span class="token operator">+</span> <span class="token string">&quot;,&quot;</span> 		<span class="token operator">+</span> multiRecId <span class="token operator">+</span> <span class="token string">&quot;,'&quot;</span> <span class="token operator">+</span> tDate <span class="token operator">+</span> <span class="token string">&quot;')&quot;</span><span class="token punctuation">;</span>	

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="appendarosinvoice函数"><a href="#appendarosinvoice函数" class="header-anchor">#</a> <code>appendArOsInvoice</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendArOsInvoice</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 		<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> recregId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiRecId<span class="token punctuation">,</span> <span class="token class-name">String</span> sDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> 	 eDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sStaff<span class="token punctuation">,</span> <span class="token class-name">String</span> eStaff<span class="token punctuation">,</span> <span class="token keyword">int</span> loadCrNote<span class="token punctuation">,</span> <span class="token class-name">String</span> invList<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应收发票 的结余数据，例如[XXXX应收发票]。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>发票结余数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应收对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应收对象ID</td></tr> <tr><td>recregId</td> <td><code>long</code></td> <td>读取发票的单据ID</td></tr> <tr><td>multiRecId</td> <td><code>long</code></td> <td>批量收款单ID</td></tr> <tr><td>sDate</td> <td><code>String</code></td> <td>读取数据的开始日期</td></tr> <tr><td>eDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>sDDate</td> <td><code>String</code></td> <td>读取数据的开始到期日</td></tr> <tr><td>eDDate</td> <td><code>String</code></td> <td>读取数据的截至到期日</td></tr> <tr><td>sStaff</td> <td><code>String</code></td> <td>读取数据的开始职员编号</td></tr> <tr><td>eStaff</td> <td><code>String</code></td> <td>读取数据的截至职员编号</td></tr> <tr><td>loadCrNote</td> <td><code>int</code></td> <td>读取没有结余的单据（1：是；0：否）</td></tr> <tr><td>invList</td> <td><code>String</code></td> <td>应收发票的筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>sTranType</td> <td><code>String</code></td> <td>应收发票类型筛选条件</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取发票的单据类型</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>读取集团数据</td></tr></tbody></table> <h3 id="例子-7"><a href="#例子-7" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取[XXXX应收发票]的应收结余数据时，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendArOsInvoice</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> recregId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiRecId<span class="token punctuation">,</span> <span class="token class-name">String</span> sDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDDate<span class="token punctuation">,</span> 		<span class="token class-name">String</span> sStaff<span class="token punctuation">,</span> <span class="token class-name">String</span> eStaff<span class="token punctuation">,</span> <span class="token keyword">int</span> loadCrNote<span class="token punctuation">,</span> <span class="token class-name">String</span> invList<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> <span class="token class-name">String</span> 			moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_xxxx_napbal (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> 			<span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> payRegId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> multiPayId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> sDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> 			sDDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eDDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> sStaff <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eStaff <span class="token operator">+</span> <span class="token string">&quot;',&quot;</span> <span class="token operator">+</span> loadDbNote <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> 		invList <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> sTranType <span class="token operator">+</span> <span class="token string">&quot;', '&quot;</span> <span class="token operator">+</span> moduleFrom <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="appendaposinvoice函数"><a href="#appendaposinvoice函数" class="header-anchor">#</a> <code>appendApOsInvoice</code>函数</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">appendApOsInvoice</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> 		<span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> <span class="token keyword">long</span> payRegId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiPayId<span class="token punctuation">,</span> <span class="token class-name">String</span> sDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> 	eDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sStaff<span class="token punctuation">,</span> <span class="token class-name">String</span> eStaff<span class="token punctuation">,</span> <span class="token keyword">int</span> loadDbNote<span class="token punctuation">,</span> <span class="token class-name">String</span> invList<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> 		<span class="token class-name">String</span> moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>说明</strong></p> <p>用于读取扩展的 应付发票 的结余数据，例如[XXXX应付发票]。</p> <p><strong>参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>retTable</td> <td><code>SqlTable</code></td> <td>发票结余数据</td></tr> <tr><td>beId</td> <td><code>long</code></td> <td>企业法人ID</td></tr> <tr><td>uId</td> <td><code>long</code></td> <td>当前登录的用户ID</td></tr> <tr><td>AIType</td> <td><code>String</code></td> <td>应付对象类别</td></tr> <tr><td>AIId</td> <td><code>long</code></td> <td>应付对象ID</td></tr> <tr><td>payRegId</td> <td><code>long</code></td> <td>读取发票的单据ID</td></tr> <tr><td>multiPayId</td> <td><code>long</code></td> <td>批量付款单ID</td></tr> <tr><td>sDate</td> <td><code>String</code></td> <td>读取数据的开始日期</td></tr> <tr><td>eDate</td> <td><code>String</code></td> <td>读取数据的截至日期</td></tr> <tr><td>sDDate</td> <td><code>String</code></td> <td>读取数据的开始到期日</td></tr> <tr><td>eDDate</td> <td><code>String</code></td> <td>读取数据的截至到期日</td></tr> <tr><td>sStaff</td> <td><code>String</code></td> <td>读取数据的开始职员编号</td></tr> <tr><td>eStaff</td> <td><code>String</code></td> <td>读取数据的截至职员编号</td></tr> <tr><td>loadDbNote</td> <td><code>int</code></td> <td>读取没有结余的单据（1：是；0：否）</td></tr> <tr><td>invList</td> <td><code>String</code></td> <td>应付发票的筛选条件（若为空，则代表读取所有单据的数据）</td></tr> <tr><td>sTranType</td> <td><code>String</code></td> <td>应付发票类型筛选条件</td></tr> <tr><td>moduleFrom</td> <td><code>String</code></td> <td>读取发票的单据类型</td></tr> <tr><td>loadGroupCo</td> <td><code>boolean</code></td> <td>读取集团数据</td></tr></tbody></table> <h3 id="例子-8"><a href="#例子-8" class="header-anchor">#</a> <strong>例子</strong></h3> <p>当读取[XXXX应付发票]的应付结余数据时，如下扩展：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">appendApOsInvoice</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> retTable<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token keyword">long</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> <span class="token class-name">AIType</span><span class="token punctuation">,</span> <span class="token keyword">long</span> <span class="token class-name">AIId</span><span class="token punctuation">,</span> 	<span class="token keyword">long</span> payRegId<span class="token punctuation">,</span> <span class="token keyword">long</span> multiPayId<span class="token punctuation">,</span> <span class="token class-name">String</span> sDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDate<span class="token punctuation">,</span> <span class="token class-name">String</span> sDDate<span class="token punctuation">,</span> <span class="token class-name">String</span> eDDate<span class="token punctuation">,</span> 		<span class="token class-name">String</span> sStaff<span class="token punctuation">,</span> <span class="token class-name">String</span> eStaff<span class="token punctuation">,</span> <span class="token keyword">int</span> loadDbNote<span class="token punctuation">,</span> <span class="token class-name">String</span> invList<span class="token punctuation">,</span> <span class="token class-name">String</span> sTranType<span class="token punctuation">,</span> <span class="token class-name">String</span> 			moduleFrom<span class="token punctuation">,</span> <span class="token keyword">boolean</span> loadGroupCo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;CALL l_prodac_napbal (&quot;</span> <span class="token operator">+</span> beId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> uId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> <span class="token class-name">AIType</span> <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> 			<span class="token class-name">AIId</span> <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> payRegId <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> multiPayId <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> sDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> 			sDDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eDDate <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> sStaff <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> eStaff <span class="token operator">+</span> <span class="token string">&quot;',&quot;</span> <span class="token operator">+</span> loadDbNote <span class="token operator">+</span> <span class="token string">&quot;, '&quot;</span> <span class="token operator">+</span> 		invList <span class="token operator">+</span> <span class="token string">&quot;','&quot;</span> <span class="token operator">+</span> sTranType <span class="token operator">+</span> <span class="token string">&quot;', '&quot;</span> <span class="token operator">+</span> moduleFrom <span class="token operator">+</span> <span class="token string">&quot;', &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>loadGroupCo <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>

		<span class="token class-name">SqlTable</span> myTable <span class="token operator">=</span> <span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>myTable <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> myTable<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SqlTableLib</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>retTable<span class="token punctuation">,</span> myTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4376798b.js" defer></script><script src="/assets/js/3.8b8b1a7c.js" defer></script><script src="/assets/js/56.3906b81d.js" defer></script>
  </body>
</html>
