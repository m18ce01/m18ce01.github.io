<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Back-end Development Guide | M18 Developer Center</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="Make Something People Want">
    
    <link rel="preload" href="/assets/css/0.styles.87619b47.css" as="style"><link rel="preload" href="/assets/js/app.be9f9c09.js" as="script"><link rel="preload" href="/assets/js/2.2e75dd35.js" as="script"><link rel="preload" href="/assets/js/19.57d9531c.js" as="script"><link rel="prefetch" href="/assets/js/10.88a3fc9f.js"><link rel="prefetch" href="/assets/js/100.d3c138f9.js"><link rel="prefetch" href="/assets/js/101.be861e33.js"><link rel="prefetch" href="/assets/js/102.89209bc5.js"><link rel="prefetch" href="/assets/js/103.3b5f586e.js"><link rel="prefetch" href="/assets/js/104.1d393e3d.js"><link rel="prefetch" href="/assets/js/105.30dc470e.js"><link rel="prefetch" href="/assets/js/106.4558ba01.js"><link rel="prefetch" href="/assets/js/107.fc56de6f.js"><link rel="prefetch" href="/assets/js/108.6bafedb9.js"><link rel="prefetch" href="/assets/js/109.f07ab115.js"><link rel="prefetch" href="/assets/js/11.58b6decd.js"><link rel="prefetch" href="/assets/js/110.73c28140.js"><link rel="prefetch" href="/assets/js/111.ac35a99d.js"><link rel="prefetch" href="/assets/js/112.3b5e09ad.js"><link rel="prefetch" href="/assets/js/113.025af7d5.js"><link rel="prefetch" href="/assets/js/114.a3f993c1.js"><link rel="prefetch" href="/assets/js/12.88998c52.js"><link rel="prefetch" href="/assets/js/13.81a71d87.js"><link rel="prefetch" href="/assets/js/14.95a15c74.js"><link rel="prefetch" href="/assets/js/15.1f2d95a5.js"><link rel="prefetch" href="/assets/js/16.04489ac8.js"><link rel="prefetch" href="/assets/js/17.0537af99.js"><link rel="prefetch" href="/assets/js/18.427d9a09.js"><link rel="prefetch" href="/assets/js/20.dc2429d5.js"><link rel="prefetch" href="/assets/js/21.8b269ff5.js"><link rel="prefetch" href="/assets/js/22.09992224.js"><link rel="prefetch" href="/assets/js/23.758207ea.js"><link rel="prefetch" href="/assets/js/24.25156209.js"><link rel="prefetch" href="/assets/js/25.a31302bf.js"><link rel="prefetch" href="/assets/js/26.ceabf728.js"><link rel="prefetch" href="/assets/js/27.0a244c24.js"><link rel="prefetch" href="/assets/js/28.8c70dab6.js"><link rel="prefetch" href="/assets/js/29.51b51023.js"><link rel="prefetch" href="/assets/js/3.26826f21.js"><link rel="prefetch" href="/assets/js/30.07ed35d2.js"><link rel="prefetch" href="/assets/js/31.0ac69477.js"><link rel="prefetch" href="/assets/js/32.7b1c7059.js"><link rel="prefetch" href="/assets/js/33.80c814c7.js"><link rel="prefetch" href="/assets/js/34.50e9531b.js"><link rel="prefetch" href="/assets/js/35.410d678b.js"><link rel="prefetch" href="/assets/js/36.3dee9fbd.js"><link rel="prefetch" href="/assets/js/37.faafe37c.js"><link rel="prefetch" href="/assets/js/38.a8010e20.js"><link rel="prefetch" href="/assets/js/39.4a4e75e1.js"><link rel="prefetch" href="/assets/js/4.8fd2722a.js"><link rel="prefetch" href="/assets/js/40.c0f702a6.js"><link rel="prefetch" href="/assets/js/41.bfaabc73.js"><link rel="prefetch" href="/assets/js/42.426f1f6a.js"><link rel="prefetch" href="/assets/js/43.678d6725.js"><link rel="prefetch" href="/assets/js/44.d33f2500.js"><link rel="prefetch" href="/assets/js/45.c002f09a.js"><link rel="prefetch" href="/assets/js/46.2a962c4b.js"><link rel="prefetch" href="/assets/js/47.3b8210bb.js"><link rel="prefetch" href="/assets/js/48.e97ef319.js"><link rel="prefetch" href="/assets/js/49.9a9c741b.js"><link rel="prefetch" href="/assets/js/5.3cf67568.js"><link rel="prefetch" href="/assets/js/50.c0ea525d.js"><link rel="prefetch" href="/assets/js/51.447b0557.js"><link rel="prefetch" href="/assets/js/52.d6cadfdb.js"><link rel="prefetch" href="/assets/js/53.d3a373e4.js"><link rel="prefetch" href="/assets/js/54.bf5b66e3.js"><link rel="prefetch" href="/assets/js/55.d5249ca8.js"><link rel="prefetch" href="/assets/js/56.2499183c.js"><link rel="prefetch" href="/assets/js/57.47a9d9f4.js"><link rel="prefetch" href="/assets/js/58.957a7792.js"><link rel="prefetch" href="/assets/js/59.e0174034.js"><link rel="prefetch" href="/assets/js/6.3bae0592.js"><link rel="prefetch" href="/assets/js/60.e0aaaa44.js"><link rel="prefetch" href="/assets/js/61.b920e266.js"><link rel="prefetch" href="/assets/js/62.c1ef9ba0.js"><link rel="prefetch" href="/assets/js/63.49229ab9.js"><link rel="prefetch" href="/assets/js/64.6a4f8f39.js"><link rel="prefetch" href="/assets/js/65.ad370b2b.js"><link rel="prefetch" href="/assets/js/66.271a0a67.js"><link rel="prefetch" href="/assets/js/67.7aa77367.js"><link rel="prefetch" href="/assets/js/68.b8287107.js"><link rel="prefetch" href="/assets/js/69.c983c9ae.js"><link rel="prefetch" href="/assets/js/7.66594b79.js"><link rel="prefetch" href="/assets/js/70.58c35aca.js"><link rel="prefetch" href="/assets/js/71.e1245652.js"><link rel="prefetch" href="/assets/js/72.e054b57f.js"><link rel="prefetch" href="/assets/js/73.08259444.js"><link rel="prefetch" href="/assets/js/74.0206cbd1.js"><link rel="prefetch" href="/assets/js/75.b99953a4.js"><link rel="prefetch" href="/assets/js/76.2d344afb.js"><link rel="prefetch" href="/assets/js/77.f5713796.js"><link rel="prefetch" href="/assets/js/78.d92a68a0.js"><link rel="prefetch" href="/assets/js/79.82343f6c.js"><link rel="prefetch" href="/assets/js/8.f86acdd7.js"><link rel="prefetch" href="/assets/js/80.a300bd94.js"><link rel="prefetch" href="/assets/js/81.74b41270.js"><link rel="prefetch" href="/assets/js/82.660134d3.js"><link rel="prefetch" href="/assets/js/83.dbe994e5.js"><link rel="prefetch" href="/assets/js/84.1c6d8c3e.js"><link rel="prefetch" href="/assets/js/85.894b0d8a.js"><link rel="prefetch" href="/assets/js/86.1dd23bd8.js"><link rel="prefetch" href="/assets/js/87.52387d7b.js"><link rel="prefetch" href="/assets/js/88.303ee366.js"><link rel="prefetch" href="/assets/js/89.fa7b6e2e.js"><link rel="prefetch" href="/assets/js/9.05774c11.js"><link rel="prefetch" href="/assets/js/90.5859a97a.js"><link rel="prefetch" href="/assets/js/91.ae297240.js"><link rel="prefetch" href="/assets/js/92.8e91651d.js"><link rel="prefetch" href="/assets/js/93.0131c1f3.js"><link rel="prefetch" href="/assets/js/94.13a05e25.js"><link rel="prefetch" href="/assets/js/95.4d5900b3.js"><link rel="prefetch" href="/assets/js/96.41c09226.js"><link rel="prefetch" href="/assets/js/97.a5c3c2d2.js"><link rel="prefetch" href="/assets/js/98.32130c8e.js"><link rel="prefetch" href="/assets/js/99.3e5e087c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.87619b47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">M18 Developer Center</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebServices" class="dropdown-title"><span class="title">WebServices</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebServices" class="mobile-dropdown-title"><span class="title">WebServices</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/api/m18/" class="nav-link">
  M18
</a></li><li class="dropdown-item"><!----> <a href="/en/api/ce01/" class="nav-link">
  M18 ERP
</a></li><li class="dropdown-item"><!----> <a href="/en/api/ch01/" class="nav-link">
  M18 HCM
</a></li></ul></div></div><div class="nav-item"><a href="/en/m18/" class="nav-link router-link-active">
  App
</a></div><div class="nav-item"><a href="/zh-CN/" class="nav-link">
  中文文档
</a></div><div class="nav-item"><a href="https://community.multiable.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/en/tutorial/" class="nav-link">
  Tutorial
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebServices" class="dropdown-title"><span class="title">WebServices</span> <span class="arrow down"></span></button> <button type="button" aria-label="WebServices" class="mobile-dropdown-title"><span class="title">WebServices</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/en/api/m18/" class="nav-link">
  M18
</a></li><li class="dropdown-item"><!----> <a href="/en/api/ce01/" class="nav-link">
  M18 ERP
</a></li><li class="dropdown-item"><!----> <a href="/en/api/ch01/" class="nav-link">
  M18 HCM
</a></li></ul></div></div><div class="nav-item"><a href="/en/m18/" class="nav-link router-link-active">
  App
</a></div><div class="nav-item"><a href="/zh-CN/" class="nav-link">
  中文文档
</a></div><div class="nav-item"><a href="https://community.multiable.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Community
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Back-end Development Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en/m18/backend_doc.html#logical-modules" class="sidebar-link">Logical Modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#module-s-curd" class="sidebar-link">Module's CURD</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#checker-and-transaction" class="sidebar-link">Checker and Transaction</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#non-module-s-operations" class="sidebar-link">Non-Module's Operations</a></li></ul></li><li><a href="/en/m18/backend_doc.html#core-xml-configuration" class="sidebar-link">Core XML Configuration</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#keywords-in-table" class="sidebar-link">Keywords in Table</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#datadict-xml" class="sidebar-link">datadict.xml</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#pattern-xml" class="sidebar-link">pattern.xml</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#navmenu-xml" class="sidebar-link">navmenu.xml</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#module-xml" class="sidebar-link">module.xml</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#i18n-implementation" class="sidebar-link">i18n Implementation</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#search-implementation" class="sidebar-link">Search Implementation</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#stinfo-xml" class="sidebar-link">stInfo.xml</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#stsearch-xml" class="sidebar-link">stSearch.xml</a></li></ul></li><li><a href="/en/m18/backend_doc.html#login-and-access-control" class="sidebar-link">Login and Access Control</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#login-customization" class="sidebar-link">Login Customization</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#module-rights" class="sidebar-link">Module Rights</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#data-guard" class="sidebar-link">Data Guard</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#field-level-access-rights" class="sidebar-link">Field Level Access Rights</a></li></ul></li><li><a href="/en/m18/backend_doc.html#common-functions" class="sidebar-link">Common Functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#about-jboss-configuration-file" class="sidebar-link">About JBoss Configuration File</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#table-structure-information" class="sidebar-link">Table Structure Information</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#data-import-and-export" class="sidebar-link">Data Import and Export</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#document-printing" class="sidebar-link">Document Printing</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#udf-editor-s-template" class="sidebar-link">UDF Editor's Template</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#initial-data" class="sidebar-link">Initial Data</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#data-fix" class="sidebar-link">Data Fix</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#how-to-add-jar" class="sidebar-link">How to Add JAR</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#identify-the-source-of-jboss-startup-errors" class="sidebar-link">Identify the Source of JBoss Startup Errors</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#schedule-tasks" class="sidebar-link">Schedule Tasks</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#file-stream-handling" class="sidebar-link">File Stream Handling</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#m18-jboss-cache" class="sidebar-link">M18 JBoss Cache</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#object-sharing" class="sidebar-link">Object Sharing</a></li></ul></li><li><a href="/en/m18/backend_doc.html#common-utility-classes" class="sidebar-link">Common Utility Classes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#basic-operation" class="sidebar-link">Basic Operation</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#special-handling" class="sidebar-link">Special Handling</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#send-e-mail-example" class="sidebar-link">Send E-mail Example</a></li><li class="sidebar-sub-header"><a href="/en/m18/backend_doc.html#audit-trail-s-example" class="sidebar-link">Audit Trail's Example</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="back-end-development-guide"><a href="#back-end-development-guide" class="header-anchor">#</a> Back-end Development Guide</h1> <p><code>Version: 1.0 | Release Date: 30/6/2018</code></p> <h2 id="logical-modules"><a href="#logical-modules" class="header-anchor">#</a> Logical Modules</h2> <h3 id="module-s-curd"><a href="#module-s-curd" class="header-anchor">#</a> Module's CURD</h3> <p>If you are not familiar with the M18 Module, you can refer to <a href="/en/m18/overview.html#m18-module">Module</a>.</p> <p>M18 provides basic and common interfaces for Module records to create, update, read and delete easily.</p> <h4 id="use-of-web-service"><a href="#use-of-web-service" class="header-anchor">#</a> Use of Web Service</h4> <p><strong>Create Entity</strong></p> <p>Create a blank entity for desired module.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WsParameter</span> param <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">createWsParam</span><span class="token punctuation">(</span><span class="token string">&quot;entity/create/&quot;</span> <span class="token operator">+</span> <span class="token function">getModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">WsType</span><span class="token punctuation">.</span>post<span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;menuCode&quot;</span><span class="token punctuation">,</span> <span class="token function">getMenuCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">HttpResponse</span> response <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">callWs</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">isResponseOK</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> entryJson <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">resolveResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">FacesUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>entryJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   		<span class="token class-name">SqlEntity</span>  result <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>entryJson<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  	<span class="token class-name">WebUtil</span><span class="token punctuation">.</span><span class="token function">showMessageInfo</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;createFail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>HTTP Request</p></blockquote> <p><code>POST http://[server]/jsf/rfws/entity/create/[module]?menuCode=[menuCode]</code></p> <br> <blockquote><p>Parameters</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code> (<em>Path</em>)</td> <td><strong>Required.</strong> Module name</td></tr> <tr><td>menuCode</td> <td><code>String</code> (<em>Query</em>)</td> <td><strong>Required.</strong> Menu code</td></tr> <tr><td>param</td> <td><code>json String</code> (<em>Query</em>)</td> <td>Used when module's checker needs parameters for special treatment</td></tr></tbody></table> <br> <blockquote><p>Response</p></blockquote> <p><strong>Note</strong>: If response's result is success, a blank <code>SqlEntity</code> will be found.</p> <p><strong>Note</strong>: If response's result is fail, <code>CheckMsg</code> in JSON format can be found in the response's header using the key <code>error_info</code>.</p> <table><thead><tr><th>Type</th> <th>Location</th> <th>Description</th></tr></thead> <tbody><tr><td><code>success</code></td> <td><em>Body</em></td> <td>Module's blank <code>SqlEntity</code></td></tr> <tr><td><code>fail</code></td> <td><em>Header</em>(error_info)</td> <td><code>CheckMsg</code> in JSON format</td></tr></tbody></table> <br> <p><strong>Read Entity</strong></p> <p>Read module's record in SqlEntity format.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WsParameter</span> param <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">createWsParam</span><span class="token punctuation">(</span><span class="token string">&quot;entity/read/&quot;</span> <span class="token operator">+</span> <span class="token function">getModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">WsType</span><span class="token punctuation">.</span>get<span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;menuCode&quot;</span><span class="token punctuation">,</span> <span class="token function">getMenuCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> action<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">ActionParam</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;iRev&quot;</span><span class="token punctuation">,</span> action<span class="token punctuation">.</span><span class="token function">getDataOrDefault</span><span class="token punctuation">(</span><span class="token class-name">ActionParam</span><span class="token punctuation">.</span>iRev<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">HttpResponse</span> response <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">callWs</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">isResponseOK</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token class-name">String</span> entryJson <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">resolveResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">FacesUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>entryJson<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	entity <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>entryJson<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	<span class="token class-name">WebUtil</span><span class="token punctuation">.</span><span class="token function">showMessageInfo</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;readFail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>HTTP Request</p></blockquote> <p><code>GET http://[server]/jsf/rfws/entity/create/[module]?menuCode=[menuCode]&amp;id=[id]</code></p> <br> <blockquote><p>Parameter</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code> (<em>Path</em>)</td> <td><strong>Required.</strong> Module name</td></tr> <tr><td>menuCode</td> <td><code>String</code> (<em>Query</em>)</td> <td><strong>Required.</strong> Menu code</td></tr> <tr><td>id</td> <td><code>long</code> (<em>Query</em>)</td> <td><strong>Required.</strong> Entity's id</td></tr> <tr><td>iRev</td> <td><code>int</code> (<em>Query</em>)</td> <td>Version of the record. 0 or leave it blank to read the latest record</td></tr> <tr><td>param</td> <td><code>json String</code> (<em>Query</em>)</td> <td>Used when module's checker needs parameters for special treatment</td></tr></tbody></table> <br> <blockquote><p>Response</p></blockquote> <p><strong>Note</strong>: If response's result is success, the record in <code>SqlEntity</code> format will be found.</p> <p><strong>Note</strong>: If response's result is fail, <code>CheckMsg</code> in JSON format can be found in the response's header using the key <code>error_info</code>.</p> <table><thead><tr><th>Type</th> <th>Location</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Success</code></td> <td><em>Body</em></td> <td>Record in <code>SqlEntity</code> format</td></tr> <tr><td><code>Fail</code></td> <td><em>Header</em>(error_info)</td> <td><code>CheckMsg</code> in JSON format</td></tr></tbody></table> <br> <p><strong>Save Entity</strong></p> <p>Save the module's record in SqlEntity format.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WsParameter</span> param <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">createWsParam</span><span class="token punctuation">(</span><span class="token string">&quot;entity/save/&quot;</span> <span class="token operator">+</span> <span class="token function">getModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">WsType</span><span class="token punctuation">.</span>put<span class="token punctuation">)</span><span class="token punctuation">;</span>

param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;menuCode&quot;</span><span class="token punctuation">,</span> <span class="token function">getMenuCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;entity&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token function">getEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">HttpResponse</span> response <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">callWs</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">isResponseOK</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">long</span> recordId <span class="token operator">=</span> <span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">parseLong</span><span class="token punctuation">(</span><span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">resolveResponse</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	action<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token class-name">ActionParam</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> recordId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">WebUtil</span><span class="token punctuation">.</span><span class="token function">showMessageInfo</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">&quot;saveSuccess&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;saveFail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <blockquote><p>HTTP Request</p></blockquote> <p><code>PUT http://[server]/jsf/rfws/entity/save/[module]?menuCode=[menuCode]&amp;entity=[SqlEntity json String]</code></p> <br> <blockquote><p>Parameters</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code> (<em>Path</em>)</td> <td><strong>Required.</strong> Module name</td></tr> <tr><td>menuCode</td> <td><code>String</code> (<em>Query</em>)</td> <td><strong>Required.</strong> Menu code</td></tr> <tr><td>entity</td> <td><code>json String</code> (<em>Query</em>)</td> <td><strong>Required.</strong> <code>SqlEntity</code> in JSON format</td></tr> <tr><td>param</td> <td><code>json String</code> (<em>Query</em>)</td> <td>Used when module's checker needs parameters for special treatment</td></tr></tbody></table> <br> <blockquote><p>Response</p></blockquote> <p><strong>Note</strong>: If response's result is success, <code>id</code> of the saved <code>SqlEntity</code> will be returned.
<strong>Note</strong>: If response's result is fail, <code>CheckMsg</code> in JSON format can be found in the response's header using the key <code>error_info</code>.</p> <table><thead><tr><th>Type</th> <th>Location</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Success</code></td> <td><em>Body</em></td> <td>id of <code>SqlEntity</code></td></tr> <tr><td><code>Fail</code></td> <td><em>Header</em>(error_info)</td> <td><code>CheckMsg</code> in JSON format</td></tr></tbody></table> <br> <p><strong>Delete Entity</strong></p> <p>Delete module's record using SqlEntity format.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">WsParameter</span> param <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">createWsParam</span><span class="token punctuation">(</span><span class="token string">&quot;entity/delete/&quot;</span> <span class="token operator">+</span> <span class="token function">getModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">WsType</span><span class="token punctuation">.</span>delete<span class="token punctuation">)</span><span class="token punctuation">;</span>

param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;menuCode&quot;</span><span class="token punctuation">,</span> <span class="token function">getMenuCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
param<span class="token punctuation">.</span><span class="token function">addQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> action<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">ActionParam</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">HttpResponse</span> response <span class="token operator">=</span> <span class="token class-name">WsLib</span><span class="token punctuation">.</span><span class="token function">callWs</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">WebUtil</span><span class="token punctuation">.</span><span class="token function">showMessageInfo</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">&quot;deleteSuccess&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;deleteFail&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <blockquote><p>HTTP Request</p></blockquote> <p><code>DELETE http://[server]/jsf/rfws/entity/delete/[module]?menuCode=[menuCode]&amp;id=[id]</code></p> <br> <blockquote><p>Parameters</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>module</td> <td><code>String</code> (<em>Path</em>)</td> <td><strong>Required.</strong> Module name</td></tr> <tr><td>menuCode</td> <td><code>String</code> (<em>Query</em>)</td> <td><strong>Required.</strong> Menu code</td></tr> <tr><td>id</td> <td><code>long</code> (<em>Query</em>)</td> <td><strong>Required.</strong> id of the ready-to-delete record.</td></tr> <tr><td>param</td> <td><code>json String</code> (<em>Query</em>)</td> <td>Used when module's checker needs parameters for special treatment</td></tr></tbody></table> <br> <blockquote><p>Response</p></blockquote> <p>If response's result is fail, <code>CheckMsg</code> in JSON format can be found in the response's header using the key <code>error_info</code>.</p> <table><thead><tr><th>Type</th> <th>Location</th> <th>Description</th></tr></thead> <tbody><tr><td><code>Success</code></td> <td><em>Status</em></td> <td>Status = 200 means success</td></tr> <tr><td><code>Fail</code></td> <td><em>Header</em>(error_info)</td> <td><code>CheckMsg</code> in JSON format</td></tr></tbody></table> <h4 id="use-of-ejb"><a href="#use-of-ejb" class="header-anchor">#</a> Use of EJB</h4> <p><strong>Create Entity</strong></p> <p>Different from web service, cache of the record will not be used when using EJB.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token class-name">CawEntityCurdAction</span> curdEJB<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span>，string menuCode<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">SeCreateParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SeCreateParam</span><span class="token punctuation">(</span><span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setMenuCode</span><span class="token punctuation">(</span>menuCode<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">EntityResult</span> result <span class="token operator">=</span> curdEJB<span class="token punctuation">.</span><span class="token function">createEntity</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>SeCreateParam</p></blockquote> <p>Input: Module name and menu code.</p> <p>If module's checker needs parameters for special treatment, user can put those variables into <code>SeCreateParam</code>'s <code>jsonParam</code>.</p> <br> <blockquote><p>Return Type</p></blockquote> <p><strong>Note</strong>: If <code>SqlEntity</code> in <code>EntityResult</code> is not <code>null</code>, a blank <code>SqlEntity</code> can be retrieved.</p> <p><strong>Note</strong>: If <code>SqlEntity</code> in <code>EntityResult</code> is <code>null</code>, error messages can be found under <code>List&lt;CheckMsg&gt;</code>.</p> <br> <p><strong>Read Entity</strong></p> <p>Different from web service, cache of the record will not be used when using EJB.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token class-name">CawEntityCurdAction</span> curdEJB<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">String</span> menuCode<span class="token punctuation">,</span> <span class="token keyword">long</span> id<span class="token punctuation">,</span> <span class="token keyword">int</span> iRev<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">SeReadParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SeReadParam</span><span class="token punctuation">(</span><span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setMenuCode</span><span class="token punctuation">(</span>menuCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setEntityId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setIrev</span><span class="token punctuation">(</span>iRev<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">EntityResult</span> result <span class="token operator">=</span> curdEJB<span class="token punctuation">.</span><span class="token function">loadEntity</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>SeReadParam</p></blockquote> <p>Input: Module name, menu code, id of the record. Optional: <code>iRev</code> to read specific version.</p> <p>If module's checker needs parameters for special treatment, user can put those variables into <code>SeReadParam</code>'s <code>jsonParam</code>.</p> <br> <blockquote><p>Return Type</p></blockquote> <p><strong>Note</strong>: If <code>SqlEntity</code> in <code>EntityResult</code> is not <code>null</code>, record of the specific version can be retrieved.</p> <p><strong>Note</strong>: If <code>SqlEntity</code> in <code>EntityResult</code> is <code>null</code>, error messages can be found under <code>List&lt;CheckMsg&gt;</code>.</p> <br> <p><strong>Save Entity</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token class-name">CawEntityCurdAction</span> curdEJB<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">String</span> menuCode<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">SeSaveParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SeSaveParam</span><span class="token punctuation">(</span><span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setMenuCode</span><span class="token punctuation">(</span>menuCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setSqlEntity</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setInsertMir</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">CheckResult</span> result <span class="token operator">=</span> curdEJB<span class="token punctuation">.</span><span class="token function">updateEntity</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>SeSaveParam</p></blockquote> <p>Input: Module name, menu code, record's in SqlEntity format. Optional: Set <code>insertMir</code> to <code>true</code> if historical record needs to be kept.</p> <p>If module's checker needs parameters for special treatment, user can put those variables into <code>SeSaveParam</code>'s <code>jsonParam</code>.</p> <br> <blockquote><p>Return Type</p></blockquote> <p><strong>Note</strong>: If <code>pass</code> in <code>CheckResult</code> is true, the record has been saved successfully, <code>id</code> can be found using the method getEntityId().</p> <p><strong>Note</strong>: If <code>pass</code> in <code>CheckResult</code> is false, error messages can be found under <code>List&lt;CheckMsg&gt;</code>.</p> <br> <p><strong>Delete Entity</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token class-name">CawEntityCurdAction</span> curdEJB<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">String</span> <span class="token keyword">module</span><span class="token punctuation">,</span> <span class="token class-name">String</span> menuCode<span class="token punctuation">,</span> <span class="token keyword">long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">SeDeleteParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SeDeleteParam</span><span class="token punctuation">(</span><span class="token keyword">module</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setMenuCode</span><span class="token punctuation">(</span>menuCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	param<span class="token punctuation">.</span><span class="token function">setEntityId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	param<span class="token punctuation">.</span><span class="token function">setInsertMir</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">CheckResult</span> result <span class="token operator">=</span> curdEJB<span class="token punctuation">.</span><span class="token function">deleteEntity</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>SeDeleteParam</p></blockquote> <p>Input: Module name, menu code, id of the record. Optional: Set <code>insertMir</code> to <code>true</code> if historical record needs to be kept.</p> <p>If module's checker needs parameters for special treatment, user can put those variables into <code>SeDeleteParam</code>'s <code>jsonParam</code>.</p> <br> <blockquote><p>Return Type</p></blockquote> <p><strong>Note</strong>: If <code>pass</code> in <code>CheckResult</code> is true, the record has been deleted successfully.</p> <p><strong>Note</strong>: If <code>pass</code> in <code>CheckResult</code> is false, error messages can be found under <code>List&lt;CheckMsg&gt;</code>.</p> <h3 id="checker-and-transaction"><a href="#checker-and-transaction" class="header-anchor">#</a> Checker and Transaction</h3> <p>During the process of module CURD, checker, defined in <a href="#module-xml">module.xml</a>, can be used to handle some checking or process special treatments of the records.</p> <p><strong>Checker's method setting</strong></p> <p>Define checker in module.xml. The method with @EntityCheck annotation in checker files will be used during CURD process. Parameter: <code>SeCurdParam</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeChecker</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@EntityCheck</span><span class="token punctuation">(</span>range <span class="token operator">=</span> <span class="token class-name">CheckRange</span><span class="token punctuation">.</span>BEFORE<span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">CheckType</span><span class="token punctuation">.</span>SAVE<span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">CheckMsg</span> <span class="token function">checkMothed</span><span class="token punctuation">(</span><span class="token class-name">SeCurdParam</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">return</span> <span class="token keyword">null</span>；
	<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>@EntityCheck's Parameters'</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>type</td> <td>true</td> <td>CheckType</td> <td>Options: SAVE(1), DELETE(2), CREATE(3), READ(4)</td></tr> <tr><td>range</td> <td>true</td> <td>CheckRange</td> <td>Options: BEFORE(1), AFTER(2), BOTH(3), SAVING(4), ROLLBACK(5), DELETEING(6). <code>SAVING</code> can only be used when <code>CheckType</code> = <code>SAVE</code>. <code>DELETEING</code> can only be used when <code>CheckType</code> = <code>DELETE</code></td></tr> <tr><td>checkOrder</td> <td>false</td> <td>int</td> <td>Default: 0. The smaller the number, the earlier it will process</td></tr> <tr><td>actionBreaker</td> <td>false</td> <td>boolean</td> <td>Default: false. If true and checker's method return errors, the process will stop immediately and return the error message(s)</td></tr> <tr><td>overrideMethod</td> <td>false</td> <td>String</td> <td>Use Class.method to override methods in order checker</td></tr></tbody></table> <br> <p><strong>Save Process</strong></p> <ol><li><p>curdEJB invokes save method.</p></li> <li><p><em>Checker Save-Before</em>: Invoke the method with CheckType = SAVE, CheckRange = BEFORE or BOTH. If any method returns CheckMsg with pass = false, the save process will be stopped and return error message. The purpose of these methods are validating data. It does not involve any data change in database as it is still not in the save transaction.</p></li> <li><p><em>Sql Before</em>: If no error occurs during the <em>Checker Save-Before</em> stage, it will create a save transaction and run the SQL retrieved from <code>SeSaveParam.getSqlBeforeDtos()</code>. If error occurs during this stage, the save transaction will be stopped and rolled back. Methods with CheckType = SAVE, CheckRange = ROLLBACK will be invoked. Error message will be returned.</p></li> <li><p><em>Update To Database</em>: If no error occurs during the <em>Sql Before</em> stage, entity will be saved into the database. If error occurs during this stage, the save transaction will be stopped and rolled back. Methods with CheckType = SAVE, CheckRange = ROLLBACK will be invoked. Error message will be returned.</p></li> <li><p><em>Checker Saving</em>: After saving the entity into the database, methods with CheckType = SAVE, CheckRange = SAVING will be invoked. If error occurs during this stage, the save transaction will be stopped and rolled back. Methods with CheckType = SAVE，CheckRange = ROLLBACK will be invoked. Error message will be returned.</p></li> <li><p><em>Sql After</em>: If no errors return during the <em>Checker Saving</em> stage, it will run the SQL retrieved from <code>SeSaveParam.getSqlAfterDtos()</code>. If error occurs during this stage, the save transaction will be stopped and rolled back. Methods with CheckType = SAVE, CheckRange = ROLLBACK will be invoked. Error message will be returned.</p></li> <li><p>If no error occurs during the process, the save transaction will be committed.</p></li> <li><p><em>Checker Save-After</em>: Methods with CheckType = SAVE, CheckRange = AFTER or CheckRange = BOTH will be invoked. If error returns during the process, the save transaction will NOT be rolled back. It is not recommended to do any error checking during this process.</p></li></ol> <blockquote><p>Please refer to below diagram for more details.</p></blockquote> <p><img src="/assets/img/tran_save.3b153604.jpg" alt="mssst"></p> <br> <p><strong>Delete Process</strong></p> <p>Almost same as Save Process, the only difference is the method with CheckType = DELETEING will be invoked before the Entity is deleted.</p> <p><strong>Create Process</strong></p> <p>There are no <em>Sql before</em>, <em>Saving</em>, <em>Sql After</em> stages in Create Process when compared with Save Process.</p> <p><strong>Read Process</strong>
There are no <em>Sql before</em>, <em>Saving</em>, <em>Sql After</em> stages in Read Process when compared with Save Process.</p> <br> <p><strong>Search Module</strong>
Setup a stSearch with code same as the module name in <a href="#stsearch-xml">stSearch.xml</a>.</p> <h3 id="non-module-s-operations"><a href="#non-module-s-operations" class="header-anchor">#</a> Non-Module's Operations</h3> <p>M18 has provided <code>SqlTableCurdEAO</code> to handle the operation of non-module's tables.
<strong>Note</strong>: If the target table belongs to any module, it is not recommended to use this method.</p> <p><strong>Read Record</strong></p> <p>Use <code>read(StReadParam param)</code> in <code>SqlTableCurdEAO</code> to read the record in database.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token keyword">protected</span> <span class="token class-name">SqlTableCurdEAO</span> curdEAO<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token keyword">long</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">StReadParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StReadParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	param<span class="token punctuation">.</span><span class="token function">setTableName</span><span class="token punctuation">(</span><span class="token string">&quot;draft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	param<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token class-name">SqlTable</span> data <span class="token operator">=</span> curdEAO<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <p><strong>Create blank table and save data</strong></p> <p>Use <code>genEmptyTable(String tableName)</code> to retrieve a blank <code>SqlTable</code> with correct format.</p> <p>Use <code>save(StUpdateParam param)</code> in <code>SqlTableCurdEAO</code> to save the table's data.</p> <p>tableName and SqlTable must be put into <code>StUpdateParam</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token keyword">protected</span> <span class="token class-name">SqlTableCurdEAO</span> curdEAO<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">DraftDto</span> draft<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">SqlTable</span> sqlTable <span class="token operator">=</span> emptyTable<span class="token punctuation">.</span><span class="token function">genEmptyTable</span><span class="token punctuation">(</span><span class="token string">&quot;draft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sqlTable<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    sqlTable<span class="token punctuation">.</span><span class="token function">setBoolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;autoSave&quot;</span><span class="token punctuation">,</span> draft<span class="token punctuation">.</span><span class="token function">isAutoSave</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sqlTable<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;draftCode&quot;</span><span class="token punctuation">,</span> draft<span class="token punctuation">.</span><span class="token function">getDraftCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    sqlTable<span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;lastModifyDate&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token comment">//do some coding</span>

    <span class="token class-name">StUpdateParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StUpdateParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    param<span class="token punctuation">.</span><span class="token function">setTableName</span><span class="token punctuation">(</span><span class="token string">&quot;draft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    param<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>sqlTable<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      	<span class="token keyword">long</span> insertId  <span class="token operator">=</span> curdEAO<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>

      	<span class="token keyword">return</span> insertId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     	<span class="token class-name">CawLog</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    reutrn <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <p><strong>Delete record</strong></p> <p>Use <code>delete(StDeleteParam param)</code> in <code>SqlTableCurdEAO</code> to delete the record in database.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span>
<span class="token keyword">protected</span> <span class="token class-name">SqlTableCurdEAO</span> curdEAO<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token class-name">StDeleteParam</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StDeleteParam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    param<span class="token punctuation">.</span><span class="token function">setTableName</span><span class="token punctuation">(</span><span class="token string">&quot;draft&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
    param<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
    	curdEAO<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	<span class="token class-name">CawLog</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="core-xml-configuration"><a href="#core-xml-configuration" class="header-anchor">#</a> Core XML Configuration</h2> <p>With reference to <a href="#logical-modules">Logical Modules</a>, M18 uses XML structure to handle common operations and functions. Besides logical modules, many features and functions use XML to control and handle.</p> <blockquote><p>The XML's default location is under share project. The path is like /main/resources/META-INF/*.xml</p></blockquote> <h3 id="keywords-in-table"><a href="#keywords-in-table" class="header-anchor">#</a> Keywords in Table</h3> <p>As almost all tables are defined in XML format, basic requirement and limitation in XML should be considered.</p> <p>Although XML is not mainly used in M18 server, XML affects most of the key operation when starting JBoss. It is suggested it should be modified cautiously.</p> <p>It is recommended to define the code in small letter. Users must not use any special character.</p> <p>It is also suggested to use app name as the prefix of table and module name. A good naming rule usually prevents conflicts among different parties, escpecially under <em>M18 App concept</em>.</p> <h3 id="datadict-xml"><a href="#datadict-xml" class="header-anchor">#</a> datadict.xml</h3> <p>datadict.xml is used to describe the <a href="/en/m18/overview.html#m18-sqltable">SqlTable</a>, view and its column's information in MySQL database. It also defines the table constrains like index, foreign key, unique key, etc.
M18 transfers the information in datadict.xml and creates those tables and constrains in the database. It is suggested to avoid using any keywords in MySQL.</p> <p><strong>Note:</strong> When M18 is started, M18 will compare the current database table structures and constrains with xml and will only add/change those that are different.</p> <p><strong>Note:</strong> <a href="#database-synchronization">Synchronization of view, stored procedure and function</a> will be explained later</p> <br> <blockquote><p>Table's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>Y</td> <td>String</td> <td></td> <td>Define the name of the table, unique in M18, small letter only and must not use any special characters</td></tr> <tr><td>sys</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if this table belongs to system. System tables will not check access right and cannot be imported not exported</td></tr> <tr><td>mess</td> <td>Y</td> <td>String</td> <td></td> <td>Define the mess code of the table</td></tr> <tr><td>pk</td> <td>N</td> <td>String</td> <td>id</td> <td>Define the primary key of this table. Must be <code>id</code></td></tr> <tr><td>virtual</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the current table's information, including columns or constrains, will not affect the MySQL database</td></tr> <tr><td>supportUdf</td> <td>N</td> <td>Boolean</td> <td>true</td> <td>Indicate if UDF column will be supported</td></tr> <tr><td>templet</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the current table is a template. A template will not affect MySQL database and generate cache. Other table can use <code>&lt;Inherit&gt;</code> to inherit the information under this template</td></tr> <tr><td>extend</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the current table is the extension of any existing records</td></tr> <tr><td>onlyInMain</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if <code>xxx_v</code> table will be created</td></tr></tbody></table> <br> <blockquote><p>Inherit's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Define the name of the <code>table</code> in which <code>template</code> = true.</td></tr></tbody></table> <p><strong>Note</strong>: If column's information which belongs to template needs to be modified in the current table, add that column in the table and change the attribute accordingly. However, this method is not recommended as this will be mis-leading.</p> <br> <blockquote><p>Column's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>Y</td> <td>String</td> <td></td> <td>Define the column name, unique key under the same table. Lower camel case naming rule is recommended. <span style="color:red;"><strong>MUST NOT USE SPECIAL CHARACTERS e.g. *, _, - etc.</strong></span></td></tr> <tr><td>type</td> <td>Y</td> <td>String</td> <td></td> <td>Define the type of the column</td></tr> <tr><td>mess</td> <td>Y</td> <td>String</td> <td></td> <td>Define the column's messCode</td></tr> <tr><td>length</td> <td>N</td> <td>Integer</td> <td></td> <td>Define the data length. Used when <code>type</code> = char/number</td></tr> <tr><td>decimal</td> <td>N</td> <td>Integer</td> <td></td> <td>Define the decimal length. Used when <code>type</code> = number</td></tr> <tr><td>defValue</td> <td>N</td> <td>String</td> <td></td> <td>Define the default value of the column</td></tr> <tr><td>defPattern</td> <td>N</td> <td>String</td> <td></td> <td>Define the pattern, defined in <a href="#pattern-xml">Pattern</a></td></tr> <tr><td>required</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column is required during saving</td></tr> <tr><td>identity</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if auto increment should be enabled for this column. Usually for <code>id</code> column</td></tr> <tr><td>i18nField</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if multiple language is supported for this field. Used only when <code>type</code> = <code>char</code></td></tr> <tr><td>i18nSrc</td> <td>N</td> <td>String</td> <td></td> <td>Define the column name (Table.Column) that i18n field will be enabled together. Ignore when <code>i18nField</code> = false</td></tr> <tr><td>allowNull</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column allows null value in database. <strong>Note</strong>: Some type of columns in Database require null value</td></tr> <tr><td>buildIn</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column is build-in. Some functions like fields in search will group these build-in fields into a folder</td></tr> <tr><td>dataImport</td> <td>N</td> <td>Boolean</td> <td>true</td> <td>Indicate if the column can be imported</td></tr> <tr><td>dataExport</td> <td>N</td> <td>Boolean</td> <td>true</td> <td>Indicate if the column can be exported</td></tr> <tr><td>skipLookup</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column will not be shown when lookup</td></tr> <tr><td>skipAccess</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column needs to be considered when access right is enabled</td></tr> <tr><td>checkLookupVal</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column needs to search again for access right when being imported</td></tr> <tr><td>genRuleDate</td> <td>N</td> <td>Boolean</td> <td>true</td> <td>Indicate if the column can be used in generating date field in CodeFormat setup</td></tr> <tr><td>batchUpdate</td> <td>N</td> <td>Boolean</td> <td>true</td> <td>Indicate if the column can be batch-updated. <strong>Note:</strong> It is not recommended to batch-update the fields which need calculation</td></tr> <tr><td>udfUpdate</td> <td>N</td> <td>Boolean</td> <td></td> <td>Indicate if the column can be used in UDF Update</td></tr> <tr><td>skipFLR</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column is controlled by field right</td></tr> <tr><td>dataDupCheck</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column can be used in Duplicated Data Check.If the value is not set, the column can be used in Duplicated Data Check when the column type is string or date , or the pattern is lookup.</td></tr> <tr><td>dataEasy</td> <td>N</td> <td>Boolean</td> <td>dataImport</td> <td>Indicate if the column can be used in Data Easy. If the value is not set, the value default use dataImport value.</td></tr> <tr><td>lookupCurrentModule</td> <td>N</td> <td>Boolean</td> <td>false</td> <td>Indicate if the column is lookup current module.</td></tr></tbody></table> <br> <blockquote><p>Column type's description</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>int_unsigned</td> <td>Java: long. <strong>Note</strong>: All <code>id</code> should use int_unsigned</td></tr> <tr><td>bigint</td> <td>Java: long. Not recommended to use.</td></tr> <tr><td>bit</td> <td>Java: boolean.</td></tr> <tr><td>datetime</td> <td>Java: date. Date with time.</td></tr> <tr><td>date</td> <td>Java: date.</td></tr> <tr><td>nvarchar/varchar</td> <td>Java: String. <code>length</code> required.</td></tr> <tr><td>text/longtext</td> <td>Java: String. <strong>Note</strong>: text's length is limited. Use <code>longtext</code> if text's length is not enough.</td></tr> <tr><td>numeric</td> <td>Java: double. <code>length</code> and <code>decimal</code> required.</td></tr> <tr><td></td> <td><strong>Note</strong>: File type please refer to <a href="#file-stream-handling">File Stream Handling</a></td></tr></tbody></table> <br> <blockquote><p>Index's attributes'</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Define the index's name. Unique in the same table.</td></tr> <tr><td>columns</td> <td>String</td> <td>Define the column(s) used in index. <code>;</code> separated.</td></tr> <tr><td>unique</td> <td>Boolean</td> <td>Indicate if this is a unique key.</td></tr></tbody></table> <br> <blockquote><p>fk's attributes'</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Define the name of Foreign Key.</td></tr> <tr><td>columns</td> <td>String</td> <td>Define the column name in the current table.</td></tr> <tr><td>refTable</td> <td>String</td> <td>Define the target table.</td></tr> <tr><td>refColumns</td> <td>String</td> <td>Define the target column in target table. Default: <code>id</code>.</td></tr></tbody></table> <p><strong>Note</strong>: M18 will create or update the tables/columns/constrains information from datadict.xml to MySQL Database. M18 will not delete any columns from the database, it is recommended to handle it manually.</p> <p>It is recommended to create another field if the attribute of any field needs modification because there may be unexpected problem when datadict.xml starts synchronizing the database.</p> <p><strong>Note</strong>: M18 allows modification of attribute in columns. However, there will not be any recovery nor warning message if error occurred.</p> <p>Please pay attention when the field's length is shortened as database may cut the data based on the new length and it is unrecoverable.</p> <blockquote><p>Example</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dd</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.multiable.com/datadict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- test info --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test_base<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test_base<span class="token punctuation">&quot;</span></span> <span class="token attr-name">templet</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int_unsigned<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">identity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
       	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iRev<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.iRev<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defPattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iRev<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataImport</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.createDate<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NOW()<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defPattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataImport</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dataExport</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token attr-name">buildin</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">pk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>inherit</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test_base<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varchar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defPattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">required</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>column</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>varchar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>200<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defPattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span> <span class="token attr-name">i18nField</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>index</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">columns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">unique</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dd</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><br> <h4 id="database-synchronization"><a href="#database-synchronization" class="header-anchor">#</a> Database Synchronization</h4> <p>When M18 is started, besides datadict.xml, it will also update other information like views, stored procedures, functions, etc.</p> <p>How M18 update these information:</p> <p>It is required to create three folders with name <code>view</code>, <code>proc</code> and <code>func</code> under the path ejb/src/main/resources/sql/. Every views, stored procedures, functions, etc should have its own file and the content should start with deleting the information and be followed by creating it again.</p> <blockquote><p>Example：Stored Procedure's file.</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">procedure</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> test_dm<span class="token punctuation">;</span>

<span class="token keyword">DELIMITER</span> $$

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> test_dm<span class="token punctuation">(</span><span class="token operator">IN</span> dbname <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
<span class="token keyword">BEGIN</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> test A <span class="token keyword">where</span> A<span class="token punctuation">.</span>db <span class="token operator">=</span> dbname<span class="token punctuation">;</span>
<span class="token keyword">END</span>$$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre></div><blockquote><p>Update process is like below:</p></blockquote> <p><img src="/assets/img/ddtodb.8848d99c.jpg" alt="mssst"></p> <h3 id="pattern-xml"><a href="#pattern-xml" class="header-anchor">#</a> pattern.xml</h3> <p>M18 uses pattern to describe how a field looks like in database and in user interface.</p> <blockquote><p>record's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>true</td> <td>string</td> <td></td> <td>Define the name. Unique key</td></tr> <tr><td>type</td> <td>true</td> <td>string</td> <td></td> <td>Define the pattern's type. Options: <code>text</code>, <code>number</code>, <code>date</code>, <code>options</code>, <code>boolean</code>, <code>lookup</code>, <code>color</code></td></tr> <tr><td>info</td> <td>false</td> <td>string</td> <td></td> <td>Define the description</td></tr></tbody></table> <br> <blockquote><p>text's attributes. If pattern's <code>type</code> = <code>text</code>, <code>text</code> tag will be used in the next level to denote it is of text type.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>length</td> <td>true</td> <td>int</td> <td></td> <td>Define the length of the text</td></tr> <tr><td>trim</td> <td>false</td> <td>boolean</td> <td>false</td> <td>Indicate if the space in front of or behind the word will be removed</td></tr> <tr><td>upperCase</td> <td>false</td> <td>boolean</td> <td>false</td> <td>Indicate if the words should be changed to capital letter</td></tr> <tr><td>mask</td> <td>false</td> <td>string</td> <td></td> <td>Define the format</td></tr> <tr><td>regex</td> <td>false</td> <td>string</td> <td></td> <td>Define the regular expression</td></tr> <tr><td>html</td> <td>false</td> <td>boolean</td> <td>false</td> <td>Indicate if the user interface should use html component</td></tr></tbody></table> <br> <blockquote><p>number's attributes. If pattern's <code>type</code> = <code>number</code>, <code>number</code> tag will be used in the next level to denote it is of numeric type.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>length</td> <td>true</td> <td>int</td> <td></td> <td>Define the total length (integer + decimal) of the number</td></tr> <tr><td>decimal</td> <td>false</td> <td>int</td> <td>0</td> <td>Define the length of the decimal part</td></tr> <tr><td>max</td> <td>false</td> <td>double</td> <td>false</td> <td>Define the maximum value of the number</td></tr> <tr><td>min</td> <td>false</td> <td>double</td> <td></td> <td>Define the minimum value of the number</td></tr> <tr><td>noSep</td> <td>false</td> <td>boolean</td> <td>false</td> <td>Indicate if the number should be separated by thousand separator (<code>,</code>) in user interface</td></tr> <tr><td>negativeSymbol</td> <td>false</td> <td>boolean</td> <td>false</td> <td>Indicate if blanket will be used if the value is negative in user interface</td></tr></tbody></table> <br> <blockquote><p>lookup's attributes. If pattern's <code>type</code> = <code>lookup</code>, <code>lookup</code> tag will be used in the next level to denote it is of lookup type.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>searchType</td> <td>true</td> <td>string</td> <td></td> <td>Define the <a href="#stsearch-xml">stSearch</a> used for this lookup</td></tr></tbody></table> <br> <blockquote><p>options's attributes. If pattern's <code>type</code> = <code>options</code>, <code>options</code> tag will be used to denote it is a drop down list.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>valueClass</td> <td>true</td> <td>string</td> <td>string</td> <td>Define the type of the option's value. Options: <code>String</code>, <code>Integer</code>, <code>Double</code>, <code>Combobox</code></td></tr> <tr><td>emptyValue</td> <td>false</td> <td>string</td> <td></td> <td>Define the value if no option has been chosen</td></tr></tbody></table> <br> <blockquote><p>option's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>value</td> <td>true</td> <td>string</td> <td></td> <td>Define the value when the option is selected</td></tr> <tr><td>label</td> <td>true</td> <td>string</td> <td></td> <td>Define the value displayed in the user interface</td></tr></tbody></table> <br> <blockquote><p>option's  icon attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>false</td> <td>String</td> <td></td> <td>Icon name in the library.</td></tr> <tr><td>library</td> <td>false</td> <td>String</td> <td></td> <td>Library url in system.</td></tr> <tr><td>url</td> <td>false</td> <td>String</td> <td></td> <td>The icon url.</td></tr> <tr><td>style</td> <td>false</td> <td>String</td> <td></td> <td>Icon css style.</td></tr> <tr><td>styleClass</td> <td>false</td> <td>String</td> <td></td> <td>Icon css style class.</td></tr></tbody></table> <br> <p><strong>Special Patterns</strong>
Followings are some special patterns used by M18. It is not suggested to modify it.</p> <div class="language-xml extra-class"><pre class="language-xml"><code>	<span class="token comment">&lt;!-- this is for file.info the id of filedata --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fileId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>number</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>12<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- this is for image, use code for safe! --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imgCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- date with time --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>datetime<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- time in format HH:MM--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>time<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- date only--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>date<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- color component--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>color<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>color<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- can only save with length less than 2^32. Use longtext if not 				enought. --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>charMax<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- json string--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>json<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- unlimited length. datadict.xml should use type = longtext for this 		pattern--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>longtext<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- html component--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>record</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">length</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">html</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>record</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="navmenu-xml"><a href="#navmenu-xml" class="header-anchor">#</a> navmenu.xml</h3> <p>M18 uses navmenu.xml to define the system's  <a href="/en/m18/overview.html#m18-menu">Menu</a> displayed in user interface. User can assign access right through this menu.</p> <blockquote><p>menuType description. menuType defines the type of the menu with the use of icons and images.</p></blockquote> <table><thead><tr><th>Name</th> <th>Child Element</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td></td> <td>Define a menu type.</td></tr> <tr><td>desc</td> <td></td> <td>Define the mess code of menu type.</td></tr> <tr><td>icon</td> <td>name</td> <td>Define the icon name. (icon used in menu)</td></tr> <tr><td>icon</td> <td>library</td> <td>Define the location of the icon. System will find the specific image through the library and name</td></tr> <tr><td>image</td> <td>name</td> <td>Define the image name. (image used in menu)</td></tr> <tr><td>image</td> <td>library</td> <td>Define the location of the image</td></tr></tbody></table> <br> <p>M18 has some default menu type as follows:</p> <ul><li><p>FM is used to represent <code>File Master Module</code></p></li> <li><p>TRAN is used to represent <code>Transaction Module</code></p></li> <li><p>SETTING is used to represent <code>Setting Module</code></p></li> <li><p>EBI is used to represent <code>EBI Module</code></p></li> <li><p>OTHER/ <code>blank</code> is used to represent <code>Other Module</code></p> <p><img src="/assets/img/menuType.f3678c77.jpg" alt="mssst"></p></li></ul> <blockquote><p>Example</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menuType</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>FM<span class="token punctuation">&quot;</span></span> <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fm/master<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>icon</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cicon-fm-master-data<span class="token punctuation">&quot;</span></span> <span class="token attr-name">library</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font/cawIcon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>icon</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fmIcon.png<span class="token punctuation">&quot;</span></span> <span class="token attr-name">library</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img/icon<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menuType</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><br> <blockquote><p>function's attributes. function defines the available function/ right of a menu. It is also the basic unit of menu's access right.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>Y</td> <td>Define the function name. Recommended to use alphabet and underscore</td></tr> <tr><td>group</td> <td>N</td> <td>Define the group shown in [Role Right Setup]</td></tr> <tr><td>messCode</td> <td>Y</td> <td>Define the messCode used in user interface</td></tr> <tr><td>tooltip</td> <td>Y</td> <td>Define the tooltip displayed in [Role Right Setup]</td></tr></tbody></table> <p>Please refer to [Role Right Setup] for the list of current function.</p> <br> <blockquote><p>menuHelper's attributes. Mainly used to create menuParam.</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>Define the menu code that uses the function under the <code>class</code></td></tr> <tr><td>mType</td> <td>Define the menu type that uses the function under the <code>class</code></td></tr> <tr><td>class</td> <td>Define the class name that implements MenuHelper. Can use <code>isFor</code> to define specific menu</td></tr></tbody></table> <br> <blockquote><p>folder's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>Define the folder name</td></tr> <tr><td>messCode</td> <td>Define the folder mess code</td></tr> <tr><td>apDebug</td> <td>Boolean. Only visible in user interface when debug mode is on</td></tr> <tr><td>flag</td> <td>Define the flag in which this flag can be used in java bean</td></tr> <tr><td>order</td> <td>Define the order of the folder in the tree</td></tr></tbody></table> <br> <blockquote><p>menu's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Child Element</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td></td> <td>String</td> <td>Define the menu code</td></tr> <tr><td>messCode</td> <td></td> <td>String</td> <td>Define the menu mess code</td></tr> <tr><td>src</td> <td></td> <td>String</td> <td>Define the link when this menu is clicked</td></tr> <tr><td>module</td> <td></td> <td>String</td> <td>Define the module used by this menu</td></tr> <tr><td>mType</td> <td></td> <td>String</td> <td>Define the menu type for this menu</td></tr> <tr><td>templet</td> <td></td> <td>Boolean</td> <td>Indicate if the current menu is a template. Template will not shown in user interface but can be inherited by other menu</td></tr> <tr><td>apDebug</td> <td></td> <td>Boolean</td> <td>Indicate if it can only be visible in user interface when debug mode is on</td></tr> <tr><td>flag</td> <td></td> <td>String</td> <td>Define the flag in which this flag can be used in java bean</td></tr> <tr><td>inherit</td> <td>name</td> <td>String</td> <td>Define the template used</td></tr> <tr><td>inherit</td> <td>include</td> <td>String</td> <td>Define the function name only inherit from the template. <code>;</code> separated</td></tr> <tr><td>inherit</td> <td>except</td> <td>String</td> <td>Define the function name exclude from the function list in the template. <code>;</code> separated</td></tr> <tr><td>function</td> <td>name</td> <td>String</td> <td>Define the function name. <code>;</code> separated</td></tr> <tr><td>controller</td> <td><code>NA</code></td> <td>String</td> <td>Define the controller class name used for this menu</td></tr> <tr><td>listener</td> <td><code>NA</code></td> <td>String</td> <td>Define the listener class name used for this menu</td></tr> <tr><td>param</td> <td>key</td> <td>String</td> <td>Define the key used in key-value pair for the purpose of adding additional parameters to the editor</td></tr> <tr><td>param</td> <td>value</td> <td>String</td> <td>Define the value used in key-value pair for the purpose of adding additional parameters to the editor</td></tr> <tr><td>menuParam</td> <td>name</td> <td>String</td> <td>Parameter's name</td></tr> <tr><td>menuParam</td> <td>description</td> <td>String</td> <td>Parameter's mess code</td></tr> <tr><td>menuParam</td> <td>pattern</td> <td>String</td> <td>Parameter's pattern</td></tr> <tr><td>menuParam</td> <td>folder</td> <td>String</td> <td>Parameter's grouping</td></tr> <tr><td>order</td> <td></td> <td>int</td> <td>Define the order of the menu in the folder</td></tr></tbody></table> <br> <blockquote><p>Example</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nm</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.multiable.com/navmenu<span class="token punctuation">&quot;</span></span> <span class="token attr-name">app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>caw<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>New<span class="token punctuation">&quot;</span></span> <span class="token attr-name">group</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Editor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">messCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.saveNew<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tooltip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>right.tt.new<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Save<span class="token punctuation">&quot;</span></span> <span class="token attr-name">group</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Editor<span class="token punctuation">&quot;</span></span> <span class="token attr-name">messCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.save<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tooltip</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>right.tt.save<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
	
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>folder</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sys<span class="token punctuation">&quot;</span></span> <span class="token attr-name">messCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.sys<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>menu</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">messCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>view/module/test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>        
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>function</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>New;Save<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>menu</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>folder</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nm</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>How to determine if a user has defined access right?</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">UserRightInfo</span> info <span class="token operator">=</span> <span class="token class-name">UserLib</span><span class="token punctuation">.</span><span class="token function">getRight</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">FrameRight</span> right <span class="token operator">=</span> info<span class="token punctuation">.</span><span class="token function">getFrameRight</span><span class="token punctuation">(</span>menu<span class="token punctuation">,</span>beId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Note</strong>: Function added by other parties should use <code>otherRight</code> in <code>right</code> to determine.</p> <h3 id="module-xml"><a href="#module-xml" class="header-anchor">#</a> module.xml</h3> <p><a href="/en/m18/overview.html#m18-module">Module</a> represent a group of editor (or function)'s tables. In M18, module must have a main table and other tables must be related to the primary key of the main table.</p> <blockquote><p>module's attributes'</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Define the module name</td></tr> <tr><td>mess</td> <td>String</td> <td>Define the module mess code</td></tr> <tr><td>extend</td> <td>Boolean</td> <td>Indicate if the current element is the extension of any existing element.</td></tr> <tr><td>mainTable</td> <td>String</td> <td>Define the main table used in this module. <strong>Note</strong>: The main table must exist in the child tag <code>table</code></td></tr> <tr><td>useBe</td> <td>Boolean</td> <td>Indicate if the current module should use business entity</td></tr> <tr><td>fmshare</td> <td>String</td> <td>Define the level of data separation. <code>blank</code> means it is not a file master's editor. <code>Y</code> means it is a file master's editor and the data is based on business entity. <code>N</code> means it is a file master's editor and the data is shared among business entity</td></tr> <tr><td>useAccess</td> <td>Boolean</td> <td>Indicate if the current module should be controlled by Data Guard</td></tr> <tr><td>useAttach</td> <td>Boolean</td> <td>Indicate if the current module should enable attachment function</td></tr> <tr><td>useApv</td> <td>Boolean</td> <td>Indicate if the current module should enable approval function</td></tr> <tr><td>useChangenote</td> <td>Boolean</td> <td>Indicate if the current module should enable change note function</td></tr> <tr><td>useCache</td> <td>Boolean</td> <td>Indicate if cache should be used. Default <code>true</code>. <strong>Note</strong>: If the module is manually cached or cannot be cached, it is recommended to turn this flag to <code>false</code>. To update the cache, please increase the <code>iRev</code> in the table</td></tr> <tr><td>useAutoGenCode</td> <td>Boolean</td> <td>Indicate if the module can use code format setup. <code>New</code> functions is needed to enable this feature</td></tr> <tr><td>genCode_Field</td> <td>String</td> <td>Define the field that the output from code format setup will be assigned to. Default <code>code</code></td></tr> <tr><td>genCode_Date</td> <td>String</td> <td>Define the date field that is used in code format setup. Default <code>createDate</code></td></tr> <tr><td>fieldDataGuard</td> <td>Integer</td> <td>Indicate if the current module should enable Field Data Guard. <code>-1</code> means disabled. <code>1</code> means enabled. <code>0</code> means enabled when <code>New</code> function is enabled</td></tr> <tr><td>udfLogicSkip</td> <td>Boolean</td> <td>Indicate if UDF Logic should be skipped</td></tr> <tr><td>supportUdf</td> <td>Boolean</td> <td>Indicate if current module should support managing UDF fields</td></tr> <tr><td>checkCodeExist</td> <td>Boolean</td> <td>Indicate if M18 should automatically check if <code>code</code> already exists in the database and warn the user when code is input in the user interface</td></tr> <tr><td>dataSynch</td> <td>String</td> <td>Define Data Easy should be enabled for this module. <code>New</code> function should be enabled. Default is enabled</td></tr> <tr><td>dataImportConveter</td> <td>String</td> <td>Define the class name used for special handling in importation. Please refer to <a href="#data-import-and-export">Data Import and Export</a> for more details</td></tr> <tr><td>excelGener</td> <td>String</td> <td>Define the class name used for special handling in exportation. Please refer to <a href="#data-import-and-export">Data Import and Export</a> for more details</td></tr> <tr><td>template</td> <td>Boolean</td> <td>Mark if current configuration is UDF template or not, which is used in UDF Editor</td></tr> <tr><td>tableOrders</td> <td>String</td> <td>Define the order of the table for most of the process. <code>;</code> separated. <strong>Note</strong>: Main Table defined in <code>mainTable</code> must appear first</td></tr> <tr><td>codeDupLevel</td> <td>String</td> <td>Define the code's duplicated level. If <code>BE</code>, <code>beId</code> + <code>code</code> will be the unique key in the table. <strong>Note</strong>: M18 will create unique key constraint in the database when the system is started, please ensure the uniqueness of the code before the constraint is created</td></tr> <tr><td>skipExpired</td> <td>Boolean</td> <td>Indicate the current module does not enable expired function</td></tr> <tr><td>skipSysBC</td> <td>Boolean</td> <td>Indicate the current module will not create the code unique index. And will not check the duplicated code between BEs.</td></tr> <tr><td>importAllowUpdate</td> <td>Boolean</td> <td>Indicate the current module can be update in Data Import. Default is true.</td></tr> <tr><td>importThreadMode</td> <td>Boolean</td> <td>Indicate the current module can be using multithreading in Data Import. Default is true.</td></tr></tbody></table> <br> <blockquote><p>table's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Define the table name. The table name must be already defined in datadict.xml</td></tr> <tr><td>tpl</td> <td>String</td> <td>Used by UDF Editor. Mark the actual datadict table used by this UDF editor</td></tr> <tr><td>c</td> <td>Boolean</td> <td>Indicate if this table supports creation of record. If <code>false</code>, new record will not be created in this table</td></tr> <tr><td>r</td> <td>Boolean</td> <td>Indicate if this table supports reading of record. If <code>false</code>, system will ignore this table when reading record in the module</td></tr> <tr><td>u</td> <td>Boolean</td> <td>Indicate if this table supports saving of record. If <code>false</code>, system will ignore this table when saving record in the module</td></tr> <tr><td>d</td> <td>Boolean</td> <td>Indicate if this table supports deletion of record. If <code>false</code>, system will ignore this table when deleting record in the module</td></tr> <tr><td>initRow</td> <td>Integer</td> <td>Define the number of row added for this table when the module is initialized</td></tr> <tr><td>forceInit</td> <td>Boolean</td> <td>Indicate if the number of row should be added if the row of the table after reading from database is less than <code>initRow</code> defined</td></tr> <tr><td>hpk</td> <td>String</td> <td>Define the fields that used to link with the primary key in main table. <strong>Note</strong>: No need to input when the current table is main table. Do not create any foreign key for this field</td></tr> <tr><td>fkey</td> <td>String</td> <td>Define the fields in the footer which can be used to determine the uniqueness of the record</td></tr> <tr><td>hfname</td> <td>String</td> <td>Mark the upper level footer's info</td></tr> <tr><td>hfkey</td> <td>String</td> <td>The key field of upper level footer</td></tr> <tr><td>order</td> <td>String</td> <td>Define a field that is used to order the table. Only affect the read action</td></tr> <tr><td>cpnType</td> <td>String</td> <td>Define the type of this table. if <code>table</code>, the relationship between main table and this table will be 1:N. <strong>Note</strong>: If <code>table</code>, the table will support UDF Field</td></tr> <tr><td>discriminatorColumn</td> <td>String</td> <td>Define a field that is used to discriminate the module used when this table is used by many module</td></tr> <tr><td>resetDiscriminatorColumn</td> <td>Boolean</td> <td>Indicate if discriminator column should be reset</td></tr> <tr><td>dataImport</td> <td>Boolean</td> <td>Indicate if importation is supported. <strong>Note</strong>: If the main table does not support importation, the current module will not support importation too</td></tr> <tr><td>dataExport</td> <td>Boolean</td> <td>Indicate if exportation is supported. <strong>Note</strong>: If the main table does not support exportation, the current module will not support exportation too</td></tr> <tr><td>columnOrders</td> <td>String</td> <td>Define the column order for importation. <code>;</code> separated</td></tr> <tr><td>fieldRightSetting</td> <td>Boolean</td> <td>Indicate if the current table should enable Field Data Guard</td></tr> <tr><td>compareKey</td> <td>String</td> <td>Define the field that is used to determine the difference between the historical data and current data. <code>;</code> separated</td></tr> <tr><td>sfKey</td> <td>String</td> <td>The key field to join the current footer and upper level footer</td></tr></tbody></table> <br> <blockquote><p>checker's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>class</td> <td>String</td> <td>Define the class used for this checker</td></tr> <tr><td>exclude</td> <td>String</td> <td>Define the method excluded from the <code>class</code>. Excluded method will not be triggered. <code>;</code> separated</td></tr> <tr><td>include</td> <td>String</td> <td>Define the method included from the <code>class</code>. Only included method will be triggered. <code>;</code> separated</td></tr> <tr><td>skipSuper</td> <td>Boolean</td> <td>Indicate if methods in super class should be ignored</td></tr> <tr><td>apployTo</td> <td>String</td> <td>Define the modules that this checker will be applied to. <code>*</code> means apply to all modules</td></tr></tbody></table> <br> <blockquote><p>param's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>key</td> <td>key of the param. use <code>Module.getParam()</code> to get all the parameters in this module.</td></tr> <tr><td>value</td> <td>value of the param.</td></tr></tbody></table> <br> <blockquote><p>dataImportExtend's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>extendSrc</td> <td>Indicate the extend page path which use in Date Import.</td></tr> <tr><td>dtoClass</td> <td>The data class which use in extend page.</td></tr></tbody></table> <br> <blockquote><p>dataExportExtend's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>extendSrc</td> <td>Indicate the extend page path which use in Date Export.</td></tr> <tr><td>dtoClass</td> <td>The data class which use in extend page.</td></tr></tbody></table> <br> <blockquote><p>Example:</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>md</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.multiable.com/module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>caw<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mainTable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">useAccess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token attr-name">useAttach</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initRow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>useroption<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initRow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">forceInit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userrole<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hpk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cpnType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>usercontrol<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initRow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hpk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">forceInit</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userdefbe<span class="token punctuation">&quot;</span></span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">initRow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hpk</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fKey</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>beId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">order</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>priority<span class="token punctuation">&quot;</span></span> <span class="token attr-name">cpnType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>table<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        
        <span class="token comment">&lt;!-- this checker is for all module!  --&gt;</span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.ejb.checker.ModuleChecker<span class="token punctuation">&quot;</span></span> <span class="token attr-name">applyTo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.ejb.checker.ExtDataChecker<span class="token punctuation">&quot;</span></span> <span class="token attr-name">applyTo</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checker</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.ejb.checker.UserChecker<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
  	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>md</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="i18n-implementation"><a href="#i18n-implementation" class="header-anchor">#</a> i18n Implementation</h3> <p>M18 supports multiple language display. It is required to display the content at least in English, Simplified Chinese and Traditional Chinese. User can add additional language in M18.</p> <blockquote><p>Related document is located in /main/resources/META-INF/lang/Message_*.properties</p></blockquote> <p>Developer can use Eclipse to edit the above documents.</p> <p><img src="/assets/img/messcode.c5c72af9.jpg" alt="mssst"></p> <p><strong>Note</strong>: For any new mess code, English translation must exist.</p> <p>To ensure the uniqueness of mess code, it is suggested to use App's name for the prefix of mess code.</p> <p>Developers can retrieve the translation using the mess code like the following example:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> text <span class="token operator">=</span> <span class="token class-name">CawGlobal</span><span class="token punctuation">.</span><span class="token function">getMess</span><span class="token punctuation">(</span><span class="token string">&quot;EBI&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In addition, if the mess code needs to be used in JavaScript, please add a record in <code>webKey.properties</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> mText <span class="token operator">=</span> myView<span class="token punctuation">.</span><span class="token function">getMess</span><span class="token punctuation">(</span><span class="token string">'EBI'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Note</strong>: Please do not use the keyword in HTML if the mess code can be used in JavaScript.</p> <br> <blockquote><p>webKey.properties Example</p></blockquote> <div class="language-json extra-class"><pre class="language-json"><code><span class="token comment">// web mess for core</span>
CloseAllTabs
EBI
all
</code></pre></div><br> <blockquote><p>User defined language and mess code. Please refer to M18 editors: UDF Language, Messcode</p></blockquote> <p>M18 supports data saving in multiple language. The simplest way is to set <code>i18nField</code> of the desired column to <code>true</code> in datadict.xml. These data will be stored in database in JSON format.</p> <blockquote><p><img src="/assets/img/i18nfield.26799b57.jpg" alt="mssst"><img src="/assets/img/i18n.920c277f.jpg" alt="mssst"></p></blockquote> <p>For simplicity, M18 will translate the i18n's fields to the current language. The following is an example showing how <code>desc</code>, an i18n's field, can be retrieved from <code>SqlTable</code>.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">String</span> desc<span class="token operator">=</span> employee<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;desc_en&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
employee<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;desc_zh_CN&quot;</span><span class="token punctuation">,</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
employee<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;desc_en&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>Note</strong>: The multiple language information is stored in the column <code>i18nField</code>, If you want to modify the i18n's field in database directly, please modify <code>i18nField</code> as well.</p> <h3 id="search-implementation"><a href="#search-implementation" class="header-anchor">#</a> Search Implementation</h3> <p>Table/ View can be searched by setting up stInfo.xml and stSearch.xml.  <a href="/en/m18/overview.html#m18-lookup">Lookup</a> component in user interface also searches data using the above two XMLs.</p> <h3 id="stinfo-xml"><a href="#stinfo-xml" class="header-anchor">#</a> stInfo.xml</h3> <p>stInfo is to define the table used in searching and to avoid exposing the table directly to the user. If a stInfo is used in stSearch and the corresponding information is not defined in stInfo.xml, the system will generate the corresponding stInfo information according to datadict by default.</p> <blockquote><p>stInfo's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>true</td> <td>string</td> <td>stInfo's name, normally same name as corresponding table</td></tr> <tr><td>mess</td> <td>true</td> <td>string</td> <td>stInfo's mess code</td></tr> <tr><td>table</td> <td>true</td> <td>string</td> <td>Target table's name (in datadict)</td></tr> <tr><td>inCols</td> <td>false</td> <td>string</td> <td>Define which fields in the table are available in this stInfo. If this parameter is empty, all fields representing the corresponding table are available in this stInfo. If not empty, the two fields need to be separated by a semicolon <code>;</code></td></tr> <tr><td>exCols</td> <td>false</td> <td>string</td> <td>Define which fields in the table are NOT available in the current stInfo. If this parameter is empty, all fields representing the corresponding table are available in this stInfo. If not empty, the two fields need to be separated by a semicolon <code>;</code></td></tr> <tr><td>autoRelation</td> <td>false</td> <td>boolean</td> <td>Indicate auto create the relation of lookup field</td></tr> <tr><td>skipBuildin</td> <td>false</td> <td>boolean</td> <td>Indicate build-in column can used in lookup condition.</td></tr></tbody></table> <br> <blockquote><p>relation's attributes. The relation tag defines how the table of the current stInfo associates with the table of another stInfo.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>col</td> <td>false</td> <td>string</td> <td>The field to join with other's stInfo</td></tr> <tr><td>tarSt</td> <td>true</td> <td>string</td> <td>The target stInfo's name</td></tr> <tr><td>tarCol</td> <td>false</td> <td>string</td> <td>The target stInfo's column</td></tr> <tr><td>tarNullAble</td> <td>false</td> <td>boolean</td> <td>The default is false; if true; the left outer join is used; otherwise, the inner join is used</td></tr> <tr><td>joinCond</td> <td>false</td> <td>string</td> <td>If not empty, this joining condition string will be used, otherwise use tarSt and tarCol</td></tr></tbody></table> <br> <blockquote><p>col's attributes. The col tag is used to define a custom field to be returned by the search result. This tag is not required.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>true</td> <td>string</td> <td></td> <td>Field's name</td></tr> <tr><td>mess</td> <td>true</td> <td>string</td> <td></td> <td>Field's mess code</td></tr> <tr><td>pattern</td> <td>false</td> <td>string</td> <td></td> <td>Field's pattern</td></tr> <tr><td>sql</td> <td>false</td> <td>string</td> <td></td> <td>If the value of this field is to be queried from the database, you need to input the SQL query string</td></tr> <tr><td>cond</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be used as a query condition.</td></tr> <tr><td>sort</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be used for sorting</td></tr> <tr><td>show</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be displayed on the M18's UI.</td></tr></tbody></table> <br> <blockquote><p>handler's attributes. The handler tag is used to configure stlnfo's handler, which can further control the initialization of stInfo. This tag is optional.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>stInfoName</td> <td>true</td> <td>string</td> <td>stInfo's name</td></tr> <tr><td>className</td> <td>true</td> <td>string</td> <td>handler's class name</td></tr></tbody></table> <h3 id="stsearch-xml"><a href="#stsearch-xml" class="header-anchor">#</a> stSearch.xml</h3> <blockquote><p>stSearch's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>true</td> <td>string</td> <td></td> <td>stSearch's name</td></tr> <tr><td>mess</td> <td>true</td> <td>string</td> <td></td> <td>stSearch's mess code</td></tr> <tr><td>srcSt</td> <td>false</td> <td>string</td> <td></td> <td>Use the stInfo in stInfo.xml</td></tr> <tr><td>maxLevel</td> <td>false</td> <td>int</td> <td>3</td> <td>Indicate the maximum number of levels that can be related to stInfo</td></tr> <tr><td>defCond</td> <td>false</td> <td>string</td> <td></td> <td>Default query condition</td></tr> <tr><td>sort</td> <td>false</td> <td>string</td> <td></td> <td>Default sorting order</td></tr> <tr><td>supportMultiSort</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If false, only support single field sorting</td></tr> <tr><td>asyncGetCount</td> <td>false</td> <td>boolean</td> <td>false (defaults to true if ejb is not set or slave is not set)</td> <td>If set to true, the count of lookup queries will be queried separately from the query data</td></tr> <tr><td>mustJoinSt</td> <td>false</td> <td>string</td> <td></td> <td>Used to define the stInfo that must be joined in this query. StInfo must be in the relation hierarchy of srcSt; Two or more stlnfos need to be separated by semicolons <code>;</code></td></tr> <tr><td>ejb</td> <td>false</td> <td>string</td> <td></td> <td>The EJB to do search, if not provided the default EJB will be used. If you need to provide an EJB, it must extend <code>GenSearchSqlAdapter</code></td></tr> <tr><td>udfUse</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If set to false, it will not appear in the UDF modules</td></tr> <tr><td>accessModule</td> <td>false</td> <td>string</td> <td></td> <td>The module corresponding to the current stSearch</td></tr> <tr><td>accessField</td> <td>false</td> <td>string</td> <td>“id”</td> <td>Specify which field of srcSt is associated with the id field of the footer table</td></tr> <tr><td>nameCardSupport</td> <td>false</td> <td>boolean</td> <td>true</td> <td>Support nameCard or not</td></tr> <tr><td>hideFormat</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If set to true, lookup will hide the format, and then user can not set the format</td></tr> <tr><td>hideFilter</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If set to false, users can not add a filter condition on the lookup</td></tr> <tr><td>supportSearch</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If set to false, users can not use mask search on the lookup</td></tr> <tr><td>supportDeletedData</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If true, search can query the records that have been deleted</td></tr> <tr><td>slaveEjb</td> <td>false</td> <td>string</td> <td></td> <td>slave's class name</td></tr> <tr><td>slaveApplyTo</td> <td>false</td> <td>string</td> <td></td> <td>The current slave can be used in other stSearch; fill in the stSearch name here; if you need to fill in more than two stSearch, please use the semicolon <code>;</code> to separate them.</td></tr> <tr><td>skipAccess</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If set to true, lookup will skip access right</td></tr></tbody></table> <br> <blockquote><p>slaveCol's attributes. The slaveCol tag is used to define a custom field that is returned as a result of the search. This tag is optional.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>col</td> <td>true</td> <td>string</td> <td></td> <td>Field's name</td></tr> <tr><td>mess</td> <td>true</td> <td>string</td> <td></td> <td>Field's mess code</td></tr> <tr><td>pattern</td> <td>false</td> <td>string</td> <td></td> <td>Field's pattern</td></tr> <tr><td>sql</td> <td>false</td> <td>string</td> <td></td> <td>If the value of this field is to be queried from the database, you need to input a string of SQL to this</td></tr> <tr><td>cond</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be used as a query condition</td></tr> <tr><td>sort</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be used for sorting order</td></tr> <tr><td>show</td> <td>false</td> <td>boolean</td> <td>true</td> <td>If the value is true, this field can be displayed in the M18's UI</td></tr> <tr><td>followField</td> <td>false</td> <td>string</td> <td></td> <td>Fill a field under the current stInfo or associated table. Used to add the currently added slaveField behind the field in the left column of the format setting interface.</td></tr></tbody></table> <br> <blockquote><p>bindCond's attributes. The compulsory condition for this stSearch</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>andOr</td> <td>false</td> <td>string</td> <td></td> <td>If not set, SQL will use AND to construct</td></tr> <tr><td>leftBrackets</td> <td>false</td> <td>string</td> <td></td> <td>If needed, please fill &quot;(&quot;</td></tr> <tr><td>leftFieldMode</td> <td>false</td> <td>string</td> <td>&quot;column&quot;</td> <td>Indicates the type of <code>leftField</code></td></tr> <tr><td>leftField</td> <td>false</td> <td>string</td> <td></td> <td>If <code>leftFieldMode</code> is &quot;column&quot;, then we will fill in the column name. If <code>leftFieldMode</code> is &quot;value&quot;, then fill in the data</td></tr> <tr><td>operator</td> <td>fasle</td> <td>string</td> <td>&quot;=&quot;</td> <td>Fill in the operator here; the default is &quot;=&quot;</td></tr> <tr><td>rightFieldMode</td> <td>false</td> <td>string</td> <td>&quot;value&quot;</td> <td>Indicates the type of <code>rightField</code></td></tr> <tr><td>rightField</td> <td>fasle</td> <td>string</td> <td></td> <td>If <code>rightFieldMode</code> is &quot;column&quot;, then we will fill in the column name. If <code>rightFieldMode</code> is &quot;value&quot;, then fill in the data</td></tr> <tr><td>rightBrackets</td> <td>false</td> <td>string</td> <td></td> <td>If needed, please fill &quot;)&quot;</td></tr> <tr><td>condString</td> <td>false</td> <td>string</td> <td></td> <td>Fill in a SQL query here; If you set this, all the above parameters will lose their effect.</td></tr></tbody></table> <br> <blockquote><p>format's attributes. format is used to configure the query condition</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>id</td> <td>true</td> <td>int</td> <td>-1</td> <td>Can not be greater than <code>0</code>. If greater than <code>0</code> will be changed to <code>-</code></td></tr> <tr><td>mess</td> <td>true</td> <td>string</td> <td></td> <td>format's mess code</td></tr></tbody></table> <br> <blockquote><p>format's cond's attributes. The default query condition</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>andOr</td> <td>false</td> <td>string</td> <td></td> <td>If not set, will use &quot;AND&quot; to construct SQL</td></tr> <tr><td>leftBrackets</td> <td>false</td> <td>string</td> <td></td> <td>If needed, please fill &quot;(&quot;</td></tr> <tr><td>leftFieldMode</td> <td>false</td> <td>string</td> <td>&quot;column&quot;</td> <td>Indicates the type of <code>leftField</code></td></tr> <tr><td>leftField</td> <td>false</td> <td>string</td> <td></td> <td>If <code>leftFieldMode</code> is &quot;column&quot;; then we will fill in the column name; if <code>leftFieldMode</code> is &quot;value&quot;, then fill in the data</td></tr> <tr><td>operator</td> <td>fasle</td> <td>string</td> <td>&quot;=&quot;</td> <td>Fill in the operator here; the default is &quot;=&quot;</td></tr> <tr><td>rightFieldMode</td> <td>false</td> <td>string</td> <td>&quot;value&quot;</td> <td>Indicates the type of <code>rightField</code></td></tr> <tr><td>rightField</td> <td>fasle</td> <td>string</td> <td></td> <td>If <code>rightFieldMode</code> is &quot;column&quot;; then we will fill in the column name; if <code>rightFieldMode</code> is &quot;value&quot;, then fill in the data</td></tr> <tr><td>rightBrackets</td> <td>false</td> <td>string</td> <td></td> <td>If needed, please fill &quot;)&quot;</td></tr> <tr><td>condString</td> <td>false</td> <td>string</td> <td></td> <td>Fill in a SQL query here; If you set this, all the above parameters will lose their effect.</td></tr></tbody></table> <br> <blockquote><p>format's col's attributes. To configure default display fields.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>col</td> <td>true</td> <td>string</td> <td></td> <td>Field's name</td></tr> <tr><td>mess</td> <td>false</td> <td>string</td> <td></td> <td>Mess code</td></tr> <tr><td>width</td> <td>false</td> <td>string</td> <td></td> <td>The width of the field in browse dialog table</td></tr> <tr><td>sortable</td> <td>false</td> <td>boolean</td> <td>true</td> <td>Indicate the current column can be sorted.</td></tr></tbody></table> <br> <blockquote><p>format's sort's attributes. To set the default sorting order.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>col</td> <td>true</td> <td>string</td> <td></td> <td>Field's name</td></tr> <tr><td>ascending</td> <td>false</td> <td>boolean</td> <td>false</td> <td>If set to true, it will be sorted using descending order</td></tr></tbody></table> <br> <blockquote><p>namecard's attributes. Please read <a href="/en/m18/frontend_doc.html#namecard-development">Name Card</a>.</p></blockquote> <br> <blockquote><p>handler's attributes. The tag is used to configure the <code>init</code> method of the lookup parameter <code>StParameter</code>. The <code>init</code> method runs before the search data is loaded into the lookup field, and the page lookup field runs before the query.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>true</td> <td>string</td> <td></td> <td>The class name; the method inside the class must have @InitStSearchParam annotation</td></tr></tbody></table> <br> <blockquote><p>stSearchInitHandler's attributes. The stSearchInitHandler tag is used to configure the class that initializes stSearch.</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>stSearchName</td> <td>true</td> <td>string</td> <td></td> <td>stSearch's name</td></tr> <tr><td>className</td> <td>true</td> <td>string</td> <td></td> <td>Fill a class that extends <code>StSearchInitHandlerAdapter</code></td></tr></tbody></table> <br> <p><strong>Note:</strong> By setting stInfo and stSearch, you can use &quot;search&quot; to query data</p> <blockquote><p>Configure XML: stInfo</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stInfo</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>simpleUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share.user<span class="token punctuation">&quot;</span></span> <span class="token attr-name">table</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stInfo</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stInfo</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share.employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">table</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relation</span> <span class="token attr-name">col</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>createUid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tarSt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>simpleUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tarCol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relation</span> <span class="token attr-name">col</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lastModifyUid<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tarSt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>simpleUser<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tarCol</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stInfo</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>Configure XML: stSearch</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stSearch</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">srcSt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxLevel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span> <span class="token attr-name">sort</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#employee#.code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">accessModule</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">asyncGetCount</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bindCond</span> <span class="token attr-name">leftField</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!=<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rightField</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>format</span> <span class="token attr-name">mess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>core.defFormat<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>col</span> <span class="token attr-name">col</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>code<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>col</span> <span class="token attr-name">col</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>desc<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>format</span><span class="token punctuation">&gt;</span></span>

	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>namecard</span> <span class="token attr-name">imgCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>photoCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>290<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>namecard</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stSearch</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><br> <h4 id="search-process-customization"><a href="#search-process-customization" class="header-anchor">#</a> Search Process Customization</h4> <p><strong>Note:</strong> In the search process, developers can configure slave or handler to modify the search process.</p> <ol><li>Slave configuration: It needs to inherit the <code>SearchSlaveAdapter</code>. Then through the methods <code>beforeDatalookup()</code> and <code>afterDatalookup()</code> it overrides the search process. In <code>beforeDatalookup()</code>, developers can add conditions that can affect the query results.  In <code>afterDatalookup()</code>, developers can modify the query results before it return to users.</li> <li>handler tag configured in stSearch.xml: It is the processing method to run before the lookup checking of data import, and before lookup result is returned in the page.</li></ol> <p>As you can see in the below example, the processing method in the handler needs to be annotated with @InitStSearchParam. The method must be static, and the parameters are also fixed (StParameter param, SqlEntity entity, String tableName, String colName, int row).</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>handler</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.share.modulestsearch.InitStParam<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>handler</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">InitStParam</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@InitStSearchParam</span><span class="token punctuation">(</span>moduleName <span class="token operator">=</span> <span class="token string">&quot;dept&quot;</span><span class="token punctuation">,</span> stSearch <span class="token operator">=</span> <span class="token string">&quot;dept&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">initDeptSupDeptParam</span><span class="token punctuation">(</span><span class="token class-name">StParameter</span> param<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token class-name">String</span> tableName<span class="token punctuation">,</span> <span class="token class-name">String</span> colName<span class="token punctuation">,</span> <span class="token keyword">int</span> row<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token string">&quot;dept&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;supDept&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>colName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <ol start="3"><li>initHandler Class: Adding tag stSearchInitHandler in stSearch.xml can make 3PD further customize stSearch initialization.</li></ol> <p>handler class needs to inherit <code>StSearchInitHandlerAdapter</code>.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stSearchInitHandler</span> <span class="token attr-name">stSearchName</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.share.modulestsearch.EmpStSearchHandler<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmpStSearchHandler</span> <span class="token keyword">extends</span> <span class="token class-name">StSearchInitHandlerAdapter</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initStSearch</span><span class="token punctuation">(</span><span class="token class-name">StSearchInfo</span> stSearchInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">CawLog</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>stSearchInfo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <ol start="4"><li>handler tag configured in stInfo.xml: It can let 3PD further customize stInfo's initialization.</li></ol> <p>handler class needs to inherit <code>StInfoHandlerAdapter</code>.</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>handler</span> <span class="token attr-name">stInfoName</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.share.modulestsearch.EmpStInfoHandler<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmpStInfoHandler</span> <span class="token keyword">extends</span> <span class="token class-name">StInfoHandlerAdapter</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initStInfo</span><span class="token punctuation">(</span><span class="token class-name">StInfo</span> stInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">CawLog</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>stInfo<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <h4 id="self-defined-search"><a href="#self-defined-search" class="header-anchor">#</a> Self-defined Search</h4> <h5 id="solution-1-re-define-ejb-of-search"><a href="#solution-1-re-define-ejb-of-search" class="header-anchor">#</a> Solution 1: Re-define EJB of Search</h5> <p><strong>Note</strong>: If the system default constructed search SQL does not fulfill the needs, you can re-define the SearchEJB</p> <p><strong>Restriction</strong>: Need to extend <code>GenSearchSqlAdapter</code></p> <p><strong>Example</strong>: Enter the name of ejb &quot;GenEmptySQLEJB&quot; in stSearch tag, then extends class <code>GenSearchSqlAdapter</code></p> <blockquote><p>Example</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Stateless</span>
<span class="token annotation punctuation">@Local</span><span class="token punctuation">(</span><span class="token class-name">GenSearchSql</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GenEmptySqlEJB</span> <span class="token keyword">extends</span> <span class="token class-name">GenSearchSqlAdapter</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">SearchSqlInfo</span> <span class="token function">getLookupSql</span><span class="token punctuation">(</span><span class="token class-name">StSearchInfo</span> myInfo<span class="token punctuation">,</span> <span class="token class-name">StParameter</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SearchSqlInfo</span> emptyData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSqlInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		emptyData<span class="token punctuation">.</span><span class="token function">setSearchSql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		emptyData<span class="token punctuation">.</span><span class="token function">setCountSql</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> emptyData<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <h5 id="solution-2-re-define-ejb-of-search-and-slave"><a href="#solution-2-re-define-ejb-of-search-and-slave" class="header-anchor">#</a> Solution 2: Re-define EJB of Search and Slave</h5> <p><strong>Note</strong>: If an stSearch data does not need to be queried from the database, you can use the redefined SearchEJB + use slave to generate data.</p> <p><strong>Example</strong>: Enter the name of ejb &quot;GenEmptySQLEJB&quot; and slaveEjb = &quot;PatternInfoSlave&quot; in stSearch.xml tag, ejb needs to extend <code>GenSearchSqlAdapter</code>, slave needs to extend <code>SearchSlaveAdapter</code></p> <p><strong>Java Code</strong></p> <p><code>GenEmptySqlEJB</code>: Please refer to the above <code>GenEmptySqlEJB</code> example</p> <p><code>PatternInfoSlave</code>: To generate data in slave, only needs to <em>override</em> <code>afterDatalookup</code></p> <blockquote><p>Example</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Stateless</span>
<span class="token annotation punctuation">@Local</span><span class="token punctuation">(</span><span class="token class-name">SearchSlave</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PatternInfoSlave</span> <span class="token keyword">extends</span> <span class="token class-name">SearchSlaveAdapter</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterDatalookup</span><span class="token punctuation">(</span><span class="token class-name">SearchResult</span> result<span class="token punctuation">,</span> <span class="token class-name">StParameter</span> param<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlTable</span> sqlTable <span class="token operator">=</span> <span class="token class-name">StLookupLib</span><span class="token punctuation">.</span><span class="token function">createEmptyLookupTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		sqlTable<span class="token punctuation">.</span><span class="token function">addField</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SqlTableField</span><span class="token punctuation">(</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token comment">//do some search coding</span>

		<span class="token keyword">int</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> startRow <span class="token operator">=</span> param<span class="token punctuation">.</span><span class="token function">getStartRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> param<span class="token punctuation">.</span><span class="token function">getStartRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">int</span> endRow <span class="token operator">=</span> param<span class="token punctuation">.</span><span class="token function">getEndRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> keys<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> keys<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> param<span class="token punctuation">.</span><span class="token function">getEndRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> startRow<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> endRow<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">CawPattern</span> pattern <span class="token operator">=</span> <span class="token class-name">CawGlobal</span><span class="token punctuation">.</span><span class="token function">getPattern</span><span class="token punctuation">(</span>keys<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> rec <span class="token operator">=</span> sqlTable<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;st_id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;st_code&quot;</span><span class="token punctuation">,</span> pattern<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;st_desc&quot;</span><span class="token punctuation">,</span> pattern<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> pattern<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			sqlTable<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>rec<span class="token punctuation">,</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">,</span> pattern<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			id<span class="token operator">++</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		result<span class="token punctuation">.</span><span class="token function">setResultTable</span><span class="token punctuation">(</span>sqlTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		result<span class="token punctuation">.</span><span class="token function">setTotalRows</span><span class="token punctuation">(</span>keys<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><br> <h5 id="solution-3-implement-new-lookup-component"><a href="#solution-3-implement-new-lookup-component" class="header-anchor">#</a> Solution 3: Implement New Lookup Component</h5> <p><strong>Note</strong>:  If existing lookup component can not meet the needs of users, then you can write your own components, and no longer use stSearch/ stInfo configuration.</p> <p><strong>Restrictions</strong>: Everything on the page and in the query needs to be handled.</p> <h2 id="login-and-access-control"><a href="#login-and-access-control" class="header-anchor">#</a> Login and Access Control</h2> <h3 id="login-customization"><a href="#login-customization" class="header-anchor">#</a> Login Customization</h3> <p><strong>loginHandler</strong></p> <p>During M18 system login, developers can set loginHandler tag in app.xml to intercept the process. Overriding the method <code>checkLoginInfoBeforeLogin()</code> can handle before login event, while overriding <code>afterLogin()</code> method can handle after login process.</p> <blockquote><p>loginHandler's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>className</td> <td>class name of the handler, needs to extend <code>LoginHandlerAdapter</code></td></tr></tbody></table> <br> <p><strong>wsSkipAccess</strong></p> <p>For most web service requests to M18, access control will be checked with the userKey and authorization token. Using wsSkipAccess tag in app.xml can make a web service request skip such checking.</p> <blockquote><p>wsSkipAccess's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>pathNames</td> <td>path of web service to skip the access checking, multiple paths can be separated by semicolons <code>;</code>. Example: &quot;/cawLogin/checkLoginUser;/image/getImage“</td></tr></tbody></table> <br> <p><strong>webSkipAccess</strong></p> <p>M18 will check session login status for non-web service requests as well, use webSkipAccess tag can make a  web request to M18 to skip such checking.</p> <blockquote><p>webSkipAccess's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>pathNames</td> <td>path of web request to skip session checking, multiple paths can be separated by semicolons <code>;</code>. Example: &quot;/CaptchaServlet;/wfAction”</td></tr></tbody></table> <h3 id="module-rights"><a href="#module-rights" class="header-anchor">#</a> Module Rights</h3> <p>M18 uses XML of module and navigation menu to configure available rights for a module. For details please refer to <a href="#navmenu-xml">navmenu.xml</a>.</p> <h3 id="data-guard"><a href="#data-guard" class="header-anchor">#</a> Data Guard</h3> <p>If a module has data guard enabled, when doing lookup a record in the module, data guard will be checked. For how to enable data guard in a module, please refer to <a href="#module-xml">module.xml</a>.</p> <p>The SQL related to data guard is put in the corresponding <code>StSearchInfo.java</code></p> <blockquote><p>SQL of Data Guard</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>accessStr_noBe</td> <td>SQL used when module is not BE specific</td></tr> <tr><td>accessStr_oneBe</td> <td>SQL used when module is BE specific, and only one BE's records are queried</td></tr> <tr><td>accessStr_manyBe</td> <td>SQL used when module is BE specific, and multiple BEs' records are queried</td></tr> <tr><td>accessStr_mir</td> <td>SQL used when deleted records are queried</td></tr></tbody></table> <br> <blockquote><p>Generation of data guard SQL</p></blockquote> <p>Upon stSearch initialization, system will run <code>StSearchInfo</code> initAccess method to generate these query SQLs. It will construct the white list and black list SQL based on the data guard configuration. Then the data guard of all related lookup field's of the module will be considered. If user wants a lookup field to be skipped in data guard SQL, please mark skipAccess=&quot;true&quot; in datadict.xml.</p> <h4 id="how-to-customize-data-guarded-results"><a href="#how-to-customize-data-guarded-results" class="header-anchor">#</a> How to Customize Data Guarded Results</h4> <p>Data Guard module has auto-calculate data guard function. During module save, it will auto-calculate related access condition data.</p> <p><strong>Note:</strong> Developer can implement entityHandler's autoCalcAccess method to intercept the data guard logic</p> <blockquote><p>entityHandler's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>string</td> <td>Module name to be affected. If empty, it will affect all modules.</td></tr> <tr><td>className</td> <td>string</td> <td>class qualified name. class needs to extend <code>EntityHandlerAdapter</code></td></tr></tbody></table> <h4 id="how-to-replace-search-s-data-guard"><a href="#how-to-replace-search-s-data-guard" class="header-anchor">#</a> How to Replace Search's Data Guard</h4> <p>Developer can refer to <a href="#search-process-customization">Search Process Customization</a>, point 3, to modify the data guard of search.</p> <h3 id="field-level-access-rights"><a href="#field-level-access-rights" class="header-anchor">#</a> Field Level Access Rights</h3> <p>All fields in system tables and the fields: <code>code</code>, <code>desc</code>, <code>beId</code> in all tables cannot have field level access rights. Fields that are marked with <code>buildin</code> = <code>true</code> cannot have field level access rights.</p> <p>Developers can disable field level access rights for all fields in a table by setting <code>fieldRightSetting</code> = <code>false</code> for a table in module.xml.</p> <p><strong>Note</strong>: Can use methods in <code>RightLib</code> to get field rights.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldRightDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">getFieldRight</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tables<span class="token punctuation">)</span>；
<span class="token comment">// Get field rights for current user, input is beId and a set of table names </span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldRightDto</span><span class="token punctuation">&gt;</span></span> <span class="token function">getFieldRight</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tables<span class="token punctuation">,</span> <span class="token keyword">long</span> uid<span class="token punctuation">)</span>；
<span class="token comment">// Get field rights for a specific user (need to pass in uid)</span>
</code></pre></div><h2 id="common-functions"><a href="#common-functions" class="header-anchor">#</a> Common Functions</h2> <h3 id="about-jboss-configuration-file"><a href="#about-jboss-configuration-file" class="header-anchor">#</a> About JBoss Configuration File</h3> <h4 id="cawserver-properties"><a href="#cawserver-properties" class="header-anchor">#</a> cawserver.properties</h4> <p>cawserver.properties is a very important configuration file put under wildfly9/ config folder. It is used to configure startup parameters of M18 and JBoss.</p> <blockquote><p>cawserver.properties core parameters introduction</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>#jboss server's ID, if jboss cluster is setup, each node need to have diff. jboss id
caw.jboss.id=cl

#jboss server belongs to which cluster
caw.jboss.cluster=abc

#some task will only run in main server, in a cluster environment, there should be only one main server
caw.main.server=true

#path for dbdoc and appdoc
caw.fileData.dbDoc.path=/home/centos/xxxshare
caw.fileData.appDoc.path=/home/centos/xxxshare

#temp path for temp files
caw.file.app.path=home/centos/xxxshare/temp

#External URL for M18
caw.web.url=http://www.abc.com/jsf/

#Server internal URL
caw.internal.url=@web_url

#M18 DB IP
caw.database.ip=192.168.10.117

#M18 DB Port
caw.database.port=3306

#M18 DB Name
caw.database.dbname=ce01

#M18 DB User
caw.database.user=ce01

#M18 DB Pwd
caw.database.password=ce01abcdef

#Decide if current jboss can run scheduled task, 1 means can.
caw.sch.quartz = 1
</code></pre></div><h4 id="reset-caw"><a href="#reset-caw" class="header-anchor">#</a> reset.caw</h4> <p>This file can be put under wildfly9/ config folder, which is useful for development environment. Developer can set any parameters of cawserver.properties here, when eclipse's JBoss is running, will use parameters in reset.caw to run.</p> <div class="language-xml extra-class"><pre class="language-xml"><code>#Set to 1 if want AP debug mode during jboss run
caw.ap.debug = 1
#during jboss startup, skip sync data structure or not
caw.ap.skip.sycnDB=1

#Below control if detail log message created for specifc module CRUD actions
caw.ap.debug.checker.create=0
caw.ap.debug.checker.save=0
caw.ap.debug.checker.read=0
caw.ap.debug.checker.delete=0
caw.ap.debug.checker.module=

#for lock and debug scheduled job, can enter multiple, separated by semicolons.
caw.ap.sch.debugJobName=
#for loc and debug scheduled job group, can enter multiple, separated by semicolons.
caw.ap.sch.debugJobGroup=
#lock job for how many hours
caw.ap.sch.debugTime=

#If set to 1, then report jasper report format update will be skipped
caw.report.skipUploadFormat = 0

</code></pre></div><h3 id="table-structure-information"><a href="#table-structure-information" class="header-anchor">#</a> Table Structure Information</h3> <p>For M18's developers, understanding the data structure of existing modules/functions is essential for their development. In this part we will introduce how to find important table structure information and how to use API to lookup table structure information of a module.</p> <p>In M18, developers can use [Data Dictionary] to find table/ field structure of any editor in the system:</p> <p><img src="/assets/img/dd.844baa65.jpg" alt="mssst"></p> <p>In Java code, to get datadict info with known table name, developer can use this:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">DdTable</span> table <span class="token operator">=</span> <span class="token class-name">CawGlobal</span><span class="token punctuation">.</span><span class="token function">getDdTable</span><span class="token punctuation">(</span><span class="token string">&quot;employee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Loop the DdTable object:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Ehcache</span> cache <span class="token operator">=</span> <span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">getCache</span><span class="token punctuation">(</span><span class="token class-name">CawCache</span><span class="token punctuation">.</span>ddCache<span class="token punctuation">)</span><span class="token punctuation">;</span>
		
<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;rawtypes&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">List</span> keys <span class="token operator">=</span> cache<span class="token punctuation">.</span><span class="token function">getKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> key <span class="token operator">:</span> keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">DdTable</span> table <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">DdTable</span><span class="token punctuation">)</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getObjectValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// add you code here</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="data-import-and-export"><a href="#data-import-and-export" class="header-anchor">#</a> Data Import and Export</h3> <p>M18 has data import/export functions for most modules, which is useful for data initialization, temporary backup and data migration to/ from other systems.</p> <p><strong>Data Export</strong>
If developers need to control the data in the exported excel, one can set <code>excelGener</code> in module.xml for corresponding module, with <code>excelGener</code> = &quot;class qualified name&quot;. The class needs to implement <code>IExcelGener</code> interface. Developers can use the method <code>exportData</code> and <code>appendMoreData</code> to manipulate exported data in excel.</p> <p><strong>Note:</strong> The default implementation class for IExcelGener is ExcelGener class.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IExcelGener</span> <span class="token punctuation">{</span>
	<span class="token comment">// Method to generate excel importation template excel</span>
	<span class="token keyword">public</span> <span class="token class-name">Workbook</span> <span class="token function">createTemplate</span><span class="token punctuation">(</span><span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">String</span> dataExportConfigJson<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
	<span class="token comment">// Convert SqlEntity data to excel</span>
	<span class="token keyword">public</span> <span class="token class-name">Workbook</span> <span class="token function">exportData</span><span class="token punctuation">(</span><span class="token class-name">DataExportConfig</span> config<span class="token punctuation">,</span> <span class="token class-name">SqlEntity</span> entity<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Data Import</strong>
If developers want to control excel importation, one can set <code>excelGener</code> and <code>dataImportConverter</code> in module.xml for corresponding module, with <code>excelGener</code> = &quot;class qualified name&quot;. The class needs to implement <code>IExcelGener</code> interface. <code>dataImportConverter</code> needs to extend <code>ImportConverterAdapter</code> class.</p> <p>One can use <code>IExcelGener</code> <code>createTemplate</code> method to create an excel template for importing data. One can use the <code>dataImportConverter</code> convert method to convert excel data to the M18 system's SqlEntity structure; One can use the <code>getImportResultWriter</code> method to get the <code>ImportResultWriter</code> for writing error messages to an excel file.</p> <p><strong>Note</strong>: The M18 system uses the <code>EntityImportConverter</code> class to convert the imported excel data by default. The error information is written to the excel file by using the <code>ExcelImportResultWriter</code> class;</p> <p><strong>Note</strong>: If you want to intercept the import process without the need to redefine <code>IExcelGener</code> and <code>dataImportConveter</code>, there is one more way: define tag entityHandler in app.xml:</p> <blockquote><p>entityHandler's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>string</td> <td>Module name, if empty will affect all modules</td></tr> <tr><td>className</td> <td>string</td> <td>class qualified name, class need to extend EntityHandlerAdapter</td></tr></tbody></table> <p>Below methods in entityHandler are related to data import:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getImportSkipColumn</span><span class="token punctuation">(</span><span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">DdColumn</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getImportExtraColumn</span><span class="token punctuation">(</span><span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleExtraBeforeAllColumn</span><span class="token punctuation">(</span><span class="token class-name">String</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateExtraColumnValue</span><span class="token punctuation">(</span><span class="token class-name">SqlEntity</span> entity<span class="token punctuation">,</span> <span class="token keyword">int</span> sqlTableRow<span class="token punctuation">,</span> <span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token class-name">String</span> tableName<span class="token punctuation">,</span> <span class="token class-name">DdColumn</span> ddColumn<span class="token punctuation">,</span> <span class="token class-name">Object</span> cellValue<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getImportSkipTable</span><span class="token punctuation">(</span><span class="token class-name">String</span> moduleName<span class="token punctuation">,</span> <span class="token keyword">long</span> beId<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">default</span> <span class="token class-name">String</span> <span class="token function">modifyColumnsRemark</span><span class="token punctuation">(</span><span class="token class-name">String</span> remark<span class="token punctuation">,</span> <span class="token class-name">String</span> tableName<span class="token punctuation">,</span> <span class="token class-name">DdColumn</span> col<span class="token punctuation">,</span> <span class="token class-name">DataExportConfig</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> remark<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>entityHandler's methods related to data import:</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>getImportSkipColumn</td> <td>Return Map &lt;String, Set &lt;String &gt;&gt;; Map's key is the table name, set is the fields that will skip import</td></tr> <tr><td>getImportExtraColumn</td> <td>Return Map &lt;String, Set &lt;String &gt;&gt;; Map's key is the table name, list is the DdColumn List; Used to indicate which table in the current module needs more fields to import. These fields will be displayed in the import module and import excel template</td></tr> <tr><td>handleExtraBeforeAllColumn</td> <td>Return a list, indicates which extra fields need to be handled before all fields</td></tr> <tr><td>updateExtraColumnValue</td> <td>Used to process extra field values</td></tr> <tr><td>getImportSkipTable</td> <td>Returns a set indicating which tables in the current module will not be able to use the import function</td></tr> <tr><td>modifyColumnsRemark</td> <td>Used to modify the column remarks in excel importation template</td></tr></tbody></table> <h3 id="document-printing"><a href="#document-printing" class="header-anchor">#</a> Document Printing</h3> <p>M18 system supports document printing using ireport. It converts data and report format to PDF using JasperReports API. User can then print the PDF directly.</p> <blockquote><p>Before handle report format, please make sure you have basic understanding of ireport.</p></blockquote> <p>Please install the latest version of ireport on your computer and replace com.jaspersoft.studio.data_6.2.0.final.jar in M18 with the installation directory. <strong>Note</strong>: ireport editing software is an Eclipse.</p> <p>Please add caw share jar to <strong>JaspersoftStudio</strong> project, so that the system can give the correct information/messages when dealing with M18 functions.</p> <h4 id=""><a href="#" class="header-anchor">#</a></h4> <h4 id="docreport-xml"><a href="#docreport-xml" class="header-anchor">#</a> docReport.xml</h4> <blockquote><p>report's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>string</td> <td>Used to uniquely identify a report. Recommended the code starts with <code>@</code></td></tr> <tr><td>module</td> <td>string</td> <td>Module code related to this printing. Support multiple input, each separated by semicolons <code>;</code></td></tr> <tr><td>providerCode</td> <td>string</td> <td>Print provider class name</td></tr> <tr><td>reportDto</td> <td>string</td> <td>Dto's class name, which provides the report parameters</td></tr> <tr><td>reportDtoSettingSrc</td> <td>string</td> <td>Dto's setting source</td></tr> <tr><td>providerMess</td> <td>string</td> <td>Print provider messCode</td></tr> <tr><td>providerOrder</td> <td>int</td> <td>Valid when there is more than one print provider in a module. Decide the print order of the provider</td></tr> <tr><td>apDebug</td> <td>boolean</td> <td>When true, only visible in debug mode</td></tr></tbody></table> <br> <blockquote><p>format's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>format code</td></tr> <tr><td>description</td> <td>format's description</td></tr> <tr><td>remark</td> <td>format's remarks</td></tr> <tr><td>packageName</td> <td>jrxml location</td></tr></tbody></table> <br> <blockquote><p>jrxml's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>jrxml's name, should end with <code>.jrxml</code></td></tr> <tr><td>main</td> <td>Mark the main jrxml in a format</td></tr></tbody></table> <br> <blockquote><p>resetData's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>prCode</td> <td>provider's class name</td></tr> <tr><td>resetClass</td> <td>class name, implements <code>CawJrPrintRestData</code></td></tr></tbody></table> <br> <blockquote><p>reportHandler's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>reportCode</td> <td>report code</td></tr> <tr><td>handlerClass</td> <td>class name, needs to implement <code>ReportHandler</code>. Allow developer to modify the jrxml during initialization, normally used to hide some functions in the report</td></tr></tbody></table> <br> <blockquote><p>reportShowHandler's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>prCode</td> <td>provider's class name</td></tr> <tr><td>handlerClass</td> <td>class name, needs to implement <code>ReportShowHandler</code>. Can control if a pdf should be downloaded directly or do other operations</td></tr></tbody></table> <br> <blockquote><p>Example:</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>docReport</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>report</span> <span class="token attr-name">module</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@bpm_emp<span class="token punctuation">&quot;</span></span>  
			<span class="token attr-name">reportDto</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.share.data.ireport.emp.EmpJrDto<span class="token punctuation">&quot;</span></span> <span class="token attr-name">reportDtoSettingSrc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/view/dialog/empPrintSetting.xhtml<span class="token punctuation">&quot;</span></span>
	        <span class="token attr-name">providerCode</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.ireport.provider.emp.EmployeeProvider<span class="token punctuation">&quot;</span></span> <span class="token attr-name">providerOrder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">providerMess</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>jr.emp_provider<span class="token punctuation">&quot;</span></span> <span class="token attr-name">apDebug</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	        
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>format</span> <span class="token attr-name">code</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@bpm_emp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Print<span class="token punctuation">&quot;</span></span> <span class="token attr-name">remark</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Print Employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">packageName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.share.data.ireport.resource.emp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jrxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>emp.jrxml<span class="token punctuation">&quot;</span></span> <span class="token attr-name">main</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jrxml</span><span class="token punctuation">&gt;</span></span>
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jrxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>empPic.jrxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jrxml</span><span class="token punctuation">&gt;</span></span>    
	        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jrxml</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>empUser.jrxml<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jrxml</span><span class="token punctuation">&gt;</span></span>    
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>format</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>report</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>docReport</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>​</p> <h4 id="add-provider-class-and-sql"><a href="#add-provider-class-and-sql" class="header-anchor">#</a> Add Provider Class and SQL</h4> <blockquote><p>Dto class</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmpJrDto</span> <span class="token keyword">extends</span> <span class="token class-name">ModuleReportDto</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">boolean</span> prtPic <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDefaultTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;Testing Ireport!&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isPrtPic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> prtPic<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPrtPic</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> prtPic<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>prtPic <span class="token operator">=</span> prtPic<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is a simple POJO class, this dto must extend <code>ModuleReportDto</code></p> <br> <blockquote><p>Provider</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">ModuleProvider</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initReportStru</span><span class="token punctuation">(</span><span class="token class-name">CawReportDataSet</span> reData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// set table alias name</span>
		reData<span class="token punctuation">.</span><span class="token function">setAlias</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;EMPLOYEE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;employee&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		reData<span class="token punctuation">.</span><span class="token function">setAlias</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;DEPT&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dept&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		reData<span class="token punctuation">.</span><span class="token function">setAlias</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;EMPLOYEEPIC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;employeepic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		reData<span class="token punctuation">.</span><span class="token function">setAlias</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;PICUSER&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		reData<span class="token punctuation">.</span><span class="token function">setQuery</span><span class="token punctuation">(</span><span class="token string">&quot;EMPLOYEE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">adjustData</span><span class="token punctuation">(</span><span class="token class-name">CawReportDataSet</span> reData<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		reData<span class="token punctuation">.</span><span class="token function">setRelationTo</span><span class="token punctuation">(</span><span class="token string">&quot;EMPLOYEE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dept&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;DEPT&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		reData<span class="token punctuation">.</span><span class="token function">setRelationTo</span><span class="token punctuation">(</span><span class="token string">&quot;EMPLOYEEPIC&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;PICUSER&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		reData<span class="token punctuation">.</span><span class="token function">assignSubReport</span><span class="token punctuation">(</span><span class="token string">&quot;EMPLOYEE&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EMPLOYEEPIC&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">CawReportDataSet</span> <span class="token function">genIdsData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;{Call prtEmployee('&quot;</span> <span class="token operator">+</span> <span class="token function">getReportDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMainIdString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;')}&quot;</span><span class="token punctuation">;</span>

		<span class="token class-name">MacQuery</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MacQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		query<span class="token punctuation">.</span><span class="token function">setQuery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token class-name">CawReportDataSet</span> ds <span class="token operator">=</span> <span class="token function">fillAndAdjustData</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> ds<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>SQL</p></blockquote> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">procedure</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> prtEmployee<span class="token punctuation">;</span>

<span class="token keyword">DELIMITER</span> $$

<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> prtEmployee<span class="token punctuation">(</span><span class="token operator">in</span> idStr <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  
<span class="token keyword">BEGIN</span>
	
	<span class="token keyword">create</span> <span class="token keyword">temporary</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> prtemptempTable 
    <span class="token keyword">select</span> a<span class="token punctuation">.</span><span class="token operator">*</span>  
	<span class="token keyword">from</span> employee a
	<span class="token keyword">where</span> find_in_set<span class="token punctuation">(</span>a<span class="token punctuation">.</span>id<span class="token punctuation">,</span> idStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  
   	<span class="token comment">#create index</span>
	<span class="token keyword">create</span> <span class="token keyword">index</span> I_Employee_dept <span class="token keyword">ON</span> prtemptempTable<span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span> 

    <span class="token comment">#main query 0</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> prtemptempTable<span class="token punctuation">;</span>
    
    <span class="token comment">#dept 1</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> dept a 
    <span class="token keyword">where</span> <span class="token keyword">exists</span><span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token boolean">NULL</span> <span class="token keyword">from</span> prtemptempTable b <span class="token keyword">where</span> b<span class="token punctuation">.</span>dept<span class="token operator">=</span>a<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">drop</span> <span class="token keyword">table</span> prtemptempTable<span class="token punctuation">;</span>
<span class="token keyword">END</span>$$

<span class="token keyword">DELIMITER</span> <span class="token punctuation">;</span>
</code></pre></div><br> <p><strong>Note:</strong> SQL should mostly use &quot;select *&quot; to get all fields in a table, such that when UDF fields are added in the future the SQL does not need to modify again.</p> <p>Start JBoss (Use Jaspersoft Studio data source), then write JrXml</p> <p><img src="/assets/img/jr_ds1.e166b948.jpg" alt="mssst"></p> <p><img src="/assets/img/jr_ds2.34b79425.jpg" alt="mssst"></p> <br> <p><strong>Note:</strong> URL above is http://127.0.0.1:8080/jsf/rfws/cawProvider/fields/com.multiable.ireport.provider.emp.EmployeeProvider?accessToken=iz&amp;lang=zh_CN</p> <p>accessToken please use the caw.ws.glAccessToken in cawserver.properties</p> <p>The field returned by lang specifies the language of mess (when not transmitting, it uses the <code>lang</code> of <code>GlobalOption</code>)</p> <p>If skipLang is true, the returned field will not add mess description (optional, the default is false)</p> <br> <p><strong>Note</strong>: Not limited to use the web service &quot;cawProvider / fields&quot;, if necessary, developers can design their own process by referring to CawJrProviderEJB</p> <p><img src="/assets/img/jr_pdf.09812cea.jpg" alt="mssst"></p> <h3 id="udf-editor-s-template"><a href="#udf-editor-s-template" class="header-anchor">#</a> UDF Editor's Template</h3> <p>Developers can implement the UDF template that will be used in UDF editor created by end users, like the trading or finance editors template created by trading and finance App in M18 ERP.</p> <blockquote><p>module's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>code</td> <td>true</td> <td>string</td> <td>Template's Code</td></tr> <tr><td>description</td> <td>true</td> <td>string</td> <td>Template's mess code</td></tr> <tr><td>module</td> <td>true</td> <td>string</td> <td>Corresponding module of the template, the module needs to have template=&quot;true&quot; in module.xml</td></tr> <tr><td>helper</td> <td>true</td> <td>string</td> <td>CawUeHelper Helper class name, needs to extends CawUeHelper</td></tr> <tr><td>&lt;page&gt;</td> <td>true</td> <td>string</td> <td>The initial page of the UDF editor generated by this template</td></tr> <tr><td>&lt;setting&gt;</td> <td>true</td> <td>string</td> <td>The setting specific to this UDF template</td></tr></tbody></table> <br> <blockquote><p>Example: helper of CawUeHelper</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FmTemplateHelper</span> <span class="token keyword">extends</span> <span class="token class-name">CawUeHelper</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">5554948686647491057L</span><span class="token punctuation">;</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">initModuleInfo</span><span class="token punctuation">(</span><span class="token class-name">SqlTable</span> ue<span class="token punctuation">,</span> <span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token class-name">Module</span> <span class="token keyword">module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token class-name">String</span> jsonStr <span class="token operator">=</span> ue<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">&quot;backEndInfo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringLib</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">FmtOption</span> option <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>jsonStr<span class="token punctuation">,</span> <span class="token class-name">FmtOption</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">module</span><span class="token punctuation">.</span><span class="token function">setUseAttach</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span><span class="token function">isSupportAttachment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
			<span class="token keyword">module</span><span class="token punctuation">.</span><span class="token function">setUseAttach</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">module</span><span class="token punctuation">.</span><span class="token function">setFmShare</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="initial-data"><a href="#initial-data" class="header-anchor">#</a> Initial Data</h3> <p>M18 system database information is automatically generated by JBoss through java codes. Therefore, developers can not keep any preset data in the database.</p> <p>To create initial/default data to database, developers can set entityDataInit in app.xml:</p> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>entityDataInit's name</td></tr> <tr><td>initDataCreator</td> <td>class name, extends<code>InitDataCreator</code>, create data in the init() method</td></tr></tbody></table> <p><strong>Note</strong>: This method runs every time Wildfly is started. Please check if the data that needs to be initialized already existed in database.</p> <blockquote><p>Example</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDriverCreator</span> <span class="token keyword">extends</span> <span class="token class-name">BaseDataCreator</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasEntityData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Init test</span>
		<span class="token class-name">SqlEntity</span> entity <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      
		<span class="token class-name">JdbcDriverEntity</span> accseeDriver <span class="token operator">=</span> <span class="token class-name">EntityLib</span><span class="token punctuation">.</span><span class="token function">toObject</span><span class="token punctuation">(</span>entity<span class="token punctuation">,</span> <span class="token class-name">JdbcDriverEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setJdbcType</span><span class="token punctuation">(</span><span class="token class-name">JdbcType<span class="token punctuation">.</span>Driver</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setClassName</span><span class="token punctuation">(</span><span class="token string">&quot;net.test.jdbc.TestDriver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setGrammarType</span><span class="token punctuation">(</span><span class="token class-name">GrammarType</span><span class="token punctuation">.</span>UDF<span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setIndepPw</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setWithDbName</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		accseeDriver<span class="token punctuation">.</span><span class="token function">setConnStrTplt</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc:test://${[@D_FilePath]};memory=false&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">EntityLib</span><span class="token punctuation">.</span><span class="token function">mergeToEntity</span><span class="token punctuation">(</span>accseeDriver<span class="token punctuation">,</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
      
		<span class="token function">update</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="data-fix"><a href="#data-fix" class="header-anchor">#</a> Data Fix</h3> <p>During M18 program update, data fix may need to be carried out to handle data fix. Developers can define dataFix in app.xml.</p> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>className</td> <td>class name, needs to extend <code>DataFixAdapter</code> , handles the data fix in run() method. <strong>Note</strong>: This is also an unique key</td></tr> <tr><td>ap</td> <td>Mark the programmer name who writes this data fix</td></tr> <tr><td>desc</td> <td>Description of the data fix</td></tr> <tr><td>order</td> <td>Indicate the order of the data fix.</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataFix</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.ejb.bean.cache.datafix.TestToFix<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Test<span class="token punctuation">&quot;</span></span> <span class="token attr-name">desc</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fix test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataFix</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestToFix</span> <span class="token keyword">extends</span> <span class="token class-name">DataFixAdapter</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		
		<span class="token class-name">String</span> fixSql <span class="token operator">=</span> <span class="token string">&quot;update testinfo set myIdType = 'text'; &quot;</span><span class="token punctuation">;</span>

		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token class-name">CawDs</span><span class="token punctuation">.</span><span class="token function">runUpdate</span><span class="token punctuation">(</span>fixSql<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">CawLog</span><span class="token punctuation">.</span><span class="token function">logException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Note</strong>: Please write the data fix carefully, and ensure all error cases are handled.</p> <p><strong>Note</strong>: The data fix will only run one and only one time, success or not.</p> <h3 id="how-to-add-jar"><a href="#how-to-add-jar" class="header-anchor">#</a> How to Add JAR</h3> <p>To make sure that the corresponding third-party jar package is available while Wildfly is running, you need to ensure that the jar has been added to the Wildfly runtime.</p> <p>M18 recommends using module.xml (Wildfly) way to deal with it. M18 also recommends modifying both <code>MANIFEST.MF</code> and <code>jboss-deployment-structure.xml</code>.</p> <p><strong>Note</strong>: No compilation errors during development does not mean your code can run in JBoss runtime successfully.</p> <p><strong>Note</strong>: Wildfly has its own way of classloader management.</p> <p><strong>Note</strong>: At the time of project launch, Wildfly will automatically copy the lib under the ear (or the lib below the war). If the project is deployed multiple times, it will take a lot of hard disk space.</p> <p>For detail please refer to <a href="https://docs.jboss.org/author/display/WFLY8/Class+Loading+in+WildFly" target="_blank" rel="noopener noreferrer">Wildfly Docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="identify-the-source-of-jboss-startup-errors"><a href="#identify-the-source-of-jboss-startup-errors" class="header-anchor">#</a> Identify the Source of JBoss Startup Errors</h3> <p>Due to configuration/ jar update/ code/ system environment and so on, M18 startup sometimes fails. To debug, please always check and fix the first error you found during startup, and then try to restart JBoss and see if other error happens, and fix it and restart again, and so on.</p> <ul><li>Do not look for mistakes from bottom to top of error messages</li> <li>Do not try to solve all the errors in the log prompts, always fix the first error first and restart</li> <li>Do not assume that the problem must be related to java codes</li> <li>If you find that there is not enough information, it is recommended to modify your codes and print more log out</li> <li>If in Eclipse, it is recommended to delete all breakpoints and try restart</li></ul> <h3 id="schedule-tasks"><a href="#schedule-tasks" class="header-anchor">#</a> Schedule Tasks</h3> <h4 id="create-schedule-task"><a href="#create-schedule-task" class="header-anchor">#</a> Create Schedule Task</h4> <p><strong>Create a Job Class</strong></p> <p>Job class need to extend <code>CawQuartzJob</code>, and implement the doExecute method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SyncJob</span> <span class="token keyword">extends</span> <span class="token class-name">CawQuartzJob</span> <span class="token punctuation">{</span>
  
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> JOBGROUP <span class="token operator">=</span> <span class="token string">&quot;caw.sync&quot;</span><span class="token punctuation">;</span>
  
	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">protected</span> <span class="token class-name">CheckMsg</span> <span class="token function">doExecute</span><span class="token punctuation">(</span><span class="token class-name">JobExecutionContext</span> context<span class="token punctuation">,</span> <span class="token class-name">CawJobDto</span> dto<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
         <span class="token comment">//do something	</span>

		<span class="token keyword">return</span> msg<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><br> <p><strong>Publish a Job</strong></p> <p>First build a <code>CawJobDto</code> object, use the method CawJobLib.scheduleJob (dto) to release. <code>CawJobDto</code> has a three-parameter-constructor, the first is jobGroup, the second is the current entity id, the third is job class. jobGroup + id must be a unique jobName. There is need to provide <code>TimeScheduleDto</code>. It is the dto component of the time, can be generated by the configuration page or you can create an instance of it using <code>new</code>. There is a jsonData in <code>CawJobDto</code>, you can fill some job parameters, which can be obtained in dto in doExecute.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">CawJobDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CawJobDto</span><span class="token punctuation">(</span><span class="token class-name">SyncJob</span><span class="token punctuation">.</span>JOBGROUP<span class="token punctuation">,</span> id<span class="token punctuation">,</span> <span class="token class-name">SyncJob</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

dto<span class="token punctuation">.</span><span class="token function">getJsonData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">setTimeSchedule</span><span class="token punctuation">(</span>timeDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">setJobMess</span><span class="token punctuation">(</span><span class="token string">&quot;syncJob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   

<span class="token class-name">CawJobLib</span><span class="token punctuation">.</span><span class="token function">scheduleJob</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <p><strong>Delete a Job</strong></p> <p>Use the deleteJob method in <code>CawJobLib</code> class.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">CawJobDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CawJobDto</span><span class="token punctuation">(</span><span class="token class-name">UnlockUserJob</span><span class="token punctuation">.</span>JOBGROUP<span class="token punctuation">,</span> param<span class="token punctuation">.</span><span class="token function">getEntityId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">UnlockUserJob</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CawJobLib</span><span class="token punctuation">.</span><span class="token function">deleteJob</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="job-in-a-jboss-cluster"><a href="#job-in-a-jboss-cluster" class="header-anchor">#</a> Job in a JBoss Cluster</h4> <p>After a job is published, the information will be saved to the cawjob table; if the job expires, there will be scheduled tasks to remove these expired jobs.</p> <p>Only when the server cawserver.properties is configured caw.sch.quartz = 1, the server can run M18 jobs.</p> <p><strong>Note</strong>: This server will not run jobs when the server's caw.sch.quartz = 0. However, the jobs posted from this server can be assigned to a target server via the caw.sch.targetUrl and caw.sch.targetAccessToken configurations. To post job to a target server, the target server must be able to run the job.</p> <blockquote><p>cawserver.properties</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>//this server can run schedule job
caw.sch.quartz = 1

//the target server to run a job
caw.sch.targetUrl = http://127.0.0.1:8080/jsf/rfws/
//access token for the target server
caw.sch.targetAccessToken=iz
</code></pre></div><h4 id="how-to-test-scheduled-tasks"><a href="#how-to-test-scheduled-tasks" class="header-anchor">#</a> How to Test Scheduled Tasks</h4> <p>If you want to debug a job during development, you need to ensure the job will run at your local JBoss, which means other JBoss servers will not run the job ahead of your own server, the following parameters need to be set in reset.caw:</p> <blockquote><p>reset.caw</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code>#lock the job to run locally, support multiple input, separated by semicolons
caw.ap.sch.debugJobName=caw.sync.1
#lock the job group to run locally, support multiple input, separated by semicolons
caw.ap.sch.debugJobGroup=caw.sync
#how many hours for the job to lock in this server
caw.ap.sch.debugTime=5
</code></pre></div><blockquote><p>SQL Tables related to scheduled tasks</p></blockquote> <table><thead><tr><th>Table Name</th> <th>Description</th></tr></thead> <tbody><tr><td>cawjob</td> <td>Store published schedule task details</td></tr> <tr><td>cawjoblog</td> <td>Scheduled task log</td></tr> <tr><td>cawjoblock</td> <td>Scheduled task lock info</td></tr></tbody></table> <h3 id="file-stream-handling"><a href="#file-stream-handling" class="header-anchor">#</a> File Stream Handling</h3> <p>All files in M18 are stored in <code>fileData</code> table:</p> <ul><li>One file corresponds to one record in <code>fileData</code>,  system uses the MD5 + size to identify the uniqueness of the file</li> <li>Files saved on <code>filedata</code> do not provide the delete function</li> <li>In order to avoid user reading the picture traversal (picture does not need to verify the login link), the system uses <code>imgcode</code></li></ul> <blockquote><p>File Operation</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">FileCurdEao</span> fileEao <span class="token operator">=</span> <span class="token class-name">JNDILocator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lookupEJB</span><span class="token punctuation">(</span><span class="token class-name">FileCurdEao</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteArray <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">*</span>
<span class="token comment">//Save file in memory to db</span>
<span class="token keyword">long</span> fileId <span class="token operator">=</span> fileEao<span class="token punctuation">.</span><span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token string">&quot;pdf&quot;</span><span class="token punctuation">,</span> byteArray<span class="token punctuation">,</span> <span class="token string">&quot;work.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">String</span> filePath <span class="token operator">=</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token comment">//Save File object to db</span>
fileId <span class="token operator">=</span> fileEao<span class="token punctuation">.</span><span class="token function">saveFile</span><span class="token punctuation">(</span><span class="token string">&quot;pdf&quot;</span><span class="token punctuation">,</span> filePath<span class="token punctuation">,</span> <span class="token string">&quot;work.pdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Read file from M18</span>
<span class="token class-name">String</span> filePath_read <span class="token operator">=</span> fileEao<span class="token punctuation">.</span><span class="token function">getFilePath</span><span class="token punctuation">(</span>fileId<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <blockquote><p>Image Operation</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ImageLocal</span> imageEJB <span class="token operator">=</span> <span class="token class-name">JNDILocator</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lookupEJB</span><span class="token punctuation">(</span><span class="token string">&quot;ImageEJB&quot;</span><span class="token punctuation">,</span> <span class="token class-name">ImageLocal</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>

<span class="token comment">// Upload image, and get imgCode</span>
<span class="token class-name">String</span> imgcode <span class="token operator">=</span> imageEJB<span class="token punctuation">.</span><span class="token function">uploadImage</span><span class="token punctuation">(</span><span class="token string">&quot;imgName&quot;</span><span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get image from imgCode</span>
<span class="token class-name">File</span> img <span class="token operator">=</span> imageEJB<span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span>imgcode<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	
<span class="token comment">// if 2nd para is true, thumbnail will be returned</span>
</code></pre></div><h3 id="m18-jboss-cache"><a href="#m18-jboss-cache" class="header-anchor">#</a> M18 JBoss Cache</h3> <p>Data that need to be frequently queried but not always modified, can be stored in <code>CawCache</code>, which is a application server cache in JBoss. Such data include but are not limited to datadict, mess code and module configuration, etc.</p> <h4 id="cawcache-usage"><a href="#cawcache-usage" class="header-anchor">#</a> CawCache Usage</h4> <p>Developers who want to add a cache, can use the <code>CawCache</code> method to add. See <code>CawCache</code> <code>addSelfPopulatingCache</code> method</p> <p>Then use the <code>CawCache</code> <code>putObject</code> or remove method to manipulate the data in the cache.</p> <p>Through the <code>getObject</code> method of <code>CawCache</code>, you can get the data of the cache.</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//The first parameter is the name of the cache, the second parameter refers to the max record count of the cache, the third parameter refers to the cache expiry time (in seconds); if the 4th parameter is true, When reading this cache to copy an object out to return</span>
<span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">addSelfPopulatingCache</span><span class="token punctuation">(</span>navMenu<span class="token punctuation">,</span> <span class="token class-name">CawLib</span><span class="token punctuation">.</span><span class="token function">getBaseCacheSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">86400</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">NavmenuEntryFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//The first parameter is the name of the registered cache; the second parameter is the key to be cached in this cache, which needs to be a serializable key; the third parameter is the content of the cache to be placed in this cache</span>
<span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span>cawcheName<span class="token punctuation">,</span> key<span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//The first parameter is registered cache name; The second parameter is the cache inside the cache key</span>
<span class="token class-name">MenuItemConfig</span> menuCfg <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MenuItemConfig</span><span class="token punctuation">)</span> <span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token class-name">CawCache</span><span class="token punctuation">.</span>menuCache<span class="token punctuation">,</span> menukey<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CawCache</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">CawCache</span><span class="token punctuation">.</span>userSettingCache<span class="token punctuation">,</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="cache-in-jboss-cluster"><a href="#cache-in-jboss-cluster" class="header-anchor">#</a> Cache in JBoss Cluster</h4> <p>In the case of clustering, due to data changes, the cache may appear out of synchronization in different JBoss servers;</p> <p><strong>Note 1</strong>: When using a cache, you have to think about how to synchronize your data or you will have unpredictable problems (not just for <code>CawCache</code>)</p> <p><strong>Note 2</strong>: Not all caches need to be synchronized</p> <p>Two ways to synchronize cache within a JBoss Cluster.</p> <p><strong>The default synchronization cache method</strong></p> <p>Recommended usage: The contents of the cache is simple, just do a simple put or delete <code>CawCache</code>.</p> <p>Please use the method <code>callCawCacheClusterEvent</code> of <code>CawClusterLib</code></p> <blockquote><p>Add cluster cache</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">CawClusterCacheDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CawClusterCacheDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">UseInfoCache</span><span class="token punctuation">.</span>CACHE_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">getCacheMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>menuCode<span class="token punctuation">,</span> uic<span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">setCacheClass</span><span class="token punctuation">(</span><span class="token class-name">UseInfoCache</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CawClusterLib</span><span class="token punctuation">.</span><span class="token function">callCawCacheClusterEvent</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <blockquote><p>Remove cluster cache</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">CawClusterCacheDto</span> dto <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CawClusterCacheDto</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">UdfLogic</span><span class="token punctuation">.</span>CACHE_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
dto<span class="token punctuation">.</span><span class="token function">getDeleteKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CawClusterLib</span><span class="token punctuation">.</span><span class="token function">callCawCacheClusterEvent</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><br> <blockquote><p>CawClusterCacheDto</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>name</td> <td>String</td> <td>Cache name that need to sync</td></tr> <tr><td>cacheMap</td> <td>Map&lt;Serializable, Object&gt;</td> <td>The cached values in this map will be added to other machines in the cluster, and the cached map is key-value structure</td></tr> <tr><td>cacheClass</td> <td>Class&lt;?&gt;</td> <td>Class of the value in cacheMap</td></tr> <tr><td>deleteKeys</td> <td>Set&lt;Serializable&gt;</td> <td>The set of keys that to be deleted in other servers in the cluster</td></tr></tbody></table> <br> <p><strong>Self defined cache synchronization</strong></p> <p>Need to synchronize <code>CawCache</code> or some static Map, Collection and other caches, some caches may not simply add or delete, or need to operate several different caches, then you need to customize the class to deal with;</p> <p>Configure clusterListerner in app.xml:</p> <blockquote><p>clusterListerner's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Type</th> <th>Description</th></tr></thead> <tbody><tr><td>eventType</td> <td>string</td> <td>Cache event type</td></tr> <tr><td>className</td> <td>string</td> <td>class name, class need to extend <code>CawClusterListenerAdapter</code></td></tr></tbody></table> <br> <p>The callClusterEvent method of <code>CawClusterLib</code> is called when the cluster cache needs to be synchronized. Then the machines of other clusters will run the corresponding listener's method:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">JSONObject</span> jo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
jo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;cacheName&quot;</span><span class="token punctuation">,</span> <span class="token class-name">JsfCache</span><span class="token punctuation">.</span>theme<span class="token punctuation">)</span><span class="token punctuation">;</span>
jo<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;cacheKey&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> action<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">ActionParam</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
<span class="token comment">//The first parameter is xml eventType configuration; the second parameter is a String, usually pass a json, the cluster server to get this parameter will be passed to the clusterListerner run method;</span>
<span class="token class-name">CawClusterLib</span><span class="token punctuation">.</span><span class="token function">callClusterEvent</span><span class="token punctuation">(</span><span class="token class-name">CawClusterEvent</span><span class="token punctuation">.</span>JSFCACHE<span class="token punctuation">,</span> jo<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="object-sharing"><a href="#object-sharing" class="header-anchor">#</a> Object Sharing</h3> <p>M18 system supports data sharing between different M18 sites via create/install objects. To use this function one needs to set dataObject in app.xml.</p> <blockquote><p>dataObject's attributes</p></blockquote> <table><thead><tr><th>Name</th> <th>Required</th> <th>Type</th> <th>Default</th> <th>Description</th></tr></thead> <tbody><tr><td>className</td> <td>true</td> <td>string</td> <td></td> <td>Full class name. class needs to extend  ModuleObjectHandler</td></tr></tbody></table> <br> <blockquote><p>dataObject example</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dataObject</span>  <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.multiable.core.ejb.bean.dataobject.handler.ComboObjectHandler<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dataObject</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><br> <blockquote><p>DataObjectHandler example</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ComboObjectHandler</span> <span class="token keyword">extends</span> <span class="token class-name">ModuleObjectHandler</span> <span class="token punctuation">{</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;comboData&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMenuCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;comboData&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getModuleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;comboData&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token string">&quot;comboData&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getInfoMessList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> messList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		messList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;dataObject.comboDataInfo1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">return</span> messList<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
	<span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getDepends</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> depends <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getDepends</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		depends<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;udfMess&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> depends<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><br> <blockquote><p>ModuleObjectHandler  implements DataObjectHandler, some methods stated here:</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DataObjectHandler</span> <span class="token punctuation">{</span>
	<span class="token comment">// Import object upload file will run this method, you can override this method to intervene in the generation of entity</span>
	<span class="token keyword">public</span> <span class="token class-name">DataObjectBaseDto</span> <span class="token function">restoreDsDto</span><span class="token punctuation">(</span><span class="token class-name">DsEntryObject</span> entryObj<span class="token punctuation">)</span><span class="token punctuation">;</span>

  	<span class="token comment">// Export object, you can override this method, some of the picture file type information written to the derived Object inside;</span>
	<span class="token keyword">public</span> <span class="token class-name">DsEntryObject</span> <span class="token function">genDsEntry</span><span class="token punctuation">(</span><span class="token class-name">DataObjectBaseDto</span> dto<span class="token punctuation">)</span><span class="token punctuation">;</span>

  	<span class="token comment">// Export object, you can override this method to interfere with the export entity</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">fillupDto</span><span class="token punctuation">(</span><span class="token class-name">DataObjectBaseDto</span> dto<span class="token punctuation">,</span> <span class="token class-name">DataShareObjectDto</span> dsDto<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// Import object to install, you can override this method to interfere with the installation of object</span>
	<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">CheckMsg</span><span class="token punctuation">&gt;</span></span> <span class="token function">install</span><span class="token punctuation">(</span><span class="token keyword">long</span> beId<span class="token punctuation">,</span> <span class="token class-name">DataObjectBaseDto</span> dsDto<span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">DsInstallDto</span><span class="token punctuation">&gt;</span></span> insList<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> depMapping<span class="token punctuation">,</span> <span class="token class-name">Object</span> detail<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="common-utility-classes"><a href="#common-utility-classes" class="header-anchor">#</a> Common Utility Classes</h2> <h3 id="basic-operation"><a href="#basic-operation" class="header-anchor">#</a> Basic Operation</h3> <table><thead><tr><th>Class</th> <th>Description</th></tr></thead> <tbody><tr><td><code>ArrayLib</code></td> <td>Tools to deal with the data; Worth noting 1. Check whether the array contains a string, 2. Merge the array</td></tr> <tr><td><code>ClassLib</code></td> <td>Tools to deal with classes: 1. Get the class name, 2. Get the class Field 3. Get the class method 4. Get the type of class</td></tr> <tr><td><code>DateLib</code></td> <td>Tools to deal with dates</td></tr> <tr><td><code>DateFormatLib</code></td> <td>Tools to deal with date formats</td></tr> <tr><td><code>ListLib</code></td> <td>Tools to deal with list, and provide method to compare two lists</td></tr> <tr><td><code>MathLib</code></td> <td>Tools to deal with common math functions like rounding, max, min, etc.</td></tr> <tr><td><code>StringLib</code></td> <td>Tools to deal with string, and provide method to convert between string and html</td></tr></tbody></table> <h3 id="special-handling"><a href="#special-handling" class="header-anchor">#</a> Special Handling</h3> <table><thead><tr><th>Class</th> <th>Description</th></tr></thead> <tbody><tr><td><code>SqlTableLib</code></td> <td>Tools to deal with SqlTable, and provide methods to do POJO and SqlTable conversion, and JSON and SqlTable conversion.</td></tr> <tr><td><code>CheckMsgLib</code></td> <td>Tools to deal with CheckMsg, which is a common response object in entity CRUD actions/web services.</td></tr> <tr><td><code>ConvertLib</code></td> <td>Tools to deal with conversion of different data types</td></tr> <tr><td><code>CawLib</code></td> <td>Tools to deal with CAW configuration, like getting parameters in cawserver.properties</td></tr></tbody></table> <h3 id="send-e-mail-example"><a href="#send-e-mail-example" class="header-anchor">#</a> Send E-mail Example</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EJB</span><span class="token punctuation">(</span>beanName <span class="token operator">=</span> <span class="token string">&quot;MacEmailSenderEJB&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">MacEmailSenderLocal</span> emailEJB<span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
<span class="token class-name">MacEmail</span> email <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MacEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MacEmailAttachment</span> atta <span class="token operator">:</span> <span class="token function">getAttachments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	email<span class="token punctuation">.</span><span class="token function">addAttachment</span><span class="token punctuation">(</span>atta<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

email<span class="token punctuation">.</span><span class="token function">setTo</span><span class="token punctuation">(</span><span class="token string">&quot;test@mac.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
email<span class="token punctuation">.</span><span class="token function">setCc</span><span class="token punctuation">(</span><span class="token string">&quot;test1@mac.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
email<span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token string">&quot;sunject - test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
email<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">&quot;conent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">CheckResult</span> result <span class="token operator">=</span> emailEJB<span class="token punctuation">.</span><span class="token function">sendEmailWithId</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> emailSettingId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>
</code></pre></div><p><strong>Note</strong>: emailSettingId is the SMTP record ID in M18 system.</p> <h3 id="audit-trail-s-example"><a href="#audit-trail-s-example" class="header-anchor">#</a> Audit Trail's Example</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AuditTrailData</span><span class="token punctuation">&gt;</span></span> datas <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">AuditTrailData</span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AuditTrailData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setEntityId</span><span class="token punctuation">(</span>entityId<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setExeTime</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setiRev</span><span class="token punctuation">(</span>iRev<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setMenuCode</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setModuleName</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setOperation</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span><span class="token function">setOperationDesc</span><span class="token punctuation">(</span><span class="token string">&quot;failed&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

datas<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">AuditTrailLib</span><span class="token punctuation">.</span><span class="token function">addAuditTrail</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.be9f9c09.js" defer></script><script src="/assets/js/2.2e75dd35.js" defer></script><script src="/assets/js/19.57d9531c.js" defer></script>
  </body>
</html>
